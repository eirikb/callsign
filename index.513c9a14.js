!function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function e(t,e,n){Object.defineProperty(t,e,{get:n,enumerable:!0})}var n=t.parcelRequire293d,r=n("7lbf0"),i=n("5eph7"),o={},a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function c(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function l(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function p(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}Object.create;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var d=!1,v=!1,g="${JSCORE_VERSION}",y=function(t,e){if(!t)throw m(e)},m=function(t){return new Error("Firebase Database ("+g+") INTERNAL ASSERT FAILED: "+t)},b=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(b(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var h=a<<4&240|s>>2;if(r.push(h),64!==u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},w=function(t){try{return _.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function I(t){return T(void 0,t)}function T(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=T(t[n],e[n]));return t}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var E=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
  * @license
  * Copyright 2021 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function S(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=u({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[_.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),_.encodeString(JSON.stringify(o),!1),""].join(".")}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function C(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function k(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(C())}function N(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(t){return!1}}function A(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function P(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function R(){return!0===d||!0===v}function D(){return"indexedDB"in self&&null!=indexedDB}function O(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function x(){return!(!navigator||!navigator.cookieEnabled)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var L=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,M.prototype.create),o}return s(e,t),e}(Error),M=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?F(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new L(i,s,r);return u},t}();function F(t,e){return t.replace(U,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var U=/\{\$([^}]+)}/g;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function j(t){return JSON.parse(t)}function q(t){return JSON.stringify(t)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var V=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=j(w(o[0])||""),n=j(w(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function K(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function W(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function H(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var G=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function z(t,e){var n=new Q(t,e);return n.subscribe.bind(n)}var Q=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=Y),void 0===r.error&&(r.error=Y),void 0===r.complete&&(r.complete=Y);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Y(){}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var X=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function $(t,e){return t+" failed: "+e+" argument "}function J(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error($(t,e)+"must be a valid function.")}function Z(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error($(t,e)+"must be a valid context object.")}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var tt=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function et(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2021 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function nt(t){return t&&t._delegate?t._delegate:t}var rt=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),it="[DEFAULT]",ot=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new E;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t))try{this.getOrInitializeService({instanceIdentifier:it})}catch(t){}try{for(var r=l(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=f(i.value,2),a=o[0],s=o[1],u=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService({instanceIdentifier:u});s.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=it),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(p(p([],f(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),f(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=it),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var s=l(this.instancesDeferred.entries()),u=s.next();!u.done;u=s.next()){var c=f(u.value,2),h=c[0],p=c[1];o===this.normalizeInstanceIdentifier(h)&&p.resolve(a)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return a},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=l(i),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===it?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=it),this.component?this.component.multipleInstances?t:it:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var at,st=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new ot(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ******************************************************************************/function ut(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var ct,ht,lt=[];(ht=ct||(ct={}))[ht.DEBUG=0]="DEBUG",ht[ht.VERBOSE=1]="VERBOSE",ht[ht.INFO=2]="INFO",ht[ht.WARN=3]="WARN",ht[ht.ERROR=4]="ERROR",ht[ht.SILENT=5]="SILENT";var ft,pt={debug:ct.DEBUG,verbose:ct.VERBOSE,info:ct.INFO,warn:ct.WARN,error:ct.ERROR,silent:ct.SILENT},dt=ct.INFO,vt=((at={})[ct.DEBUG]="log",at[ct.VERBOSE]="log",at[ct.INFO]="info",at[ct.WARN]="warn",at[ct.ERROR]="error",at),gt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=vt[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,ut(["["+i+"]  "+t.name+":"],n))}},yt=function(){function t(t){this.name=t,this._logLevel=dt,this._logHandler=gt,this._userLogHandler=null,lt.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in ct))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?pt[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ut([this,ct.DEBUG],t)),this._logHandler.apply(this,ut([this,ct.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ut([this,ct.VERBOSE],t)),this._logHandler.apply(this,ut([this,ct.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ut([this,ct.INFO],t)),this._logHandler.apply(this,ut([this,ct.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ut([this,ct.WARN],t)),this._logHandler.apply(this,ut([this,ct.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ut([this,ct.ERROR],t)),this._logHandler.apply(this,ut([this,ct.ERROR],t))},t}();function mt(t){lt.forEach((function(e){e.setLogLevel(t)}))}var bt,_t=((ft={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",ft["bad-app-name"]="Illegal App name: '{$appName}",ft["duplicate-app"]="Firebase App named '{$appName}' already exists",ft["app-deleted"]="Firebase App named '{$appName}' already deleted",ft["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",ft["invalid-log-argument"]="First argument to `onLog` must be null or a function.",ft),wt=new M("app","Firebase",_t),It="@firebase/app",Tt="[DEFAULT]",Et=((bt={})["@firebase/app"]="fire-core",bt["@firebase/analytics"]="fire-analytics",bt["@firebase/app-check"]="fire-app-check",bt["@firebase/auth"]="fire-auth",bt["@firebase/database"]="fire-rtdb",bt["@firebase/functions"]="fire-fn",bt["@firebase/installations"]="fire-iid",bt["@firebase/messaging"]="fire-fcm",bt["@firebase/performance"]="fire-perf",bt["@firebase/remote-config"]="fire-rc",bt["@firebase/storage"]="fire-gcs",bt["@firebase/firestore"]="fire-fst",bt["fire-js"]="fire-js",bt["firebase-wrapper"]="fire-js-all",bt),St=new yt("@firebase/app"),Ct=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=I(t),this.container=new st(e.name),this._addComponent(new rt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=Tt),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Tt),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){St.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw wt.create("app-deleted",{appName:this.name_})},t}();Ct.prototype.name&&Ct.prototype.options||Ct.prototype.delete||console.log("dc");
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function kt(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=Tt);var a=o.name;if("string"!=typeof a||!a)throw wt.create("bad-app-name",{appName:String(a)});if(B(e,a))throw wt.create("duplicate-app",{appName:a});var s=new t(n,o,r);return e[a]=s,s},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Et[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),s=e.match(/\s|\//);if(a||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void St.warn(u.join(" "))}o(new rt(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:mt,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw wt.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=pt[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:ct[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=lt;r<i.length;r++)n(i[r])}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!B(e,t=t||Tt))throw wt.create("no-app",{appName:t});return e[t]}function o(o){var a=o.name;if(n.has(a))return St.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===o.type?r[a]:null;if(n.set(a,o),"PUBLIC"===o.type){var s=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[a])throw wt.create("invalid-app-argument",{appName:a});return t[a]()};void 0!==o.serviceProps&&T(s,o.serviceProps),r[a]=s,t.prototype[a]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,a);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[a]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Nt=function t(){var e=kt(Ct);return e.INTERNAL=u(u({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){T(e,t)},createSubscribe:z,ErrorFactory:M,deepExtend:T}),e}(),At=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){St.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Pt=self.firebase.SDK_VERSION;Pt&&Pt.indexOf("LITE")>=0&&St.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Rt=Nt.initializeApp;Nt.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return N()&&St.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Rt.apply(void 0,t)};var Dt,Ot,xt,Lt=Nt;(Dt=Lt).INTERNAL.registerComponent(new rt("platform-logger",(function(t){return new At(t)}),"PRIVATE")),Dt.registerVersion(It,"0.6.28",Ot),Dt.registerVersion("fire-js",""),e(o,"default",(function(){return Lt})),e(o,"firebase",(function(){return Lt})),xt=o,Object.defineProperty(xt,"__esModule",{value:!0}),function(){var e,n="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var r=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t,e];for(var n=0;n<e.length;++n){var r=e[n];if(r&&r.Math==Math)return r}return globalThis}(this);function i(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function o(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:i(t)}}!function(t,e){if(e){var i=r;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(e=e(o=i[t=t[t.length-1]]))!=o&&null!=e&&n(i,t,{configurable:!0,writable:!0,value:e})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function i(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var a=r.setTimeout;n.prototype.c=function(t){a(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Ra(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=i,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=o(t),a=r.next();!a.done;a=r.next())i(a.value).Ra(e,n)}))},e.all=function(t){var n=o(t),r=n.next();return r.done?i([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).Ra(o(a.length-1),e),r=n.next()}while(!r.done)}))},e}));var a=a||{},s=this||self,u=/^[\w+/_-]+[=]{0,2}$/,c=null;function h(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&u.test(t)?t:""}function l(){}function f(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){return"function"==f(t)}function v(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function g(t){return Object.prototype.hasOwnProperty.call(t,y)&&t[y]||(t[y]=++m)}var y="closure_uid_"+(1e9*Math.random()>>>0),m=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function _(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:_).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now;function E(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function S(t){return t}function C(t,e,n){this.code=A+t,this.message=e||P[t]||"",this.a=n||null}function k(t){var e=t&&t.code;return e?new C(e.substring(A.length),t.message,t.serverResponse):null}E(C,Error),C.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},C.prototype.toJSON=function(){return this.w()};var N,A="auth/",P={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},R={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function D(t){for(var e in R)if(R[e].id===t)return{firebaseEndpoint:(t=R[e]).Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function O(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function x(t){if(Error.captureStackTrace)Error.captureStackTrace(this,x);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function L(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");x.call(this,n+t[r])}function M(t,e){throw new L("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function F(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function U(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function j(){this.b=this.a=null}N=D("__EID__")?"__EID__":void 0,E(x,Error),x.prototype.name="CustomError",E(L,x),L.prototype.name="AssertionError",F.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var q=new F((function(){return new B}),(function(t){t.reset()}));function V(){var t=_e,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function B(){this.next=this.b=this.a=null}j.prototype.add=function(t,e){var n=q.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},B.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},B.prototype.reset=function(){this.next=this.b=this.a=null};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var H=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},G=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},z=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Q(t,e){return 0<=K(t,e)}function Y(t,e){var n;return(n=0<=(e=K(t,e)))&&Array.prototype.splice.call(t,e,1),n}function X(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function $(t){return Array.prototype.concat.apply([],arguments)}function J(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var Z,tt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},et=/&/g,nt=/</g,rt=/>/g,it=/"/g,ot=/'/g,at=/\x00/g,st=/[\x00&<>"']/;function ut(t,e){return-1!=t.indexOf(e)}function ct(t,e){return t<e?-1:t>e?1:0}t:{var ht=s.navigator;if(ht){var lt=ht.userAgent;if(lt){Z=lt;break t}}Z=""}function ft(t){return ut(Z,t)}function pt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function dt(t){for(var e in t)return!1;return!0}function vt(t){var e,n={};for(e in t)n[e]=t[e];return n}var gt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<gt.length;o++)n=gt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function mt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||s).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(v(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;M("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function bt(t,e){this.a=t===Tt&&e||"",this.b=It}function _t(t){return t instanceof bt&&t.constructor===bt&&t.b===It?t.a:(M("expected object of type Const, got '"+t+"'"),"type_error:Const")}bt.prototype.ta=!0,bt.prototype.sa=function(){return this.a},bt.prototype.toString=function(){return"Const{"+this.a+"}"};var wt,It={},Tt={};function Et(){if(void 0===wt){var t=null,e=s.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:S,createScript:S,createScriptURL:S})}catch(t){s.console&&s.console.error(t.message)}wt=t}else wt=t}return wt}function St(t,e){this.a=e===Pt?t:""}function Ct(t){return t instanceof St&&t.constructor===St?t.a:(M("expected object of type TrustedResourceUrl, got '"+t+"' of type "+f(t)),"type_error:TrustedResourceUrl")}function kt(t,e){var n=_t(t);if(!At.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=Et();return new St(t=e?e.createScriptURL(t):t,Pt)}(t=n.replace(Nt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof bt?_t(t):encodeURIComponent(String(t))})))}St.prototype.ta=!0,St.prototype.sa=function(){return this.a.toString()},St.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nt=/%{(\w+)}/g,At=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Pt={};function Rt(t,e){this.a=e===jt?t:""}function Dt(t){return t instanceof Rt&&t.constructor===Rt?t.a:(M("expected object of type SafeUrl, got '"+t+"' of type "+f(t)),"type_error:SafeUrl")}Rt.prototype.ta=!0,Rt.prototype.sa=function(){return this.a.toString()},Rt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ot=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,xt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Mt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof Rt)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),Mt.test(t))t=new Rt(t,jt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(xt);t=e&&Ot.test(e[1])?new Rt(t,jt):null}return t}function Ut(t){return t instanceof Rt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),Mt.test(t)||(t="about:invalid#zClosurez"),new Rt(t,jt))}var jt={},qt=new Rt("about:invalid#zClosurez",jt);function Vt(t,e,n){this.a=n===Bt?t:""}Vt.prototype.ta=!0,Vt.prototype.sa=function(){return this.a.toString()},Vt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bt={};function Kt(t,e,n,r){return t=t instanceof Rt?t:Ut(t),e=e||s,n=n instanceof bt?_t(n):n||"",e.open(Dt(t),n,r,void 0)}function Wt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ht(t){return st.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(et,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(nt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(rt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(it,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(ot,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(at,"&#0;"))),t}function Gt(t){return Gt[" "](t),t}Gt[" "]=l;var zt,Qt=ft("Opera"),Yt=ft("Trident")||ft("MSIE"),Xt=ft("Edge"),$t=Xt||Yt,Jt=ft("Gecko")&&!(ut(Z.toLowerCase(),"webkit")&&!ft("Edge"))&&!(ft("Trident")||ft("MSIE"))&&!ft("Edge"),Zt=ut(Z.toLowerCase(),"webkit")&&!ft("Edge");function te(){var t=s.document;return t?t.documentMode:void 0}t:{var ee="",ne=function(){var t=Z;return Jt?/rv:([^\);]+)(\)|;)/.exec(t):Xt?/Edge\/([\d\.]+)/.exec(t):Yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Zt?/WebKit\/(\S+)/.exec(t):Qt?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(ne&&(ee=ne?ne[1]:""),Yt){var re=te();if(null!=re&&re>parseFloat(ee)){zt=String(re);break t}}zt=ee}var ie,oe={};function ae(t){return function(t,e){var n=oe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=tt(String(zt)).split("."),r=tt(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ct(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ct(0==a[2].length,0==s[2].length)||ct(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}if(s.document&&Yt){var se=te();ie=se||(parseInt(zt,10)||void 0)}else ie=void 0;var ue=ie;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(t){}var ce=!Yt||9<=Number(ue);function he(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function le(t,e){pt(e,(function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:de.hasOwnProperty(n)?t.setAttribute(de[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,pe,de={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ve(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!p(o)||v(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(v(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(d(o)){a="function"==typeof o.item;break t}}a=!1}W(a?J(o):o,r)}}}function ge(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function ye(t){s.setTimeout((function(){throw t}),0)}function me(t,e){pe||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);pe=function(){t.then(we)}}else pe=function(){var t=we;!d(s.setImmediate)||s.Window&&s.Window.prototype&&!ft("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(fe||(fe=function(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ft("Presto")&&(t=function(){var t=ge(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=w((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!ft("Trident")&&!ft("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){s.setTimeout(t,0)}}()),fe(t)):s.setImmediate(t)}}(),be||(pe(),be=!0),_e.add(t,e)}var be=!1,_e=new j;function we(){for(var t;t=V();){try{t.a.call(t.b)}catch(t){ye(t)}U(q,t)}be=!1}function Ie(t,e){if(this.a=Te,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=l)try{var n=this;t.call(e,(function(t){Me(n,Ee,t)}),(function(t){if(!(t instanceof Ke))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Me(n,Se,t)}))}catch(t){Me(this,Se,t)}}var Te=0,Ee=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var ke=new F((function(){return new Ce}),(function(t){t.reset()}));function Ne(t,e,n){var r=ke.get();return r.g=t,r.b=e,r.f=n,r}function Ae(t){if(t instanceof Ie)return t;var e=new Ie(l);return Me(e,Ee,t),e}function Pe(t){return new Ie((function(e,n){n(t)}))}function Re(t,e,n){Fe(t,e,n,null)||me(I(e,t))}function De(t){return new Ie((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Re(t[o],I(i,o,!0),I(i,o,!1));else e(r)}))}function Oe(t,e){if(t.a==Te)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Te&&1==r?Oe(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):je(n),qe(n,i,Se,e)))}t.c=null}else Me(t,Se,e)}function xe(t,e){t.b||t.a!=Ee&&t.a!=Se||Ue(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,r){var i=Ne(null,null,null);return i.a=new Ie((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ke?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,xe(t,i),i.a}function Me(t,e,n){t.a==Te&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Fe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Ue(t),e!=Se||n instanceof Ke||function(t,e){t.g=!0,me((function(){t.g&&Be.call(null,e)}))}(t,n)))}function Fe(t,e,n,r){if(t instanceof Ie)return xe(t,Ne(e||l,n||null,r)),!0;if(O(t))return t.then(e,n,r),!0;if(v(t))try{var i=t.then;if(d(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Ue(t){t.h||(t.h=!0,me(t.gc,t))}function je(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function qe(t,e,n,r){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ve(e,n,r);else try{e.c?e.g.call(e.f):Ve(e,n,r)}catch(t){Be.call(null,t)}U(ke,e)}function Ve(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ie.prototype.then=function(t,e,n){return Le(this,d(t)?t:null,d(e)?e:null,n)},Ie.prototype.$goog_Thenable=!0,(e=Ie.prototype).oa=function(t,e){return(t=Ne(t,t,e)).c=!0,xe(this,t),this},e.o=function(t,e){return Le(this,null,t,e)},e.cancel=function(t){if(this.a==Te){var e=new Ke(t);me((function(){Oe(this,e)}),this)}},e.$c=function(t){this.a=Te,Me(this,Ee,t)},e.ad=function(t){this.a=Te,Me(this,Se,t)},e.gc=function(){for(var t;t=je(this);)qe(this,t,this.a,this.i);this.h=!1};var Be=ye;function Ke(t){x.call(this,t)}function We(){0!=He&&(Ge[g(this)]=this),this.ya=this.ya,this.pa=this.pa}E(Ke,x),Ke.prototype.name="cancel";var He=0,Ge={};function ze(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=He)){var e=g(t);if(0!=He&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ge[e]}}We.prototype.ya=!1,We.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Qe=Object.freeze||function(t){return t},Ye=!Yt||9<=Number(ue),Xe=Yt&&!ae("9"),$e=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",l,e),s.removeEventListener("test",l,e)}catch(t){}return t}();function Je(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Ze(t,e){if(Je.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Jt){t:{try{Gt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Je.prototype.preventDefault=function(){this.defaultPrevented=!0},E(Ze,Je);var tn=Qe({2:"touch",3:"pen",4:"mouse"});Ze.prototype.preventDefault=function(){Ze.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Ze.prototype.g=function(){return this.a};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++nn,this.wa=this.Qa=!1}function on(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function an(t){this.src=t,this.a={},this.b=0}function sn(t,e){var n=e.type;n in t.a&&Y(t.a[n],e)&&(on(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function un(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==r)return i}return-1}an.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=un(t,e,r,i);return-1<a?(e=t[a],n||(e.Qa=!1)):((e=new rn(e,this.src,o,!!r,i)).Qa=n,t.push(e)),e};var cn="closure_lm_"+(1e6*Math.random()|0),hn={};function ln(t,e,n,r,i){if(r&&r.once)pn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)ln(t,e[o],n,r,i);else n=In(n),t&&t[en]?En(t,e,n,v(r)?!!r.capture:!!r,i):fn(t,e,n,!1,r,i)}function fn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=v(i)?!!i.capture:!!i,s=_n(t);if(s||(t[cn]=s=new an(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=bn,e=Ye?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)$e||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else n=In(n),t&&t[en]?Sn(t,e,n,v(r)?!!r.capture:!!r,i):fn(t,e,n,!0,r,i)}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=In(n),t&&t[en]?(t=t.v,(e=String(e).toString())in t.a&&(-1<(n=un(o=t.a[e],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=_n(t))&&(e=t.a[e.toString()],t=-1,e&&(t=un(e,n,r,i)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.wa){var e=t.src;if(e&&e[en])sn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_n(e))?(sn(n,t),0==n.b&&(n.src=null,e[cn]=null)):on(t)}}}function gn(t){return t in hn?hn[t]:hn[t]="on"+t}function yn(t,e,n,r){var i=!0;if((t=_n(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=mn(o,r),i=i&&!1!==o)}return i}function mn(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&vn(t),n.call(r,e)}function bn(t,e){if(t.wa)return!0;if(!Ye){if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Ze(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=yn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=yn(r[i],t,!1,e),n=n&&o}return n}return mn(t,new Ze(e,this))}function _n(t){return(t=t[cn])instanceof an?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(t){return d(t)?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function Tn(){We.call(this),this.v=new an(this),this.bc=this,this.hb=null}function En(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Sn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Cn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&sn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function kn(t,e,n){if(d(t))n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function Nn(t){var e=null;return new Ie((function(n,r){-1==(e=kn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw s.clearTimeout(e),t}))}function An(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Pn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Rn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Rn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Dn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];On(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)On(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function On(t,e){return Object.prototype.hasOwnProperty.call(t,e)}E(Tn,We),Tn.prototype[en]=!0,Tn.prototype.addEventListener=function(t,e,n,r){ln(this,t,e,n,r)},Tn.prototype.removeEventListener=function(t,e,n,r){dn(this,t,e,n,r)},Tn.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"==typeof t)t=new Je(t,n);else if(t instanceof Je)t.target=t.target||n;else{var i=t;yt(t=new Je(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=Cn(a,r,!0,t)&&i}if(i=Cn(a=t.b=n,r,!0,t)&&i,i=Cn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Cn(a=t.b=e[o],r,!1,t)&&i;return i},Tn.prototype.Da=function(){if(Tn.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)on(n[r]);delete e.a[t],e.b--}}this.hb=null},(e=Rn.prototype).X=function(){Dn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.Y=function(){return Dn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return On(this.b,t)?this.b[t]:e},e.set=function(t,e){On(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Mn(this,t.c),this.l=t.l,this.a=t.a,Fn(this,t.g),this.f=t.f,Un(this,rr(t.b)),this.h=t.h):t&&(n=String(t).match(xn))?(this.i=!!e,Mn(this,n[1]||"",!0),this.l=Kn(n[2]||""),this.a=Kn(n[3]||"",!0),Fn(this,n[4]),this.f=Kn(n[5]||"",!0),Un(this,n[6]||"",!0),this.h=Kn(n[7]||"")):(this.i=!!e,this.b=new $n(null,this.i))}function Mn(t,e,n){t.c=n?Kn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Un(t,e,n){e instanceof $n?(t.b=e,function(t,e){e&&!t.f&&(Jn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(tr(this,e),nr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Wn(e,Yn)),t.b=new $n(e,t.i))}function jn(t,e,n){t.b.set(e,n)}function qn(t,e){return t.b.get(e)}function Vn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function Bn(t,e,n,r){var i=new Ln(null,void 0);return t&&Mn(i,t),e&&(i.a=e),n&&Fn(i,n),r&&(i.f=r),i}function Kn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Wn(e,Gn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Wn(e,Gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Wn(n,"/"==n.charAt(0)?Qn:zn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Wn(n,Xn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Mn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Fn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ut(i,"./")||ut(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?Un(e,rr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Gn=/[#\/\?@]/g,zn=/[#\?:]/g,Qn=/[#\?]/g,Yn=/[#\?@]/g,Xn=/#/g;function $n(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Jn(t){t.a||(t.a=new Rn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Zn(t){var e=Pn(t);if(void 0===e)throw Error("Keys are undefined");var n=new $n(null,void 0);t=An(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?nr(n,i,o):n.add(i,o)}return n}function tr(t,e){Jn(t),e=ir(t,e),On(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,On((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Dn(t)))}function er(t,e){return Jn(t),e=ir(t,e),On(t.a.b,e)}function nr(t,e,n){tr(t,e),0<n.length&&(t.c=null,t.a.set(ir(t,e),J(n)),t.b+=n.length)}function rr(t){var e=new $n;return e.c=t.c,t.a&&(e.a=new Rn(t.a),e.b=t.b),e}function ir(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function or(t){var e=[];return sr(new ar,t,e),e.join("")}function ar(){}function sr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),sr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&("function"!=typeof(o=e[r])&&(n.push(i),hr(r,n),n.push(":"),sr(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":hr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(e=$n.prototype).add=function(t,e){Jn(this),this.c=null,t=ir(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){Jn(this),this.a.forEach((function(n,r){W(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.Y=function(){Jn(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.X=function(t){Jn(this);var e=[];if("string"==typeof t)er(this,t)&&(e=$(e,this.a.get(ir(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=$(e,t[n])}return e},e.set=function(t,e){return Jn(this),this.c=null,er(this,t=ir(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ur={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},cr=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function hr(t,e){e.push('"',t.replace(cr,(function(t){var e=ur[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ur[t]=e),e})),'"')}function lr(){var t=Rr();return Yt&&!!ue&&11==ue||/Edge\/\d+/.test(t)}function fr(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function pr(t,e){e=e||s.window;var n="about:blank";t&&(n=Dt(Ft(t)||qt)),e.location.href=n}function dr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<dr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function vr(t){return!!((t=(t||Rr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function gr(t){t=t||s.window;try{t.close()}catch(t){}}function yr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Rr().toLowerCase(),r&&(e.target=r,ut(n,"crios/")&&(e.target="_blank")),Nr(Rr())==Cr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Rt?n:Ft(void 0!==n.href?n.href:String(n))||qt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((ft("iPhone")&&!ft("iPod")&&!ft("iPad")||ft("iPad")||ft("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(mt(a=ge(document,"A"),"HTMLAnchorElement"),e=e instanceof Rt?e:Ut(e),a.href=Dt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Kt("",r,n,a),t=Dt(e),a&&($t&&ut(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ht(t)+'">',t=new Vt(t=(r=Et())?r.createHTML(t):t,null,Bt),r=a.document)&&(r.write(function(t){return t instanceof Vt&&t.constructor===Vt?t.a:(M("expected object of type SafeHtml, got '"+t+"' of type "+f(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Kt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var mr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,br=/^[^@]+@[^@]+$/;function _r(){var t=null;return new Ie((function(e){"complete"==s.document.readyState?e():(t=function(){e()},pn(window,"load",t))})).o((function(e){throw dn(window,"load",t),e}))}function wr(t){return t=t||Rr(),!("file:"!==Mr()&&"ionic:"!==Mr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ir(){var t=s.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Tr(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function Er(){return Lt.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Lt.INTERNAL.hasOwnProperty("node")?"Node":Tr()?"Worker":"Browser"}function Sr(){var t=Er();return"ReactNative"===t||"Node"===t}var Cr="Firefox",kr="Chrome";function Nr(t){var e=t.toLowerCase();return ut(e,"opera/")||ut(e,"opr/")||ut(e,"opios/")?"Opera":ut(e,"iemobile")?"IEMobile":ut(e,"msie")||ut(e,"trident/")?"IE":ut(e,"edge/")?"Edge":ut(e,"firefox/")?Cr:ut(e,"silk/")?"Silk":ut(e,"blackberry")?"Blackberry":ut(e,"webos")?"Webos":!ut(e,"safari/")||ut(e,"chrome/")||ut(e,"crios/")||ut(e,"android")?!ut(e,"chrome/")&&!ut(e,"crios/")||ut(e,"edge/")?ut(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":kr:"Safari"}var Ar={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Pr(t,e){e=e||[];var n,r=[],i={};for(n in Ar)i[Ar[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Er())?r=Nr(i=Rr()):"Worker"===r&&(r=Nr(i=Rr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Rr(){return s.navigator&&s.navigator.userAgent||""}function Dr(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Or(){try{var t=s.localStorage,e=Vr();if(t)return t.setItem(e,"1"),t.removeItem(e),!lr()||!!s.indexedDB}catch(t){return Tr()&&!!s.indexedDB}return!1}function xr(){return(Lr()||"chrome-extension:"===Mr()||wr())&&!Sr()&&Or()&&!Tr()}function Lr(){return"http:"===Mr()||"https:"===Mr()}function Mr(){return s.location&&s.location.protocol||null}function Fr(t){return!vr(t=t||Rr())&&Nr(t)!=Cr}function Ur(t){return void 0===t?null:or(t)}function jr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function qr(t){if(null!==t)return JSON.parse(t)}function Vr(t){return t||Math.floor(1e9*Math.random()).toString()}function Br(t){return"Safari"!=Nr(t=t||Rr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Kr(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Wr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Rr(),e=Er(),this.b=vr(t)||"ReactNative"===e}function Hr(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Gr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zr(){return!(!Dr("fireauth.oauthhelper",s)&&!Dr("fireauth.iframe",s))}Wr.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!Lr()&&"chrome-extension:"!==Mr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Qr,Yr={};function Xr(t){Yr[t]||(Yr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var $r={};Object.defineProperty($r,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty($r,"abcd",{configurable:!0,enumerable:!0,value:2}),Qr=2==$r.abcd}catch(t){Qr=!1}function Jr(t,e,n){Qr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Zr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Jr(t,n,e[n])}function ti(t){var e={};return Zr(e,t),e}function ei(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Jr(e,n,ei(t[n]));return e}function ni(t){var e=t&&(t[si]?"phone":null);if(!(e&&t&&t[ai]))throw new C("internal-error","Internal assert: invalid MultiFactorInfo object");Jr(this,"uid",t[ai]),Jr(this,"displayName",t[ii]||null);var n=null;t[oi]&&(n=new Date(t[oi]).toUTCString()),Jr(this,"enrollmentTime",n),Jr(this,"factorId",e)}function ri(t){try{var e=new ui(t)}catch(t){e=null}return e}ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ii="displayName",oi="enrolledAt",ai="mfaEnrollmentId",si="phoneInfo";function ui(t){ni.call(this,t),Jr(this,"phoneNumber",t[si])}function ci(t){var e={},n=t[pi],r=t[vi],i=t[gi];if(t=ri(t[di]),!i||i!=li&&i!=fi&&!n||i==fi&&!r||i==hi&&!t)throw Error("Invalid checkActionCode response!");i==fi?(e[mi]=n||null,e[_i]=n||null,e[yi]=r):(e[mi]=r||null,e[_i]=r||null,e[yi]=n||null),e[bi]=t||null,Jr(this,Ii,i),Jr(this,wi,ei(e))}E(ui,ni),ui.prototype.w=function(){var t=ui.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var hi="REVERT_SECOND_FACTOR_ADDITION",li="EMAIL_SIGNIN",fi="VERIFY_AND_CHANGE_EMAIL",pi="email",di="mfaInfo",vi="newEmail",gi="requestType",yi="email",mi="fromEmail",bi="multiFactorInfo",_i="previousEmail",wi="data",Ii="operation";function Ti(t){var e=qn(t=Vn(t),Ei)||null,n=qn(t,Si)||null,r=qn(t,Ni)||null;if(r=r&&Pi[r]||null,!e||!n||!r)throw new C("argument-error",Ei+", "+Si+"and "+Ni+" are required in a valid action code URL.");Zr(this,{apiKey:e,operation:r,code:n,continueUrl:qn(t,Ci)||null,languageCode:qn(t,ki)||null,tenantId:qn(t,Ai)||null})}var Ei="apiKey",Si="oobCode",Ci="continueUrl",ki="languageCode",Ni="mode",Ai="tenantId",Pi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:hi,signIn:li,verifyAndChangeEmail:fi,verifyEmail:"VERIFY_EMAIL"};function Ri(t){try{return new Ti(t)}catch(t){return null}}function Di(t){var e=t[Fi];if(void 0===e)throw new C("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new C("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Oi];if(n&&"object"==typeof n){e=n[qi];var r=n[Ui];if(n=n[ji],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new C("argument-error",Ui+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new C("argument-error",ji+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new C("argument-error",qi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new C("missing-android-pkg-name")}}else if(void 0!==n)throw new C("argument-error",Oi+" property must be a non null object when specified.");if(this.f=null,(e=t[Mi])&&"object"==typeof e){if("string"==typeof(e=e[Vi])&&e.length)this.f=e;else if(void 0!==e)throw new C("argument-error",Vi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new C("argument-error",Mi+" property must be a non null object when specified.");if(void 0!==(e=t[Li])&&"boolean"!=typeof e)throw new C("argument-error",Li+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[xi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new C("argument-error",xi+" property must be a non empty string when specified.");this.i=t||null}var Oi="android",xi="dynamicLinkDomain",Li="handleCodeInApp",Mi="iOS",Fi="url",Ui="installApp",ji="minimumVersion",qi="packageName",Vi="bundleId";function Bi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ki=null;function Wi(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ki[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ki){Ki={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ki[o]&&(Ki[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}function Hi(t){var e=zi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Gi(t){try{return new Hi(t)}catch(t){return null}}function zi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=Wi(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(t){}return null}Hi.prototype.T=function(){return this.f},Hi.prototype.l=function(){return this.c},Hi.prototype.toString=function(){return this.h};var Qi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Yi=["client_id","response_type","scope","redirect_uri","state"],Xi={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:Yi},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:Yi},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:Yi},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Qi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function $i(t){for(var e in Xi)if(Xi[e].fa==t)return Xi[e];return null}function Ji(t){var e={};e["facebook.com"]=ro,e["google.com"]=oo,e["github.com"]=io,e["twitter.com"]=ao;var n=t&&t[to];try{if(n)return e[n]?new e[n](t):new no(t);if(void 0!==t[Zi])return new eo(t)}catch(t){}return null}var Zi="idToken",to="providerId";function eo(t){var e=t[to];if(!e&&t[Zi]){var n=Gi(t[Zi]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Jr(this,"providerId",e),Jr(this,"isNewUser",n)}function no(t){eo.call(this,t),Jr(this,"profile",ei((t=qr(t.rawUserInfo||"{}"))||{}))}function ro(t){if(no.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function io(t){if(no.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Jr(this,"username",this.profile&&this.profile.login||null)}function oo(t){if(no.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function ao(t){if(no.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Jr(this,"username",t.screenName||null)}function so(t){var e=Vn(t),n=qn(e,"link"),r=qn(Vn(n),"link");return e=qn(e,"deep_link_id"),qn(Vn(e),"link")||e||r||n||t}function uo(t,e){if(!t&&!e)throw new C("internal-error","Internal assert: no raw session string available");if(t&&e)throw new C("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?co:ho}E(no,eo),E(ro,no),E(io,no),E(oo,no),E(ao,no);var co="enroll",ho="signin";function lo(){}function fo(t,e){return t.then((function(t){if(t[es]){var n=Gi(t[es]);if(!n||e!=n.i)throw new C("user-mismatch");return t}throw new C("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==A+"user-not-found"?new C("user-mismatch"):t}))}function po(t,e){if(!e)throw new C("internal-error","failed to construct a credential");this.a=e,Jr(this,"providerId",t),Jr(this,"signInMethod",t)}function vo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function go(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new po(t.providerId,t.pendingToken)}catch(t){}return null}function yo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Jr(this,"idToken",e.idToken),e.accessToken&&Jr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Jr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new C("internal-error","failed to construct a credential");Jr(this,"accessToken",e.oauthToken),Jr(this,"secret",e.oauthTokenSecret)}Jr(this,"providerId",t),Jr(this,"signInMethod",n)}function mo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Zn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function bo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new yo(t.providerId,e,t.signInMethod)}catch(t){}}return null}function _o(t,e){this.Qc=e||[],Zr(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=($i(t)||{}).Ja||null,this.pb=null}function wo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new C("argument-error",'SAML provider IDs must be prefixed with "saml."');_o.call(this,t,[])}function Io(t){_o.call(this,t,Yi),this.a=[]}function To(){Io.call(this,"facebook.com")}function Eo(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new To).credential({accessToken:e})}function So(){Io.call(this,"github.com")}function Co(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return v(t)&&(e=t.accessToken),(new So).credential({accessToken:e})}function ko(){Io.call(this,"google.com"),this.Ca("profile")}function No(t,e){var n=t;return v(t)&&(n=t.idToken,e=t.accessToken),(new ko).credential({idToken:n,accessToken:e})}function Ao(){_o.call(this,"twitter.com",Qi)}function Po(t,e){var n=t;if(v(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new C("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new yo("twitter.com",n,"twitter.com")}function Ro(t,e,n){this.a=t,this.f=e,Jr(this,"providerId","password"),Jr(this,"signInMethod",n===Oo.EMAIL_LINK_SIGN_IN_METHOD?Oo.EMAIL_LINK_SIGN_IN_METHOD:Oo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Do(t){return t&&t.email&&t.password?new Ro(t.email,t.password,t.signInMethod):null}function Oo(){Zr(this,{providerId:"password",isOAuthProvider:!1})}function xo(t,e){if(!(e=Lo(e)))throw new C("argument-error","Invalid email link!");return new Ro(t,e.code,Oo.EMAIL_LINK_SIGN_IN_METHOD)}function Lo(t){return(t=Ri(t=so(t)))&&t.operation===li?t:null}function Mo(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new C("internal-error");this.a=t,Jr(this,"providerId","phone"),this.fa="phone",Jr(this,"signInMethod","phone")}function Fo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return W(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Mo(e)}return null}function Uo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function jo(t){try{this.a=t||Lt.auth()}catch(t){throw new C("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Zr(this,{providerId:"phone",isOAuthProvider:!1})}function qo(t,e){if(!t)throw new C("missing-verification-id");if(!e)throw new C("missing-verification-code");return new Mo({fb:t,eb:e})}function Vo(t){if(t.temporaryProof&&t.phoneNumber)return new Mo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return No(o,n);case"facebook.com":return Eo(n);case"github.com":return Co(n);case"twitter.com":return Po(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new po(e,a):new yo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Io(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function Bo(t){if(!t.isOAuthProvider)throw new C("invalid-oauth-provider")}function Ko(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new C("invalid-auth-event");if(this.g&&this.a)throw new C("invalid-auth-event");if(this.g&&!this.f)throw new C("invalid-auth-event")}function Wo(t){return(t=t||{}).type?new Ko(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&k(t.error),t.postBody,t.tenantId):null}function Ho(){this.b=null,this.a=[]}uo.prototype.Ha=function(){return this.a?Ae(this.a):Ae(this.b)},uo.prototype.w=function(){return this.type==co?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},lo.prototype.ka=function(){},lo.prototype.b=function(){},lo.prototype.c=function(){},lo.prototype.w=function(){},po.prototype.ka=function(t){return Ts(t,vo(this))},po.prototype.b=function(t,e){var n=vo(this);return n.idToken=e,Es(t,n)},po.prototype.c=function(t,e){return fo(Ss(t,vo(this)),e)},po.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},yo.prototype.ka=function(t){return Ts(t,mo(this))},yo.prototype.b=function(t,e){var n=mo(this);return n.idToken=e,Es(t,n)},yo.prototype.c=function(t,e){return fo(Ss(t,mo(this)),e)},yo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},_o.prototype.Ka=function(t){return this.Jb=vt(t),this},E(wo,_o),E(Io,_o),Io.prototype.Ca=function(t){return Q(this.a,t)||this.a.push(t),this},Io.prototype.Rb=function(){return J(this.a)},Io.prototype.credential=function(t,e){var n;if(!(n=v(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new C("argument-error","credential failed: must provide the ID token and/or the access token.");return new yo(this.providerId,n,this.providerId)},E(To,Io),Jr(To,"PROVIDER_ID","facebook.com"),Jr(To,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),E(So,Io),Jr(So,"PROVIDER_ID","github.com"),Jr(So,"GITHUB_SIGN_IN_METHOD","github.com"),E(ko,Io),Jr(ko,"PROVIDER_ID","google.com"),Jr(ko,"GOOGLE_SIGN_IN_METHOD","google.com"),E(Ao,_o),Jr(Ao,"PROVIDER_ID","twitter.com"),Jr(Ao,"TWITTER_SIGN_IN_METHOD","twitter.com"),Ro.prototype.ka=function(t){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?au(t,Os,{email:this.a,oobCode:this.f}):au(t,eu,{email:this.a,password:this.f})},Ro.prototype.b=function(t,e){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?au(t,xs,{idToken:e,email:this.a,oobCode:this.f}):au(t,zs,{idToken:e,email:this.a,password:this.f})},Ro.prototype.c=function(t,e){return fo(this.ka(t),e)},Ro.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Zr(Oo,{PROVIDER_ID:"password"}),Zr(Oo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Zr(Oo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Mo.prototype.ka=function(t){return t.gb(Uo(this))},Mo.prototype.b=function(t,e){var n=Uo(this);return n.idToken=e,au(t,ru,n)},Mo.prototype.c=function(t,e){var n=Uo(this);return n.operation="REAUTH",fo(t=au(t,iu,n),e)},Mo.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},jo.prototype.gb=function(t,e){var n=this.a.a;return Ae(e.verify()).then((function(r){if("string"!=typeof r)throw new C("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=v(t)?t.session:null,o=v(t)?t.phoneNumber:t;return(i&&i.type==co?i.Ha().then((function(t){return function(t,e){return au(t,Ys,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==ho?i.Ha().then((function(e){return function(t,e){return au(t,Xs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return au(t,Hs,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new C("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Zr(jo,{PROVIDER_ID:"phone"}),Zr(jo,{PHONE_SIGN_IN_METHOD:"phone"}),Ko.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Ko.prototype.T=function(){return this.h},Ko.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Go,zo=null;function Qo(t){var e="unauthorized-domain",n=void 0,r=Vn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Wt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Wt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",C.call(this,e,n)}function Yo(t,e,n){C.call(this,t,n),(t=e||{}).Kb&&Jr(this,"email",t.Kb),t.ea&&Jr(this,"phoneNumber",t.ea),t.credential&&Jr(this,"credential",t.credential),t.$b&&Jr(this,"tenantId",t.$b)}function Xo(t){if(t.code){var e=t.code||"";0==e.indexOf(A)&&(e=e.substring(A.length));var n={credential:Vo(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new C(e,t.message||void 0);return new Yo(e,n,t.message)}return null}function $o(){}function Jo(t){return t.c||(t.c=t.b())}function Zo(){}function ta(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ea(){}function na(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=w(this.qc,this),this.a.onerror=w(this.Tb,this),this.a.onprogress=w(this.rc,this),this.a.ontimeout=w(this.vc,this)}function ra(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ia(t,e,n){this.reset(t,e,n,void 0,void 0)}E(Qo,C),E(Yo,C),Yo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&yt(t,e),t},Yo.prototype.toJSON=function(){return this.w()},$o.prototype.c=null,E(Zo,$o),Zo.prototype.a=function(){var t=ta(this);return t?new ActiveXObject(t):new XMLHttpRequest},Zo.prototype.b=function(){var t={};return ta(this)&&(t[0]=!0,t[1]=!0),t},Go=new Zo,E(ea,$o),ea.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new na;throw Error("Unsupported browser")},ea.prototype.b=function(){return{}},(e=na.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ra(this,4)},e.Tb=function(){this.status=500,this.response=this.responseText="",ra(this,4)},e.vc=function(){this.Tb()},e.rc=function(){this.status=200,ra(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ia.prototype.a=null;function oa(t){this.f=t,this.b=this.c=this.a=null}function aa(t,e){this.name=t,this.value=e}ia.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||T(),delete this.a},aa.prototype.toString=function(){return this.name};var sa=new aa("SEVERE",1e3),ua=new aa("WARNING",900),ca=new aa("CONFIG",700),ha=new aa("FINE",500);function la(t){return t.c?t.c:t.a?la(t.a):(M("Root logger has no level set."),null)}oa.prototype.log=function(t,e,n){if(t.value>=la(this).value)for(d(e)&&(e=e()),t=new ia(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var fa={},pa=null;function da(t){var e;if(pa||(pa=new oa(""),fa[""]=pa,pa.c=ca),!(e=fa[t])){e=new oa(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=da(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,fa[t]=e}return e}function va(t,e){t&&t.log(ha,e,void 0)}function ga(t){this.f=t}function ya(t){Tn.call(this),this.u=t,this.h=void 0,this.readyState=ma,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=da("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}E(ga,$o),ga.prototype.a=function(){return new ya(this.f)},ga.prototype.b=function(t){return function(){return t}}({}),E(ya,Tn);var ma=0;function ba(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function _a(t){t.readyState=4,t.g=null,t.c=null,t.m=null,wa(t)}function wa(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ia(t){Tn.call(this),this.headers=new Rn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ta,this.u=this.S=!1}(e=ya.prototype).open=function(t,e){if(this.readyState!=ma)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,wa(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,_a(this)),this.readyState=ma},e.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,wa(this)),this.a&&(this.readyState=3,wa(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ba(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},e.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?_a(this):wa(this),3==this.readyState&&ba(this)}},e.tc=function(t){this.a&&(this.response=this.responseText=t,_a(this))},e.sc=function(t){this.a&&(this.response=t,_a(this))},e.Va=function(t){var e=this.i;e&&e.log(ua,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&_a(this)},e.setRequestHeader=function(t,e){this.l.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(ua,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(ua,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ya.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),E(Ia,Tn);var Ta="";Ia.prototype.b=da("goog.net.XhrIo");var Ea=/^https?$/i,Sa=["POST","PUT"];function Ca(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Go.a(),t.C=t.D?Jo(t.D):Jo(Go),t.a.onreadystatechange=w(t.Wb,t);try{va(t.b,La(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){return va(t.b,La(t,"Error opening Xhr: "+e.message)),void Na(t,e)}e=r||"";var o=new Rn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)W(t,e,void 0);else for(var n=Pn(t),r=An(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=ka,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=s.FormData&&e instanceof s.FormData,!Q(Sa,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Da(t),0<t.g&&(t.u=function(t){return Yt&&ae(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),va(t.b,La(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=w(t.Ma,t)):t.s=kn(t.Ma,t.g,t)),va(t.b,La(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){va(t.b,La(t,"Send error: "+e.message)),Na(t,e)}}function ka(t){return"content-type"==t.toLowerCase()}function Na(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Aa(t),Ra(t)}function Aa(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Pa(t){if(t.c&&void 0!==a)if(t.C[1]&&4==Oa(t)&&2==xa(t))va(t.b,La(t,"Local request error detected and ignored"));else if(t.i&&4==Oa(t))kn(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==Oa(t)){va(t.b,La(t,"Request complete")),t.c=!1;try{var e,n=xa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(xn)[1]||null;if(!o&&s.self&&s.self.location){var u=s.self.location.protocol;o=u.substr(0,u.length-1)}i=!Ea.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Oa(t)?t.a.statusText:""}catch(e){va(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+xa(t)+"]",Aa(t)}}finally{Ra(t)}}}function Ra(t,e){if(t.a){Da(t);var n=t.a,r=t.C[0]?l:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(sa,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Da(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(s.clearTimeout(t.s),t.s=null)}function Oa(t){return t.a?t.a.readyState:0}function xa(t){try{return 2<Oa(t)?t.a.status:-1}catch(t){return-1}}function La(t,e){return e+" ["+t.P+" "+t.l+" "+xa(t)+"]"}function Ma(t){var e=za;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Fa(t,e,n){t.a=!0,t.c=n,t.f=!e,Va(t)}function Ua(t){if(t.a){if(!t.v)throw new Ba(t);t.v=!1}}function ja(t,e,n,r){t.g.push([e,n,r]),t.a&&Va(t)}function qa(t){return z(t.g,(function(t){return d(t[1])}))}function Va(t){if(t.h&&t.a&&qa(t)){var e=t.h,n=Ha[e];n&&(s.clearTimeout(n.a),delete Ha[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var u=o.call(i||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(O(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,qa(t)||(n=!0)}}t.c=e,r&&(u=w(t.m,t,!0),r=w(t.m,t,!1),e instanceof Ma?(ja(e,u,r),e.C=!0):e.then(u,r)),n&&(e=new Wa(e),Ha[e.a]=e,t.h=e.a)}function Ba(){x.call(this)}function Ka(){x.call(this)}function Wa(t){this.a=s.setTimeout(w(this.c,this),0),this.b=t}(e=Ia.prototype).Ma=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",va(this.b,La(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(va(this.b,La(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ra(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ra(this,!0)),Ia.bb.Da.call(this)},e.Wb=function(){this.ya||(this.N||this.i||this.f?Pa(this):this.Jc())},e.Jc=function(){Pa(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ta:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(sa,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return va(this.b,"Can not get response: "+t.message),null}},Ma.prototype.cancel=function(t){if(this.a)this.c instanceof Ma&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Ka(this),Ua(this),Fa(this,!1,t))}},Ma.prototype.m=function(t,e){this.i=!1,Fa(this,t,e)},Ma.prototype.then=function(t,e,n){var r,i,o=new Ie((function(t,e){r=t,i=e}));return ja(this,r,(function(t){t instanceof Ka?o.cancel():i(t)})),o.then(t,e,n)},Ma.prototype.$goog_Thenable=!0,E(Ba,x),Ba.prototype.message="Deferred has already fired",Ba.prototype.name="AlreadyCalledError",E(Ka,x),Ka.prototype.message="Deferred was canceled",Ka.prototype.name="CanceledError",Wa.prototype.c=function(){throw delete Ha[this.a],this.b};var Ha={};function Ga(t){var e={},n=e.document||document,r=Ct(t).toString(),i=ge(document,"SCRIPT"),o={Xb:i,Ma:void 0},a=new Ma(o),u=null,l=null!=e.timeout?e.timeout:5e3;return 0<l&&(u=window.setTimeout((function(){Qa(i,!0);var t=new $a(Xa,"Timeout reached for loading script "+r);Ua(a),Fa(a,!1,t)}),l),o.Ma=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Qa(i,e.xd||!1,u),Ua(a),Fa(a,!0,null))},i.onerror=function(){Qa(i,!0,u);var t=new $a(Ya,"Error while loading script "+r);Ua(a),Fa(a,!1,t)},yt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),le(i,o),function(t,e){mt(t,"HTMLScriptElement"),t.src=Ct(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=s?e=h(e.document):(null===c&&(c=h(s.document)),e=c),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function za(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&Qa(t,!0,this.Ma)}}function Qa(t,e,n){null!=n&&s.clearTimeout(n),t.onload=l,t.onerror=l,t.onreadystatechange=l,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ya=0,Xa=1;function $a(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),x.call(this,n),this.code=t}function Ja(t){this.f=t}function Za(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||ns,this.g=vt(t.secureTokenHeaders||rs),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||is,this.a=vt(t.firebaseHeaders||os),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Er(),!(n=s.XMLHttpRequest||n&&Lt.INTERNAL.node&&Lt.INTERNAL.node.XMLHttpRequest)&&!Tr())throw new C("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Tr()?this.f=new ga(self):Sr()?this.f=new Ja(n):this.f=new ea,this.b=null}E($a,x),E(Ja,$o),Ja.prototype.a=function(){return new this.f},Ja.prototype.b=function(){return{}};var ts,es="idToken",ns=new Wr(3e4,6e4),rs={"Content-Type":"application/x-www-form-urlencoded"},is=new Wr(3e4,6e4),os={"Content-Type":"application/json"};function as(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ss(t,e){e&&(t.l=us("https://securetoken.googleapis.com/v1/token",e),t.h=us("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=us("https://identitytoolkit.googleapis.com/v2/",e))}function us(t,e){return t=Vn(t),e=Vn(e.url),t.f=t.a+t.f,Mn(t,e.c),t.a=e.a,Fn(t,e.g),t.toString()}function cs(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function hs(t,e,n,r,i,o,a){(function(){var t=Rr();return!((t=Nr(t)!=kr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Yt&&ue&&!(9<ue))})()||Tr()?t=w(t.u,t):(ts||(ts=new Ie((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{s[fs]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){ja(t,null,e,void 0)}(Ga(kt(ls,{onload:fs})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=w(t.s,t)),t(e,n,r,i,o,a)}Za.prototype.T=function(){return this.b},Za.prototype.u=function(t,e,n,r,i,o){if(Tr()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new C("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Ia(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout((function(){a.dispatchEvent("timeout")}),o)}En(a,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return va(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Sn(a,"ready",(function(){u&&clearTimeout(u),ze(this)})),Sn(a,"timeout",(function(){u&&clearTimeout(u),ze(this),e&&e(null)})),Ca(a,t,n,r,i)};var ls=new bt(Tt,"https://apis.google.com/js/client.js?onload=%{onload}"),fs="__fcb"+Math.floor(1e6*Math.random()).toString();function ps(t,e,n,r,i,o,a){var s=Vn(e+n);jn(s,"key",t.c),a&&jn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&jn(s,c,i[c]);return new Ie((function(e,n){hs(t,s.toString(),(function(t){t?t.error?n(uu(t,o||{})):e(t):n(new C("network-request-failed"))}),r,u?void 0:or(jr(i)),t.a,t.v.get())}))}function ds(t){if("string"!=typeof(t=t.email)||!br.test(t))throw new C("invalid-email")}function vs(t){"email"in t&&ds(t)}function gs(t){if(!t[es]){if(t.mfaPendingCredential)throw new C("multi-factor-auth-required",null,vt(t));throw new C("internal-error")}}function ys(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new C("internal-error")}else{if(!t.sessionInfo)throw new C("missing-verification-id");if(!t.code)throw new C("missing-verification-code")}}Za.prototype.s=function(t,e,n,r,i){var o=this;ts.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Za.prototype.Ab=function(){return au(this,Qs,{})},Za.prototype.Cb=function(t,e){return au(this,Gs,{idToken:t,email:e})},Za.prototype.Db=function(t,e){return au(this,zs,{idToken:t,password:e})};var ms={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function bs(t){if(!t.phoneVerificationInfo)throw new C("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new C("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new C("missing-verification-code")}function _s(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new C("internal-error")}function ws(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(er(t=new $n(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Is(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Xo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Xo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Xo(t)):t.errorMessage&&(e=su(t.errorMessage)),e)throw e;gs(t)}function Ts(t,e){return e.returnIdpCredential=!0,au(t,$s,e)}function Es(t,e){return e.returnIdpCredential=!0,au(t,Zs,e)}function Ss(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,au(t,Js,e)}function Cs(t){if(!t.oobCode)throw new C("invalid-action-code")}(e=Za.prototype).Eb=function(t,e){var n={idToken:t},r=[];return pt(ms,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),au(this,Gs,n)},e.wb=function(t,e){return yt(t={requestType:"PASSWORD_RESET",email:t},e),au(this,Vs,t)},e.xb=function(t,e){return yt(t={requestType:"EMAIL_SIGNIN",email:t},e),au(this,Us,t)},e.vb=function(t,e){return yt(t={requestType:"VERIFY_EMAIL",idToken:t},e),au(this,js,t)},e.Fb=function(t,e,n){return yt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),au(this,qs,t)},e.gb=function(t){return au(this,nu,t)},e.ob=function(t,e){return au(this,Ws,{oobCode:t,newPassword:e})},e.Sa=function(t){return au(this,Ns,{oobCode:t})},e.kb=function(t){return au(this,ks,{oobCode:t})};var ks={endpoint:"setAccountInfo",A:Cs,Z:"email",B:!0},Ns={endpoint:"resetPassword",A:Cs,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new C("internal-error")},B:!0},As={endpoint:"signupNewUser",A:function(t){if(ds(t),!t.password)throw new C("weak-password")},G:gs,V:!0,B:!0},Ps={endpoint:"createAuthUri",B:!0},Rs={endpoint:"deleteAccount",O:["idToken"]},Ds={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new C("internal-error")}},Os={endpoint:"emailLinkSignin",O:["email","oobCode"],A:ds,G:gs,V:!0,B:!0},xs={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:ds,G:gs,V:!0},Ls={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:bs,G:gs,B:!0,Na:!0},Ms={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:bs,G:gs,B:!0,Na:!0},Fs={endpoint:"getAccountInfo"},Us={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new C("internal-error");ds(t)},Z:"email",B:!0},js={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",B:!0},qs={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new C("internal-error")},Z:"email",B:!0},Vs={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new C("internal-error");ds(t)},Z:"email",B:!0},Bs={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Ks={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new C("internal-error")}},Ws={endpoint:"resetPassword",A:Cs,Z:"email",B:!0},Hs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Gs={endpoint:"setAccountInfo",O:["idToken"],A:vs,V:!0},zs={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(vs(t),!t.password)throw new C("weak-password")},G:gs,V:!0},Qs={endpoint:"signupNewUser",G:gs,V:!0,B:!0},Ys={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new C("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new C("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new C("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new C("internal-error")},B:!0,Na:!0},Xs={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new C("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new C("internal-error")},B:!0,Na:!0},$s={endpoint:"verifyAssertion",A:_s,Za:ws,G:Is,V:!0,B:!0},Js={endpoint:"verifyAssertion",A:_s,Za:ws,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new C("user-not-found");if(t.errorMessage)throw su(t.errorMessage);gs(t)},V:!0,B:!0},Zs={endpoint:"verifyAssertion",A:function(t){if(_s(t),!t.idToken)throw new C("internal-error")},Za:ws,G:Is,V:!0},tu={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new C("invalid-custom-token")},G:gs,V:!0,B:!0},eu={endpoint:"verifyPassword",A:function(t){if(ds(t),!t.password)throw new C("wrong-password")},G:gs,V:!0,B:!0},nu={endpoint:"verifyPhoneNumber",A:ys,G:gs,B:!0},ru={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new C("internal-error");ys(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Xo(t);gs(t)}},iu={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ys,G:gs,B:!0},ou={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[es]^!!t.refreshToken)throw new C("internal-error")},B:!0,Na:!0};function au(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.O))return Pe(new C("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return Ae(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),ps(t,i?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)})).then((function(t){return r=t,e.Za?e.Za(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new C("internal-error");return r[e.Z]}))}function su(t){return uu({error:{errors:[{message:t}],code:400,message:t}})}function uu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new C(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",yt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new C(r[i],e);return!e&&t&&(e=Ur(t)),new C("internal-error",e)}function cu(t){this.b=t,this.a=null,this.sb=function(t){return(pu||(pu=new Ie((function(t,e){function n(){Kr(),Dr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Kr(),e(Error("Network Error"))},timeout:lu.get()})}if(Dr("gapi.iframes.Iframe"))t();else if(Dr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){Dr("gapi.load")?n():e(Error("Network Error"))},Ae(Ga(r=kt(hu,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw pu=null,t})))).then((function(){return new Ie((function(e,n){Dr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),fu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var hu=new bt(Tt,"https://apis.google.com/js/api.js?onload=%{onload}"),lu=new Wr(3e4,6e4),fu=new Wr(5e3,15e3),pu=null;function du(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,this.g?t=Bn((t=Vn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):t=Bn("https",this.l,null,"/__/auth/iframe"),this.a=t,jn(this.a,"apiKey",this.h),jn(this.a,"appName",this.i),this.b=null,this.c=[]}function vu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function gu(t){try{return Lt.app(t).auth().Ga()}catch(t){return[]}}function yu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function mu(t){var e=fr();return function(t){return au(t,Bs,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Vn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Vn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:mr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Qo(fr())}))}function bu(t){return t.m||(t.m=_r().then((function(){if(!t.u){var e=t.c,n=t.i,r=gu(t.b),i=new du(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=J(r||[]),t.u=i.toString()}t.v=new cu(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then((function(){t.a.register("authEvent",e,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Wo(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ae(n)}return n.status="ERROR",Ae(n)}))}(t)}))),t.m}function _u(t){return t.l||(t.C=t.c?Pr(t.c,gu(t.b)):null,t.l=new Za(t.g,D(t.i),t.C),t.f&&ss(t.l,t.f)),t.l}function wu(t,e,n,r,i,o,a,s,u,c,h,l){return(t=new vu(t,e,n,r,i,l)).l=o,t.g=a,t.i=s,t.b=vt(u||null),t.f=c,t.zb(h).toString()}function Iu(t){if(this.a=t||Lt.INTERNAL.reactNative&&Lt.INTERNAL.reactNative.AsyncStorage,!this.a)throw new C("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Tu(t){this.b=t,this.a={},this.f=w(this.c,this)}du.prototype.toString=function(){return this.f?jn(this.a,"v",this.f):tr(this.a.b,"v"),this.b?jn(this.a,"eid",this.b):tr(this.a.b,"eid"),this.c.length?jn(this.a,"fw",this.c.join(",")):tr(this.a.b,"fw"),this.a.toString()},vu.prototype.zb=function(t){return this.h=t,this},vu.prototype.toString=function(){if(this.v){var t=Vn(this.v.url);t=Bn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Bn("https",this.u,null,"/__/auth/handler");if(jn(t,"apiKey",this.s),jn(t,"appName",this.c),jn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=Lt.app(this.c).auth().la()}catch(t){n=null}for(var r in e.pb=n,jn(t,"providerId",this.a.providerId),e=jr((n=this.a).Jb))e[r]=e[r].toString();r=n.Qc,e=vt(e);for(var i=0;i<r.length;i++){var o=r[i];o in e&&delete e[o]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),dt(e)||jn(t,"customParameters",Ur(e))}if("function"==typeof this.a.Rb&&((n=this.a.Rb()).length&&jn(t,"scopes",n.join(","))),this.l?jn(t,"redirectUrl",this.l):tr(t.b,"redirectUrl"),this.g?jn(t,"eventId",this.g):tr(t.b,"eventId"),this.i?jn(t,"v",this.i):tr(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!qn(t,a)&&jn(t,a,this.b[a]);return this.h?jn(t,"tid",this.h):tr(t.b,"tid"),this.f?jn(t,"eid",this.f):tr(t.b,"eid"),(a=gu(this.c)).length&&jn(t,"fw",a.join(",")),t.toString()},(e=yu.prototype).Pb=function(t,e,n){var r=new C("popup-closed-by-user"),i=new C("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return bu(t).then((function(){return function(t,e){return t.sb.then((function(){return new Ie((function(n){t.a.send(e.type,e,n,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&gr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Ie((function(e){return function n(){Nn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return Nn(n).then((function(){e(r)}))}))},e.Yb=function(){var t=Rr();return!Fr(t)&&!Br(t)},e.Ub=function(){return!1},e.Nb=function(t,e,n,r,i,o,a,s){if(!t)return Pe(new C("popup-blocked"));if(a&&!Fr())return this.ma().o((function(e){gr(t),i(e)})),r(),Ae();this.a||(this.a=mu(_u(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw gr(t),i(e),e}));return r(),e})).then((function(){(Bo(n),a)||pr(wu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},e.Ob=function(t,e,n,r){this.a||(this.a=mu(_u(this)));var i=this;return this.a.then((function(){Bo(e),pr(wu(i.s,i.g,i.b,t,e,fr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},e.ma=function(){var t=this;return bu(this).then((function(){return t.v.sb})).o((function(){throw t.a=null,new C("network-request-failed")}))},e.ac=function(){return!0},e.Ea=function(t){this.h.push(t)},e.Ta=function(t){X(this.h,(function(e){return e==t}))},(e=Iu.prototype).get=function(t){return Ae(this.a.getItem(t)).then((function(t){return t&&qr(t)}))},e.set=function(t,e){return Ae(this.a.setItem(t,Ur(e)))},e.U=function(t){return Ae(this.a.removeItem(t))},e.ca=function(){},e.ia=function(){};var Eu,Su=[];function Cu(t,e,n){dt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function ku(t){this.a=t}function Nu(t){this.c=t,this.b=!1,this.a=[]}function Au(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Pe(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ie((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return Pu(t,c),e})).o((function(e){throw Pu(t,c),e}))}function Pu(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),X(t.a,(function(t){return t==e}))}}function Ru(){if(!Lu())throw new C("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=s.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Tr()&&self?(this.v=function(){var t=Tr()?self:null;if(W(Su,(function(n){n.b==t&&(e=n)})),!e){var e=new Tu(t);Su.push(e)}return e}(),Cu(this.v,"keyChanged",(function(e,n){return qu(t).then((function(e){return 0<e.length&&W(t.a,(function(t){t(e)})),{keyProcessed:Q(e,n.key)}}))})),Cu(this.v,"ping",(function(){return Ae(["keyChanged"])}))):function(){var t=s.navigator;return t&&t.serviceWorker?Ae().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Ae(null)}().then((function(e){(t.h=e)&&(t.g=new Nu(new ku(e)),Au(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Q(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Du(t){return new Ie((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ie((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Du(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Ou(t){return t.i||(t.i=Du(t)),t.i}function xu(t,e){var n=0;return new Ie((function r(i,o){Ou(t).then(e).then(i).o((function(e){if(!(3<++n))return Ou(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Lu(){try{return!!s.indexedDB}catch(t){return!1}}function Mu(t){return t.objectStore("firebaseLocalStorage")}function Fu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Uu(t){return new Ie((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function ju(t,e){return t.g&&t.h&&function(){var t=s.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Au(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Ae()}function qu(t){return Ou(t).then((function(t){var e=Mu(Fu(t,!1));return e.getAll?Uu(e.getAll()):new Ie((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=dr(t.c,n),t.c=n}return r}))}function Vu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Bu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ae().then((function(){if(Lu()){var t=Vr(),r="__sak"+t;return Eu||(Eu=new Ru),(n=Eu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){W(e.a,(function(e){e(t)}))})),t}))}function Ku(){this.a={},this.type="inMemory"}function Wu(){if(!function(){var t="Node"==Er();if(!(t=Hu()||t&&Lt.INTERNAL.node&&Lt.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new C("internal-error","The LocalStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Hu()||Lt.INTERNAL.node.localStorage,this.type="localStorage"}function Hu(){try{var t=s.localStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Gu(){this.type="nullStorage"}function zu(){if(!function(){var t="Node"==Er();if(!(t=Qu()||t&&Lt.INTERNAL.node&&Lt.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new C("internal-error","The SessionStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Qu()||Lt.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Qu(){try{var t=s.sessionStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Yu(){var t={};t.Browser=Ju,t.Node=Zu,t.ReactNative=tc,t.Worker=ec,this.a=t[Er()]}Tu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];W(r,(function(e){i.push(Ae().then((function(){return e(t.origin,t.data.data)})))})),De(i).then((function(r){var i=[];W(r,(function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})})),W(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},ku.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Nu.prototype.close=function(){for(;0<this.a.length;)Pu(this,this.a[0]);this.b=!0},(e=Ru.prototype).set=function(t,e){var n=this,r=!1;return xu(this,(function(e){return Uu((e=Mu(Fu(e,!0))).get(t))})).then((function(i){return xu(n,(function(o){if(o=Mu(Fu(o,!0)),i)return i.value=e,Uu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Uu(o.add(a))}))})).then((function(){return n.c[t]=e,ju(n,t)})).oa((function(){r&&n.b--}))},e.get=function(t){return xu(this,(function(e){return Uu(Mu(Fu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},e.U=function(t){var e=this,n=!1;return xu(this,(function(r){return n=!0,e.b++,Uu(Mu(Fu(r,!0)).delete(t))})).then((function(){return delete e.c[t],ju(e,t)})).oa((function(){n&&e.b--}))},e.ca=function(t){0==this.a.length&&function(t){function e(){t.f=setTimeout((function(){t.l=qu(t).then((function(e){0<e.length&&W(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}Vu(t),e()}(this),this.a.push(t)},e.ia=function(t){X(this.a,(function(e){return e==t})),0==this.a.length&&Vu(this)},(e=Bu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},e.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},e.U=function(t){return this.b.then((function(e){return e.U(t)}))},e.ca=function(t){this.a.push(t)},e.ia=function(t){X(this.a,(function(e){return e==t}))},(e=Ku.prototype).get=function(t){return Ae(this.a[t])},e.set=function(t,e){return this.a[t]=e,Ae()},e.U=function(t){return delete this.a[t],Ae()},e.ca=function(){},e.ia=function(){},(e=Wu.prototype).get=function(t){var e=this;return Ae().then((function(){return qr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Ae().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},e.U=function(t){var e=this;return Ae().then((function(){e.a.removeItem(t)}))},e.ca=function(t){s.window&&ln(s.window,"storage",t)},e.ia=function(t){s.window&&dn(s.window,"storage",t)},(e=Gu.prototype).get=function(){return Ae(null)},e.set=function(){return Ae()},e.U=function(){return Ae()},e.ca=function(){},e.ia=function(){},(e=zu.prototype).get=function(t){var e=this;return Ae().then((function(){return qr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Ae().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},e.U=function(t){var e=this;return Ae().then((function(){e.a.removeItem(t)}))},e.ca=function(){},e.ia=function(){};var Xu,$u,Ju={F:Wu,cb:zu},Zu={F:Wu,cb:zu},tc={F:Iu,cb:Gu},ec={F:Wu,cb:Gu},nc={rd:"local",NONE:"none",td:"session"};function rc(){var t=!(Br(Rr())||!Ir()),e=Fr(),n=Or();this.m=t,this.h=e,this.l=n,this.a={},Xu||(Xu=new Yu),t=Xu;try{this.g=!lr()&&zr()||!s.indexedDB?new t.a.F:new Bu(Tr()?new Ku:new t.a.F)}catch(t){this.g=new Ku,this.h=!0}try{this.i=new t.a.cb}catch(t){this.i=new Ku}this.v=new Ku,this.f=w(this.Zb,this),this.b={}}function ic(){return $u||($u=new rc),$u}function oc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function ac(t,e){return"firebase:"+t.name+(e?":"+e:"")}function sc(t,e,n){return n=ac(e,n),"local"==e.F&&(t.b[n]=null),oc(t,e.F).U(n)}function uc(t){t.c&&(clearInterval(t.c),t.c=null)}function cc(t){this.a=t,this.b=ic()}(e=rc.prototype).get=function(t,e){return oc(this,t.F).get(ac(t,e))},e.set=function(t,e,n){var r=ac(t,n),i=this,o=oc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},e.addListener=function(t,e,n){t=ac(t,e),this.l&&(this.b[t]=s.localStorage.getItem(t)),dt(this.a)&&(oc(this,"local").ca(this.f),this.h||(lr()||!zr())&&s.indexedDB||!this.l||function(t){uc(t),t.c=setInterval((function(){for(var e in t.a){var n=s.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Ze({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Zb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=ac(t,e),this.a[t]&&(X(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),dt(this.a)&&(oc(this,"local").ia(this.f),uc(this))},e.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?oc(this,"local").ia(this.f):uc(this),this.m)if(n=s.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?s.localStorage.setItem(e,r):s.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.nb(e))},Yt&&ue&&10==ue&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else W(t,w(this.nb,this))},e.nb=function(t){this.a[t]&&W(this.a[t],(function(t){t()}))};var hc,lc={name:"authEvent",F:"local"};function fc(){this.a=ic()}function pc(t,e){this.b=dc,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0===hc&&(hc=s.Int32Array?new Int32Array(wc):wc),this.reset()}E(pc,(function(){this.b=-1}));for(var dc=64,vc=dc-1,gc=[],yc=0;yc<vc;yc++)gc[yc]=0;var mc=$(128,gc);function bc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|hc[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function _c(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(bc(t),i=0);else{if(!p(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(bc(t),i=0)}}t.c=i,t.g+=n}pc.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):J(this.h)};var wc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ic(){pc.call(this,8,Tc)}E(Ic,pc);var Tc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Ec(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new fc,this.g=new cc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Sc(t){return new C("invalid-cordova-configuration",t)}function Cc(t){var e=new Ic;_c(e,t),t=[];var n=8*e.g;56>e.c?_c(e,mc,56-e.c):_c(e,mc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(bc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return G(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function kc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Nc(t){return t.f||(t.f=t.ma().then((function(){return new Ie((function(e){t.Ea((function n(r){return e(r),t.Ta(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Ac(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=so(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=qr(qn(o=Vn(i),"firebaseError")||null))?k(o):null)?new Ko(r.c,r.b,null,null,o,null,r.T()):new Ko(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}kc(t,i)}))}var n=new Ko("unknown",null,null,null,new C("no-auth-event")),r=!1,i=Nn(500).then((function(){return Ac(t).then((function(){r||kc(t,n)}))})),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Dr("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},zo||(zo=new Ho),function(t){var e=zo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Dr("universalLinks.subscribe",s))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Ac(t){var e=null;return function(t){return t.b.get(lc,t.a).then((function(t){return Wo(t)}))}(t.g).then((function(n){return e=n,sc((n=t.g).b,lc,n.a)})).then((function(){return e}))}function Pc(t){this.a=t,this.b=ic()}(e=Ec.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(wr(void 0)?_r().then((function(){return new Ie((function(t,e){var n=s.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Pe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Dr("universalLinks.subscribe",s))throw Sc("cordova-universal-links-plugin-fix is not installed");if(void 0===Dr("BuildInfo.packageName",s))throw Sc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Dr("cordova.plugins.browsertab.openUrl",s))throw Sc("cordova-plugin-browsertab is not installed");if("function"!=typeof Dr("cordova.InAppBrowser.open",s))throw Sc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new C("cordova-not-ready")}))},e.Pb=function(t,e){return e(new C("operation-not-supported-in-this-environment")),Ae()},e.Nb=function(){return Pe(new C("operation-not-supported-in-this-environment"))},e.ac=function(){return!1},e.Yb=function(){return!0},e.Ub=function(){return!0},e.Ob=function(t,e,n,r){if(this.c)return Pe(new C("redirect-operation-pending"));var i=this,o=s.document,a=null,u=null,c=null,h=null;return this.c=Ae().then((function(){return Bo(e),Nc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Ko(e,r,null,o,new C("no-auth-event"),null,i),u=Dr("BuildInfo.packageName",s);if("string"!=typeof u)throw new C("invalid-cordova-configuration");var c=Dr("BuildInfo.displayName",s),h={};if(Rr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!Rr().toLowerCase().match(/android/))return Pe(new C("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=Cc(o),h.sessionId=o;var l=wu(t.v,t.i,t.l,e,n,null,r,t.m,h,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(lc,a.w(),e)})).then((function(){var e=Dr("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new C("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Dr("cordova.plugins.browsertab.openUrl",s)))throw new C("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Dr("cordova.InAppBrowser.open",s)))throw new C("invalid-cordova-configuration");e=Rr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Ie((function(t,e){u=function(){var e=Dr("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),c=function(){a||(a=Nn(2e3).then((function(){e(new C("redirect-cancelled-by-user"))})))},h=function(){Hr()&&c()},o.addEventListener("resume",c,!1),Rr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).o((function(t){return Ac(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),u&&i.Ta(u),i.c=null}))},e.Ea=function(t){this.b.push(t),Nc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ko("unknown",null,null,null,new C("no-auth-event")),t(e))}))},e.Ta=function(t){X(this.b,(function(e){return e==t}))};var Rc={name:"pendingRedirect",F:"session"};function Dc(t){return sc(t.b,Rc,t.a)}function Oc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=w(this.s,this),this.b=new Qc,this.C=new Zc,this.g=new Pc(Gc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=xc(this.D,this.v,this.m,N,this.J)}function xc(t,e,n,r,i){var o=Lt.SDK_VERSION||null;return wr()?new Ec(t,e,n,o,r,i):new yu(t,e,n,o,r,i)}function Lc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Mc(t){t.a.Yb()&&Lc(t).o((function(e){var n=new Ko("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Bc(e)&&t.s(n)})),t.a.Ub()||Yc(t.b)}function Fc(t,e){Q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Rc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Dc(t.g).then((function(){Lc(t).o((function(e){var n=new Ko("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Bc(e)&&t.s(n)}))})):Mc(t)})).o((function(){Mc(t)}))}function Uc(t,e){X(t.h,(function(t){return t==e}))}Oc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=xc(this.D,this.v,this.m,null,this.J),this.i={}},Oc.prototype.s=function(t){if(!t)throw new C("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Yc(this.b),e};var jc=new Wr(2e3,1e4),qc=new Wr(3e4,6e4);function Vc(t,e,n,r,i,o,a){return t.a.Nb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Bc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Kc(t,e,n,r,i){var o;return function(t){return t.b.set(Rc,"pending",t.a)}(t.g).then((function(){return t.a.Ob(e,n,r,i).o((function(e){if(Bc(e))throw new C("operation-not-supported-in-this-environment");return o=e,Dc(t.g).then((function(){throw o}))})).then((function(){return t.a.ac()?new Ie((function(){})):Dc(t.g).then((function(){return t.ra()})).then((function(){})).o((function(){}))}))}))}function Wc(t,e,n,r,i){return t.a.Pb(r,(function(t){e.na(n,null,t,i)}),jc.get())}Oc.prototype.ra=function(){return this.b.ra()};var Hc={};function Gc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function zc(t,e,n,r){var i=Gc(e,n,r);return Hc[i]||(Hc[i]=new Oc(t,e,n,r)),Hc[i]}function Qc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Yc(t){t.g||(t.g=!0,Jc(t,!1,null,null))}function Xc(t){t.g&&!t.i&&Jc(t,!1,null,null)}function $c(t,e){if(t.b=function(){return Ae(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Jc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Pe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):$c(t,n):$c(t,{user:null}),t.f=[],t.c=[]}function Zc(){}function th(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function eh(t,e){this.a=e,Jr(this,"verificationId",t)}function nh(t,e,n,r){return new jo(t).gb(e,n).then((function(t){return new eh(t,r)}))}function rh(t){var e=zi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new C("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Zr(this,{token:t,expirationTime:Gr(1e3*e.exp),authTime:Gr(1e3*e.auth_time),issuedAtTime:Gr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function ih(t,e,n){var r=e&&e[ah];if(!r)throw new C("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=vt(e),this.g=n,this.c=new uo(null,r),this.b=[];var i=this;W(e[oh]||[],(function(t){(t=ri(t))&&i.b.push(t)})),Jr(this,"auth",this.a),Jr(this,"session",this.c),Jr(this,"hints",this.b)}Qc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Qc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Jc(this,!0,null,t.a),Ae()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Jc(t,s,e,null)})).o((function(e){Jc(t,s,null,e)}))}(this,t,e):Pe(new C("invalid-auth-event")):(Jc(this,!1,null,null),Ae())}else Pe(new C("invalid-auth-event"))},Qc.prototype.ra=function(){var t=this;return new Ie((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new C("timeout");t.a&&t.a.cancel(),t.a=Nn(qc.get()).then((function(){t.b||(t.g=!0,Jc(t,!0,null,e))}))}(t))}))},Zc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Ae()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):Pe(new C("invalid-auth-event"))}else Pe(new C("invalid-auth-event"))},eh.prototype.confirm=function(t){return t=qo(this.verificationId,t),this.a(t)};var oh="mfaInfo",ah="mfaPendingCredential";function sh(t,e,n,r){C.call(this,"multi-factor-auth-required",r,e),this.b=new ih(t,e,n),Jr(this,"resolver",this.b)}function uh(t,e,n){if(t&&v(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new sh(e,t.serverResponse,n,t.message)}catch(t){}return null}function ch(){}function hh(t){Jr(this,"factorId",t.fa),this.a=t}function lh(t){if(hh.call(this,t),this.a.fa!=jo.PROVIDER_ID)throw new C("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function fh(t,e){for(var n in Je.call(this,t),e)this[n]=e[n]}function ph(t,e){this.a=t,this.b=[],this.c=w(this.yc,this),ln(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&W(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ai]=t.uid),t.displayName&&(r[ii]=t.displayName),t.enrollmentTime&&(r[oi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[si]=t.phoneNumber);try{e=new ui(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),dh(this,n)}function dh(t,e){t.b=e,Jr(t,"enrolledFactors",e)}function vh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function gh(t,e){t.stop(),t.b=Nn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=s.document,e=null;return Hr()||!t?Ae():new Ie((function(n){e=function(){Hr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){gh(t,!0)})).o((function(e){t.i(e)&&gh(t,!1)}))}function yh(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function mh(t,e){void 0===e&&(t.b?e=(e=t.b).a-e.g:e=0),t.c=Date.now()+1e3*e}function bh(t,e){t.b=Gi(e[es]||""),t.a=e.refreshToken,mh(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function _h(t,e){return function(t,e){return new Ie((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?hs(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(uu(t)):t.access_token&&t.refresh_token?n(t):r(new C("internal-error")):r(new C("network-request-failed"))}),"POST",Zn(e).toString(),t.g,t.m.get()):r(new C("internal-error"))}))}(t.f,e).then((function(e){return t.b=Gi(e.access_token),t.a=e.refresh_token,mh(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function wh(t,e){this.a=t||null,this.b=e||null,Zr(this,{lastSignInTime:Gr(e||null),creationTime:Gr(t||null)})}function Ih(t,e,n,r,i,o){Zr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Th(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var r=Lt.SDK_VERSION?Pr(Lt.SDK_VERSION):null;this.a=new Za(this.l,D(N),r),(this.u=t.emulatorConfig||null)&&ss(this.a,this.u),this.h=new yh(this.a),Dh(this,e[es]),bh(this.h,e),Jr(this,"refreshToken",this.h.a),Lh(this,n||{}),Tn.call(this),this.P=!1,this.s&&xr()&&(this.b=zc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(t){return new vh((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.ba=w(this.ib,this);var i=this;this.za=null,this.Pa=function(t){i.xa(t.h)},this.qa=null,this.Ba=function(t){Eh(i,t.c)},this.$=null,this.aa=[],this.Oa=function(t){kh(i,t.f)},this.ja=null,this.S=new ph(this,n),Jr(this,"multiFactor",this.S)}function Eh(t,e){t.u=e,ss(t.a,e),t.b&&(e=t.b,t.b=zc(t.s,t.l,t.m,t.u),t.P&&(Uc(e,t),Fc(t.b,t)))}function Sh(t,e){t.qa&&dn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&ln(e,"languageCodeChanged",t.Pa)}function Ch(t,e){t.$&&dn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&ln(e,"emulatorConfigChanged",t.Ba)}function kh(t,e){t.aa=e,cs(t.a,Lt.SDK_VERSION?Pr(Lt.SDK_VERSION,t.aa):null)}function Nh(t,e){t.ja&&dn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&ln(e,"frameworkChanged",t.Oa)}function Ah(t){try{return Lt.app(t.m).auth()}catch(e){throw new C("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Ph(t){t.J||t.D.b||(t.D.start(),dn(t,"tokenChanged",t.ba),ln(t,"tokenChanged",t.ba))}function Rh(t){dn(t,"tokenChanged",t.ba),t.D.stop()}function Dh(t,e){t.Aa=e,Jr(t,"_lat",e)}function Oh(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return De(e).then((function(){return t}))}function xh(t){t.b&&!t.P&&(t.P=!0,Fc(t.b,t))}function Lh(t,e){Zr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new wh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Mh(){}function Fh(t){return Ae().then((function(){if(t.J)throw new C("app-deleted")}))}function Uh(t){return G(t.providerData,(function(t){return t.providerId}))}function jh(t,e){e&&(qh(t,e.providerId),t.providerData.push(e))}function qh(t,e){X(t.providerData,(function(t){return t.providerId==e}))}function Vh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Jr(t,e,n)}function Bh(t,e){t!=e&&(Zr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Jr(t,"metadata",function(t){return new wh(t.a,t.b)}(e.metadata)):Jr(t,"metadata",new wh),W(e.providerData,(function(e){jh(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Jr(t,"refreshToken",t.h.a),dh(t.S,e.S.b))}function Kh(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return au(t.a,Fs,{idToken:e}).then(w(t.Kc,t))}(t,e).then((function(){return n||Vh(t,"isAnonymous",!1),e}))}))}function Wh(t,e){e[es]&&t.Aa!=e[es]&&(bh(t.h,e),t.dispatchEvent(new fh("tokenChanged")),Dh(t,e[es]),Vh(t,"refreshToken",t.h.a))}function Hh(t,e){return Kh(t).then((function(){if(Q(Uh(t),e))return Oh(t).then((function(){throw new C("provider-already-linked")}))}))}function Gh(t,e,n){return ti({user:t,credential:Vo(e),additionalUserInfo:e=Ji(e),operationType:n})}function zh(t,e){return Wh(t,e),t.reload().then((function(){return t}))}function Qh(t,e,n,r,i){if(!xr())return Pe(new C("operation-not-supported-in-this-environment"));if(t.i&&!i)return Pe(t.i);var o=$i(n.providerId),a=Vr(t.uid+":::"),s=null;(!Fr()||Ir())&&t.s&&n.isOAuthProvider&&(s=wu(t.s,t.l,t.m,e,n,null,a,Lt.SDK_VERSION||null,null,null,t.tenantId,t.u));var u=yr(s,o&&o.va,o&&o.ua);return r=r().then((function(){if(Xh(t),!i)return t.I().then((function(){}))})).then((function(){return Vc(t.b,u,e,n,a,!!s,t.tenantId)})).then((function(){return new Ie((function(n,r){t.na(e,null,new C("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=a,t.c=Wc(t.b,t,e,u,a)}))})).then((function(t){return u&&gr(u),t?ti(t):null})).o((function(t){throw u&&gr(u),t})),$h(t,r,i)}function Yh(t,e,n,r,i){if(!xr())return Pe(new C("operation-not-supported-in-this-environment"));if(t.i&&!i)return Pe(t.i);var o=null,a=Vr(t.uid+":::");return r=r().then((function(){if(Xh(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,Oh(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(tl,t.w(),e.a)),e})).then((function(){return Kc(t.b,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return el(t.ha);throw o})).then((function(){if(o)throw o})),$h(t,r,i)}function Xh(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new C("internal-error");throw new C("auth-domain-config-required")}}function $h(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Pe(t.i)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new fh("userInvalidated")),t.i=e),e}))}(t,e,n);return t.N.push(r),r.oa((function(){Y(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=uh(e.w(),Ah(t),w(t.jc,t))),n||e}))}function Jh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[es]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new Th(e,n,t);return t.providerData&&W(t.providerData,(function(t){t&&jh(i,ti(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function Zh(t){this.a=t,this.b=ic()}ih.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then((function(t){var n=vt(e.f);return delete n[oh],delete n[ah],yt(n,t),e.g(n)}))},E(sh,C),ch.prototype.tb=function(t,e,n){return e.type==co?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),yt(n,{phoneVerificationInfo:Uo(t.a)}),au(e,Ls,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return yt(n={mfaPendingCredential:n},{phoneVerificationInfo:Uo(t.a)}),au(e,Ms,n)}))}(this,t,e)},E(hh,ch),E(lh,hh),E(fh,Je),(e=ph.prototype).yc=function(t){dh(this,function(t){var e=[];return W(t.mfaInfo||[],(function(t){(t=ri(t))&&e.push(t)})),e}(t.hd))},e.Sb=function(){return this.a.I().then((function(t){return new uo(t,null)}))},e.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then((function(n){return t.tb(r,n,e)})).then((function(t){return Wh(n.a,t),n.a.reload()}))},e.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return au(r,ou,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=H(e.b,(function(t){return t.uid!=n}));return dh(e,r),Wh(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},e.w=function(){return{multiFactor:{enrolledFactors:G(this.b,(function(t){return t.w()}))}}},vh.prototype.start=function(){this.a=this.c,gh(this,!0)},vh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},yh.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},yh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Pe(new C("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?_h(this,{grant_type:"refresh_token",refresh_token:this.a}):Ae(null):Ae({accessToken:this.b.toString(),refreshToken:this.a})},wh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},E(Th,Tn),Th.prototype.xa=function(t){this.za=t,as(this.a,t)},Th.prototype.la=function(){return this.za},Th.prototype.Ga=function(){return J(this.aa)},Th.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Jr(Th.prototype,"providerId","firebase"),(e=Th.prototype).reload=function(){var t=this;return $h(this,Fh(this).then((function(){return Kh(t).then((function(){return Oh(t)})).then(Mh)})))},e.oc=function(t){return this.I(t).then((function(t){return new rh(t)}))},e.I=function(t){var e=this;return $h(this,Fh(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new C("internal-error");return t.accessToken!=e.Aa&&(Dh(e,t.accessToken),e.dispatchEvent(new fh("tokenChanged"))),Vh(e,"refreshToken",t.refreshToken),t.accessToken})))},e.Kc=function(t){if(!(t=t.users)||!t.length)throw new C("internal-error");Lh(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?G(t,(function(t){return new Ih(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)jh(this,e[n]);Vh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new fh("userReloaded",{hd:t}))},e.Lc=function(t){return Xr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},e.ub=function(t){var e=this,n=null;return $h(this,t.c(this.a,this.uid).then((function(t){return Wh(e,t),n=Gh(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},e.Cc=function(t){return Xr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},e.rb=function(t){var e=this,n=null;return $h(this,Hh(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Gh(e,t,"link"),zh(e,t)})).then((function(){return n})))},e.Dc=function(t,e){var n=this;return $h(this,Hh(this,"phone").then((function(){return nh(Ah(n),t,e,w(n.rb,n))})))},e.Mc=function(t,e){var n=this;return $h(this,Ae().then((function(){return nh(Ah(n),t,e,w(n.ub,n))})),!0)},e.Cb=function(t){var e=this;return $h(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return Wh(e,t),e.reload()})))},e.ed=function(t){var e=this;return $h(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Wh(e,t),e.reload()})))},e.Db=function(t){var e=this;return $h(this,this.I().then((function(n){return e.a.Db(n,t)})).then((function(t){return Wh(e,t),e.reload()})))},e.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Fh(this);var e=this;return $h(this,this.I().then((function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Wh(e,t),Vh(e,"displayName",t.displayName||null),Vh(e,"photoURL",t.photoUrl||null),W(e.providerData,(function(t){"password"===t.providerId&&(Jr(t,"displayName",e.displayName),Jr(t,"photoURL",e.photoURL))})),Oh(e)})).then(Mh))},e.cd=function(t){var e=this;return $h(this,Kh(this).then((function(n){return Q(Uh(e),t)?function(t,e,n){return au(t,Ds,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return W(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),W(Uh(e),(function(t){n[t]||qh(e,t)})),n[jo.PROVIDER_ID]||Jr(e,"phoneNumber",null),Oh(e)})):Oh(e).then((function(){throw new C("no-such-provider")}))})))},e.delete=function(){var t=this;return $h(this,this.I().then((function(e){return au(t.a,Rs,{idToken:e})})).then((function(){t.dispatchEvent(new fh("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");Sh(t,null),Ch(t,null),Nh(t,null),t.N=[],t.J=!0,Rh(t),Jr(t,"refreshToken",null),t.b&&Uc(t.b,t)}))},e.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},e.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?w(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?w(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?w(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?w(this.Mb,this):null},e.Ec=function(t){var e=this;return Qh(this,"linkViaPopup",t,(function(){return Hh(e,t.providerId).then((function(){return Oh(e)}))}),!1)},e.Nc=function(t){return Qh(this,"reauthViaPopup",t,(function(){return Ae()}),!0)},e.Fc=function(t){var e=this;return Yh(this,"linkViaRedirect",t,(function(){return Hh(e,t.providerId)}),!1)},e.Oc=function(t){return Yh(this,"reauthViaRedirect",t,(function(){return Ae()}),!0)},e.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return $h(this,this.I().then((function(n){return Es(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Gh(i,t,"link"),zh(i,t)})).then((function(){return o})))},e.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return $h(this,Ae().then((function(){return fo(Ss(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Gh(i,t,"reauthenticate"),Wh(i,t),i.i=null,i.reload()})).then((function(){return o})),!0)},e.vb=function(t){var e=this,n=null;return $h(this,this.I().then((function(e){return n=e,void 0===t||dt(t)?{}:Bi(new Di(t))})).then((function(t){return e.a.vb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},e.Fb=function(t,e){var n=this,r=null;return $h(this,this.I().then((function(t){return r=t,void 0===e||dt(e)?{}:Bi(new Di(e))})).then((function(e){return n.a.Fb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},e.jc=function(t){var e=null,n=this;return $h(this,t=fo(Ae(t),n.uid).then((function(t){return e=Gh(n,t,"reauthenticate"),Wh(n,t),n.i=null,n.reload()})).then((function(){return e})),!0)},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&yt(t,this.metadata.w()),W(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),yt(t,this.S.w()),t};var tl={name:"redirectUser",F:"session"};function el(t){return sc(t.b,tl,t.a)}function nl(t){this.a=t,this.b=ic(),this.c=null,this.f=function(t){var e=ol("local"),n=ol("session"),r=ol("none");return function(t,e,n){var r=ac(e,n),i=oc(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=qr(s.localStorage.getItem(r))}catch(t){}if(a&&!o)return s.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&s.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(il,t.a).then((function(t){return t?ol(t):e}))}))}))})).then((function(e){return t.c=e,rl(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(ol("local"),this.a,w(this.g,this))}function rl(t,e){var n,r=[];for(n in nc)nc[n]!==e&&r.push(sc(t.b,ol(nc[n]),t.a));return r.push(sc(t.b,il,t.a)),function(t){return new Ie((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Re(t[s],I(o,s),a);else e(i)}))}(r)}nl.prototype.g=function(){var t=this,e=ol("local");cl(this,(function(){return Ae().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return rl(t,"local").then((function(){t.c=e}))}))}))};var il={name:"persistence",F:"session"};function ol(t){return{name:"authUser",F:t}}function al(t,e){return cl(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function sl(t){return cl(t,(function(){return sc(t.b,t.c,t.a)}))}function ul(t,e,n){return cl(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Jh(t||{})}))}))}function cl(t,e){return t.f=t.f.then(e,e),t.f}function hl(t){if(this.l=!1,Jr(this,"settings",new th),Jr(this,"app",t),!bl(this).options||!bl(this).options.apiKey)throw new C("invalid-api-key");t=Lt.SDK_VERSION?Pr(Lt.SDK_VERSION):null,this.a=new Za(bl(this).options&&bl(this).options.apiKey,D(N),t),this.P=[],this.s=[],this.N=[],this.Pa=Lt.INTERNAL.createSubscribe(w(this.zc,this)),this.W=void 0,this.ib=Lt.INTERNAL.createSubscribe(w(this.Ac,this)),yl(this,null),this.i=new nl(bl(this).options.apiKey+":"+bl(this).name),this.D=new Zh(bl(this).options.apiKey+":"+bl(this).name),this.$=Tl(this,function(t){var e=bl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(tl,t.a).then((function(t){return t&&e&&(t.authDomain=e),Jh(t||{})}))}(t.D,bl(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),el(t.D)}));return Tl(t,e)}(t).then((function(){return ul(t.i,e,t.R)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return al(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:sl(t.i)}))):null})).then((function(e){yl(t,e||null)}));return Tl(t,n)}(this)),this.h=Tl(this,function(t){return t.$.then((function(){return vl(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(ol("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=w(this.Zc,this),this.Ba=w(this.da,this),this.qa=w(this.mc,this),this.za=w(this.wc,this),this.Aa=w(this.xc,this),this.b=null,function(t){var e=bl(t).options.authDomain,n=bl(t).options.apiKey;e&&xr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=zc(e,n,bl(t).name,t.R),Fc(t.b,t),_l(t)&&xh(_l(t)),t.m){xh(t.m);var r=t.m;r.xa(t.la()),Sh(r,t),kh(r=t.m,t.J),Nh(r,t),Eh(r=t.m,t.R),Ch(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=w(this.delete,this),this.INTERNAL.logFramework=w(this.Gc,this),this.u=0,Tn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.R){var t=Vn(this.R.url);t=ti({protocol:t.c,host:t.a,port:t.g,options:ti({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.R=null}function ll(t){Je.call(this,"languageCodeChanged"),this.h=t}function fl(t){Je.call(this,"emulatorConfigChanged"),this.c=t}function pl(t){Je.call(this,"frameworkChanged"),this.f=t}function dl(t){return t.Oa||Pe(new C("auth-domain-config-required"))}function vl(t){if(!xr())return Pe(new C("operation-not-supported-in-this-environment"));var e=dl(t).then((function(){return t.b.ra()})).then((function(t){return t?ti(t):null}));return Tl(t,e)}function gl(t,e){var n={};return n.apiKey=bl(t).options.apiKey,n.authDomain=bl(t).options.authDomain,n.appName=bl(t).name,t.R&&(n.emulatorConfig=t.R),t.$.then((function(){return function(t,e,n,r){var i=new Th(t,e);return n&&(i.ha=n),r&&kh(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return _l(t)&&e.uid==_l(t).uid?(Bh(_l(t),e),t.da(e)):(yl(t,e),xh(e),t.da(e))})).then((function(){Il(t)}))}function yl(t,e){_l(t)&&(function(t,e){X(t.W,(function(t){return t==e}))}(_l(t),t.Ba),dn(_l(t),"tokenChanged",t.qa),dn(_l(t),"userDeleted",t.za),dn(_l(t),"userInvalidated",t.Aa),Rh(_l(t))),e&&(e.W.push(t.Ba),ln(e,"tokenChanged",t.qa),ln(e,"userDeleted",t.za),ln(e,"userInvalidated",t.Aa),0<t.u&&Ph(e)),Jr(t,"currentUser",e),e&&(e.xa(t.la()),Sh(e,t),kh(e,t.J),Nh(e,t),Eh(e,t.R),Ch(e,t))}function ml(t,e){var n=null,r=null;return Tl(t,e.then((function(e){return n=Vo(e),r=Ji(e),gl(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=uh(e.w(),t,w(t.kc,t))),n||e})).then((function(){return ti({user:_l(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function bl(t){return t.app}function _l(t){return t.currentUser}function wl(t){return _l(t)&&_l(t)._lat||null}function Il(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](wl(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](wl(t))}}function Tl(t,e){return t.P.push(e),e.oa((function(){Y(t.P,e)})),e}function El(){}function Sl(){this.a={},this.b=1e12}nl.prototype.yb=function(t){var e=null,n=this;return function(t){var e=new C("invalid-persistence-type"),n=new C("unsupported-persistence-type");t:{for(r in nc)if(nc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Er()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Lu()&&"none"!==t)throw n;break;default:if(!Or()&&"none"!==t)throw n}}(t),cl(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,rl(n,t)})).then((function(){if(n.c=ol(t),e)return n.b.set(n.c,e,n.a)})):Ae()}))},E(hl,Tn),E(ll,Je),E(fl,Je),E(pl,Je),(e=hl.prototype).yb=function(t){return Tl(this,t=this.i.yb(t))},e.xa=function(t){this.aa===t||this.l||(this.aa=t,as(this.a,this.aa),this.dispatchEvent(new ll(this.la())))},e.la=function(){return this.aa},e.fd=function(){var t=s.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new C("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),s.document&&!t&&_r().then((function(){var t=s.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),s.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.R={url:t,ec:e},this.settings.jb=!0,ss(this.a,this.R),this.dispatchEvent(new fl(this.R))}},e.Gc=function(t){this.J.push(t),cs(this.a,Lt.SDK_VERSION?Pr(Lt.SDK_VERSION,this.J):null),this.dispatchEvent(new pl(this.J))},e.Ga=function(){return J(this.J)},e.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},e.T=function(){return this.S},e.toJSON=function(){return{apiKey:bl(this).options.apiKey,authDomain:bl(this).options.authDomain,appName:bl(this).name,currentUser:_l(this)&&_l(this).w()}},e.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},e.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?w(this.ic,this):null},e.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return ml(i,Ts(i.a,o))}))},e.Xc=function(t){if(!xr())return Pe(new C("operation-not-supported-in-this-environment"));var e=this,n=$i(t.providerId),r=Vr(),i=null;(!Fr()||Ir())&&bl(this).options.authDomain&&t.isOAuthProvider&&(i=wu(bl(this).options.authDomain,bl(this).options.apiKey,bl(this).name,"signInViaPopup",t,null,r,Lt.SDK_VERSION||null,null,null,this.T(),this.R));var o=yr(i,n&&n.va,n&&n.ua);return Tl(this,n=dl(this).then((function(n){return Vc(n,o,"signInViaPopup",t,r,!!i,e.T())})).then((function(){return new Ie((function(t,n){e.na("signInViaPopup",null,new C("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=r,e.c=Wc(e.b,e,"signInViaPopup",o,r)}))})).then((function(t){return o&&gr(o),t?ti(t):null})).o((function(t){throw o&&gr(o),t})))},e.Yc=function(t){if(!xr())return Pe(new C("operation-not-supported-in-this-environment"));var e=this;return Tl(this,dl(this).then((function(){return function(t){return cl(t,(function(){return t.b.set(il,t.c.F,t.a)}))}(e.i)})).then((function(){return Kc(e.b,"signInViaRedirect",t,void 0,e.T())})))},e.ra=function(){var t=this;return vl(this).then((function(e){return t.b&&Xc(t.b.b),e})).o((function(e){throw t.b&&Xc(t.b.b),e}))},e.dd=function(t){if(!t)return Pe(new C("null-user"));if(this.S!=t.tenantId)return Pe(new C("tenant-id-mismatch"));var e=this,n={};n.apiKey=bl(this).options.apiKey,n.authDomain=bl(this).options.authDomain,n.appName=bl(this).name;var r=function(t,e,n,r){var i=t.h,o={};return o[es]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new Th(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&kh(e,r),Bh(e,t),e}(t,n,e.D,e.Ga());return Tl(this,this.h.then((function(){if(bl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return _l(e)&&t.uid==_l(e).uid?(Bh(_l(e),t),e.da(t)):(yl(e,r),xh(r),e.da(r))})).then((function(){Il(e)})))},e.Bb=function(){var t=this;return Tl(this,this.h.then((function(){return t.b&&Xc(t.b.b),_l(t)?(yl(t,null),sl(t.i).then((function(){Il(t)}))):Ae()})))},e.Zc=function(){var t=this;return ul(this.i,bl(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=_l(t)&&e){n=_l(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Bh(_l(t),e),_l(t).I();(_l(t)||e)&&(yl(t,e),e&&(xh(e),e.ha=t.D),t.b&&Fc(t.b,t),Il(t))}}))},e.da=function(t){return al(this.i,t)},e.mc=function(){Il(this),this.da(_l(this))},e.wc=function(){this.Bb()},e.xc=function(){this.Bb()},e.kc=function(t){var e=this;return this.h.then((function(){return ml(e,Ae(t))}))},e.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(_l(e))}))},e.Ac=function(t){var e=this;!function(t,e){t.N.push(e),Tl(t,t.h.then((function(){!t.l&&Q(t.N,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(wl(t)))})))}(this,(function(){t.next(_l(e))}))},e.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(_l(r)):"function"==typeof t.next&&t.next(_l(r))})),this.Pa(t,e,n)},e.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"==typeof t?t(_l(r)):"function"==typeof t.next&&t.next(_l(r))})),this.ib(t,e,n)},e.nc=function(t){var e=this;return Tl(this,this.h.then((function(){return _l(e)?_l(e).I(t).then((function(t){return{accessToken:t}})):null})))},e.Tc=function(t){var e=this;return this.h.then((function(){return ml(e,au(e.a,tu,{token:t}))})).then((function(t){var n=t.user;return Vh(n,"isAnonymous",!1),e.da(n),t}))},e.Uc=function(t,e){var n=this;return this.h.then((function(){return ml(n,au(n.a,eu,{email:t,password:e}))}))},e.dc=function(t,e){var n=this;return this.h.then((function(){return ml(n,au(n.a,As,{email:t,password:e}))}))},e.ab=function(t){var e=this;return this.h.then((function(){return ml(e,t.ka(e.a))}))},e.Sc=function(t){return Xr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},e.Ab=function(){var t=this;return this.h.then((function(){var e=_l(t);if(e&&e.isAnonymous){var n=ti({providerId:null,isNewUser:!1});return ti({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ml(t,t.a.Ab()).then((function(e){var n=e.user;return Vh(n,"isAnonymous",!0),t.da(n),e}))}))},e.getUid=function(){return _l(this)&&_l(this).uid||null},e.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&_l(this)&&Ph(_l(this))},e.Pc=function(t){var e=this;W(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&_l(this)&&Rh(_l(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.s.push(t),Tl(this,this.h.then((function(){e.l||Q(e.s,t)&&t(wl(e))})))},e.removeAuthTokenListener=function(t){X(this.s,(function(e){return e==t}))},e.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(ol("local"),t.a,this.ja),this.b&&(Uc(this.b,this),Xc(this.b.b)),Promise.resolve()},e.hc=function(t){return Tl(this,function(t,e){return au(t,Ps,{identifier:e,continueUri:Lr()?fr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},e.Bc=function(t){return!!Lo(t)},e.xb=function(t,e){var n=this;return Tl(this,Ae().then((function(){var t=new Di(e);if(!t.c)throw new C("argument-error",Li+" must be true when sending sign in link to email");return Bi(t)})).then((function(e){return n.a.xb(t,e)})).then((function(){})))},e.jd=function(t){return this.Sa(t).then((function(t){return t.data.email}))},e.ob=function(t,e){return Tl(this,this.a.ob(t,e).then((function(){})))},e.Sa=function(t){return Tl(this,this.a.Sa(t).then((function(t){return new ci(t)})))},e.kb=function(t){return Tl(this,this.a.kb(t).then((function(){})))},e.wb=function(t,e){var n=this;return Tl(this,Ae().then((function(){return void 0===e||dt(e)?{}:Bi(new Di(e))})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},e.Wc=function(t,e){return Tl(this,nh(this,t,e,w(this.ab,this)))},e.Vc=function(t,e){var n=this;return Tl(this,Ae().then((function(){var r=e||fr(),i=xo(t,r);if(!(r=Lo(r)))throw new C("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new C("tenant-id-mismatch");return n.ab(i)})))},El.prototype.render=function(){},El.prototype.reset=function(){},El.prototype.getResponse=function(){},El.prototype.execute=function(){};var Cl=null;function kl(t,e){return(e=Nl(e))&&t.a[e]||null}function Nl(t){return(t=void 0===t?1e12:t)?t.toString():null}function Al(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=he(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():ln(this.f,"click",this.i)}function Pl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Rl(){}function Dl(){}Sl.prototype.render=function(t,e){return this.a[this.b.toString()]=new Al(t,e),this.b++},Sl.prototype.reset=function(t){var e=kl(this,t);t=Nl(t),e&&t&&(e.delete(),delete this.a[t])},Sl.prototype.getResponse=function(t){return(t=kl(this,t))?t.getResponse():null},Sl.prototype.execute=function(t){(t=kl(this,t))&&t.execute()},Al.prototype.getResponse=function(){return Pl(this),this.b},Al.prototype.execute=function(){Pl(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},Al.prototype.delete=function(){Pl(this),this.g=!0,clearTimeout(this.a),this.a=null,dn(this.f,"click",this.i)},Jr(Rl,"FACTOR_ID","phone"),Dl.prototype.g=function(){return Cl||(Cl=new Sl),Ae(Cl)},Dl.prototype.c=function(){};var Ol=null;function xl(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Ll=new bt(Tt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Ml=new Wr(3e4,6e4);xl.prototype.g=function(t){var e=this;return new Ie((function(n,r){var i=setTimeout((function(){r(new C("network-request-failed"))}),Ml.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new C("internal-error"));delete s[e.a]},Ae(Ga(kt(Ll,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new C("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(s.grecaptcha))}))},xl.prototype.c=function(){this.b--};var Fl=null;function Ul(t,e,n,r,i,o,a){if(Jr(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,a?(Ol||(Ol=new Dl),a=Ol):(Fl||(Fl=new xl),a=Fl),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Vl])throw new C("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Bl],!s.document)throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!he(e)||!this.i&&he(e).hasChildNodes())throw new C("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Za(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[jl];this.a[jl]=function(t){if(Kl(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Dr(c,s);"function"==typeof e&&e(t)}};var h=this.a[ql];this.a[ql]=function(){if(Kl(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=Dr(h,s);"function"==typeof t&&t()}}}var jl="callback",ql="expired-callback",Vl="sitekey",Bl="size";function Kl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Wl(t,e){return t.h.push(e),e.oa((function(){Y(t.h,e)})),e}function Hl(t){if(t.J)throw new C("internal-error","RecaptchaVerifier instance has been destroyed.")}function Gl(t,e,n){var r=!1;try{this.b=n||Lt.app()}catch(t){throw new C("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new C("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=Lt.SDK_VERSION?Pr(Lt.SDK_VERSION,o):null,Ul.call(this,n,t,e,(function(){try{var t=i.b.auth().la()}catch(e){t=null}return t}),o,D(N),r)}function zl(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new C("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Ql.length)throw new C("internal-error","Argument validator received an unsupported number of arguments.");n=Ql[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new C("argument-error",t+" failed: "+r)}(e=Ul.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Wl(this,Ae().then((function(){if(Lr()&&!Tr())return _r();throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,au(t.s,Ks,{})})).then((function(e){t.a[Vl]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},e.render=function(){Hl(this);var t=this;return Wl(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=he(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ce&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Ht(a.name),'"'),a.type){o.push(' type="',Ht(a.type),'"');var s={};yt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ge(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):le(o,a)),2<r.length&&ve(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},e.verify=function(){Hl(this);var t=this;return Wl(this,this.render().then((function(e){return new Ie((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){X(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},e.reset=function(){Hl(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Hl(this),this.J=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=he(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},E(Gl,Ul);var Ql="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Yl(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Xl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function $l(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:v}}function Jl(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Zl(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function tf(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function ef(t,e){return v(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function nf(t){return v(t)&&"string"==typeof t.uid}function rf(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function of(t,e){for(var n in e){var r=e[n].name;t[r]=uf(r,t[n],e[n].j)}}function af(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I((function(t){return this[t]}),n),set:I((function(t,e,n,r){zl(t,[n],[r],!0),this[e]=r}),r,n,e[n].lb),enumerable:!0})}}function sf(t,e,n,r){t[e]=uf(e,n,r)}function uf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return zl(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}of(hl.prototype,{kb:{name:"applyActionCode",j:[Yl("code")]},Sa:{name:"checkActionCode",j:[Yl("code")]},ob:{name:"confirmPasswordReset",j:[Yl("code"),Yl("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Yl("email"),Yl("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Yl("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Yl("emailLink")]},Hc:{name:"onAuthStateChanged",j:[rf($l(),Jl(),"nextOrObserver"),Jl("opt_error",!0),Jl("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[rf($l(),Jl(),"nextOrObserver"),Jl("opt_error",!0),Jl("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Yl("email"),rf($l("opt_actionCodeSettings",!0),Zl(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Yl("email"),$l("actionCodeSettings")]},yb:{name:"setPersistence",j:[Yl("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[tf()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[tf()]},Tc:{name:"signInWithCustomToken",j:[Yl("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Yl("email"),Yl("password")]},Vc:{name:"signInWithEmailLink",j:[Yl("email"),Yl("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Yl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[rf({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof Th)}},Zl(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Yl(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Yl("url"),$l("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Yl("code")]}}),af(hl.prototype,{lc:{name:"languageCode",lb:rf(Yl(),Zl(),"languageCode")},ti:{name:"tenantId",lb:rf(Yl(),Zl(),"tenantId")}}),hl.Persistence=nc,hl.Persistence.LOCAL="local",hl.Persistence.SESSION="session",hl.Persistence.NONE="none",of(Th.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Xl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Xl("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[tf()]},rb:{name:"linkWithCredential",j:[tf()]},Dc:{name:"linkWithPhoneNumber",j:[Yl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[tf()]},ub:{name:"reauthenticateWithCredential",j:[tf()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Yl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[rf($l("opt_actionCodeSettings",!0),Zl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Yl(null,!0)]},cd:{name:"unlink",j:[Yl("provider")]},Cb:{name:"updateEmail",j:[Yl("email")]},Db:{name:"updatePassword",j:[Yl("password")]},ed:{name:"updatePhoneNumber",j:[tf("phone")]},Eb:{name:"updateProfile",j:[$l("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Yl("email"),rf($l("opt_actionCodeSettings",!0),Zl(null,!0),"opt_actionCodeSettings",!0)]}}),of(Sl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),of(El.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),of(Ie.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),af(th.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Xl("appVerificationDisabledForTesting")}}),of(eh.prototype,{confirm:{name:"confirm",j:[Yl("verificationCode")]}}),sf(lo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[bo,Do,Fo,go],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[rf(Yl(),$l(),"json")]),sf(Oo,"credential",(function(t,e){return new Ro(t,e)}),[Yl("email"),Yl("password")]),of(Ro.prototype,{w:{name:"toJSON",j:[Yl(null,!0)]}}),of(To.prototype,{Ca:{name:"addScope",j:[Yl("scope")]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),sf(To,"credential",Eo,[rf(Yl(),$l(),"token")]),sf(Oo,"credentialWithLink",xo,[Yl("email"),Yl("emailLink")]),of(So.prototype,{Ca:{name:"addScope",j:[Yl("scope")]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),sf(So,"credential",Co,[rf(Yl(),$l(),"token")]),of(ko.prototype,{Ca:{name:"addScope",j:[Yl("scope")]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),sf(ko,"credential",No,[rf(Yl(),rf($l(),Zl()),"idToken"),rf(Yl(),Zl(),"accessToken",!0)]),of(Ao.prototype,{Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),sf(Ao,"credential",Po,[rf(Yl(),$l(),"token"),Yl("secret",!0)]),of(Io.prototype,{Ca:{name:"addScope",j:[Yl("scope")]},credential:{name:"credential",j:[rf(Yl(),rf($l(),Zl()),"optionsOrIdToken"),rf(Yl(),Zl(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),of(yo.prototype,{w:{name:"toJSON",j:[Yl(null,!0)]}}),of(po.prototype,{w:{name:"toJSON",j:[Yl(null,!0)]}}),sf(jo,"credential",qo,[Yl("verificationId"),Yl("verificationCode")]),of(jo.prototype,{gb:{name:"verifyPhoneNumber",j:[rf(Yl(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?ef(t.session,co)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?ef(t.session,ho)&&nf(t.multiFactorHint):t.session&&t.multiFactorUid?ef(t.session,ho)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),of(Mo.prototype,{w:{name:"toJSON",j:[Yl(null,!0)]}}),of(C.prototype,{toJSON:{name:"toJSON",j:[Yl(null,!0)]}}),of(Yo.prototype,{toJSON:{name:"toJSON",j:[Yl(null,!0)]}}),of(Qo.prototype,{toJSON:{name:"toJSON",j:[Yl(null,!0)]}}),of(sh.prototype,{toJSON:{name:"toJSON",j:[Yl(null,!0)]}}),of(ih.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}]}}),of(ph.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}},Yl("displayName",!0)]},bd:{name:"unenroll",j:[rf({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:nf},Yl(),"multiFactorInfoIdentifier")]}}),of(Gl.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),sf(Ti,"parseLink",Ri,[Yl("link")]),sf(Rl,"assertion",(function(t){return new lh(t)}),[tf("phone")]),function(){if(void 0===Lt||!Lt.INTERNAL||!Lt.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:li,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:hi,VERIFY_AND_CHANGE_EMAIL:fi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:hl,AuthCredential:lo,Error:C};sf(t,"EmailAuthProvider",Oo,[]),sf(t,"FacebookAuthProvider",To,[]),sf(t,"GithubAuthProvider",So,[]),sf(t,"GoogleAuthProvider",ko,[]),sf(t,"TwitterAuthProvider",Ao,[]),sf(t,"OAuthProvider",Io,[Yl("providerId")]),sf(t,"SAMLAuthProvider",wo,[Yl("providerId")]),sf(t,"PhoneAuthProvider",jo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof hl)}}]),sf(t,"RecaptchaVerifier",Gl,[rf(Yl(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),$l("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof Lt.app.App)}}]),sf(t,"ActionCodeURL",Ti,[]),sf(t,"PhoneMultiFactorGenerator",Rl,[]),Lt.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new hl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),Lt.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:w((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:w(t.nc,t),addAuthTokenListener:w(t.cc,t),removeAuthTokenListener:w(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),Lt.registerVersion("@firebase/auth","0.16.8"),Lt.INTERNAL.extendNamespace({User:Th})}()}.apply(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Mt=r(),Ft="";function Ut(t){Ft=t}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var jt,qt=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),q(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:j(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),Vt=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return B(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),Bt=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new qt(e)}}catch(t){}return new Vt},Kt=Bt("localStorage"),Wt=Bt("sessionStorage"),Ht=new yt("@firebase/database"),Gt=(jt=1,function(){return jt++}),zt=function(t){var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,y(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),n=new G;n.update(e);var r=n.digest();return _.encodeByteArray(r)},Qt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=Qt.apply(null,i):n+="object"==typeof i?q(i):i,n+=" "}return n},Yt=null,Xt=!0,$t=function(t,e){y(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Ht.logLevel=ct.VERBOSE,Yt=Ht.log.bind(Ht),e&&Wt.set("logging_enabled",!0)):"function"==typeof t?Yt=t:(Yt=null,Wt.remove("logging_enabled"))},Jt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===Xt&&(Xt=!1,null===Yt&&!0===Wt.get("logging_enabled")&&$t(!0)),Yt){var n=Qt.apply(null,t);Yt(n)}},Zt=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Jt.apply(void 0,p([t],f(e)))}},te=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+Qt.apply(void 0,p([],f(t)));Ht.error(n)},ee=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+Qt.apply(void 0,p([],f(t)));throw Ht.error(n),new Error(n)},ne=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+Qt.apply(void 0,p([],f(t)));Ht.warn(n)},re=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},ie="[MIN_NAME]",oe="[MAX_NAME]",ae=function(t,e){if(t===e)return 0;if(t===ie||e===oe)return-1;if(e===ie||t===oe)return 1;var n=ge(t),r=ge(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},se=function(t,e){return t===e?0:t<e?-1:1},ue=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+q(e))},ce=function(t){if("object"!=typeof t||null===t)return q(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=q(e[i]),r+=":",r+=ce(t[e[i]]);return r+="}"},he=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function le(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var fe=function(t){y(!re(t),"Invalid JSON number");var e,n,r,i,o,a=1023;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),a))+a,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var u=s.join(""),c="";for(o=0;o<64;o+=8){var h=parseInt(u.substr(o,8),2).toString(16);1===h.length&&(h="0"+h),c+=h}return c.toLowerCase()};var pe=new RegExp("^-?(0*)\\d{1,10}$"),de=-2147483648,ve=2147483647,ge=function(t){if(pe.test(t)){var e=Number(t);if(e>=de&&e<=ve)return e}return null},ye=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw ne("Exception was thrown by user callback.",e),t}),Math.floor(0))}},me=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},be=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){ne('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),_e=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(Jt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ne(t)},t}(),we=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),Ie="5",Te=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ee="websocket",Se="long_polling",Ce=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Kt.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Kt.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function ke(t,e,n){var r;if(y("string"==typeof e,"typeof type must == string"),y("object"==typeof n,"typeof params must == object"),e===Ee)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==Se)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return le(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Ne=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),B(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return I(this.counters_)},t}(),Ae={},Pe={};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Re(t){var e=t.toString();return Ae[e]||(Ae[e]=new Ne),Ae[e]}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var De=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&ye((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},t}(),Oe="start",xe="close",Le=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zt(t),this.stats_=Re(e),this.urlFn=function(t){return s.appCheckToken&&(t.ac=s.appCheckToken),ke(e,Se,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new De(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if(R()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Me((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=f(t,5),i=r[0],o=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===Oe)n.id=o,n.password=a;else{if(i!==xe)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=f(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v=Ie,n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&Te.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!R()&&(!!t.forceAllow_||!(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=q(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n,r=(n=b(e),_.encodeByteArray(n,!0)),i=he(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!R()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=q(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Me=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,R())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=Gt(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))o='<script>document.domain="'+document.domain+'";<\/script>';var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(t){Jt("frame writing exception"),t.stack&&Jt(t.stack),Jt(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||Jt("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;R()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){Jt("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),Fe=null;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */"undefined"!=typeof MozWebSocket?Fe=MozWebSocket:"undefined"!=typeof WebSocket&&(Fe=WebSocket);var Ue=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zt(this.connId),this.stats_=Re(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={};return i.v=Ie,!R()&&"undefined"!=typeof location&&location.hostname&&Te.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i.ac=r),ke(t,Ee,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Kt.set("previous_websocket_failure",!0);try{if(R()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+Ft+"/"+Mt.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization=this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var o=Mt.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new Fe(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Fe(this.connURL,[],i)}}catch(t){this.log_("Error instantiating WebSocket.");var s=t.message||t.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Fe&&!t.forceDisallow_},t.previouslyFailed=function(){return Kt.isInMemoryStorage||!0===Kt.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){Kt.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=j(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(y(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=q(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=he(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),je=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Le,Ue]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=Ue&&Ue.isAvailable(),o=i&&!Ue.previouslyFailed();if(e.webSocketOnly&&(i||ne("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[Ue];else{var a=this.transports_=[];try{for(var s=l(t.ALL_TRANSPORTS),u=s.next();!u.done;u=s.next()){var c=u.value;c&&c.isAvailable()&&a.push(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),qe=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zt("c:"+this.id+":"),this.transportManager_=new je(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=me((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=ue("t",t),n=ue("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=ue("t",t),n=ue("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=ue("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?te("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):te("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),Ie!==n&&ne("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),me((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):me((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Kt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Ve=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),Be=function(){function t(t){this.allowedEvents_=t,this.listeners_={},y(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=p([],f(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){y(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Ke=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||k()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return y("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(Be),We=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function He(){return new We("")}function Ge(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ze(t){return t.pieces_.length-t.pieceNum_}function Qe(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new We(t.pieces_,e)}function Ye(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Xe(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function $e(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new We(e,0)}function Je(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof We)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new We(n,0)}function Ze(t){return t.pieceNum_>=t.pieces_.length}function tn(t,e){var n=Ge(t),r=Ge(e);if(null===n)return e;if(n===r)return tn(Qe(t),Qe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function en(t,e){for(var n=Xe(t,0),r=Xe(e,0),i=0;i<n.length&&i<r.length;i++){var o=ae(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function nn(t,e){if(ze(t)!==ze(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function rn(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(ze(t)>ze(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var on=function(t,e){this.errorPrefix_=e,this.parts_=Xe(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=tt(this.parts_[n]);an(this)};function an(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+sn(t))}function sn(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var un,cn,hn=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return y("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(Be),ln=1e3,fn=function(t){function e(n,r,i,o,a,s,u,c){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=o,h.onServerInfoUpdate_=a,h.authTokenProvider_=s,h.appCheckTokenProvider_=u,h.authOverride_=c,h.id=e.nextPersistentConnectionId_++,h.log_=Zt("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=ln,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,c&&!R())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return hn.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&Ke.getInstance().on("online",h.onOnline_,h),h}return s(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(q(i)),y(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new E,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[o];void 0!==t&&i===t&&(delete e.outstandingGets_[o],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(o),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),y(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),y(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&B(t,"w")){var n=K(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();ne("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e;(t&&40===t.length||"object"==typeof(e=V(t).claims)&&!0===e.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t,e=this;if(this.connected_&&this.authToken_){var n=this.authToken_,r=(t=V(n).claims)&&"object"==typeof t&&t.hasOwnProperty("iat")?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,(function(t){var r=t.s,i=t.d||"error";e.authToken_===n&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),y(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+q(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):te("Unrecognized action received from server: "+q(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;y(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ln,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ln,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=ln),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return c(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,p,d,v,g,m=this;return h(this,(function(h){switch(h.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this.lastSessionId,a=!1,s=null,u=function(){s?s.close():(a=!0,r())},c=function(t){y(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(t)},this.realtime_={close:u,sendRequest:c},l=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)])];case 2:return p=f.apply(void 0,[h.sent(),2]),d=p[0],v=p[1],a?Jt("getToken() completed but was canceled"):(Jt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=v&&v.token,s=new qe(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){ne(t+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")}),o)),[3,4];case 3:return g=h.sent(),this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&ne(g),u()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){Jt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){Jt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],W(this.interruptReasons_)&&(this.reconnectDelay_=ln,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return ce(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new We(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){Jt("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){Jt("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=l(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,l(a.values())),u=s.next();!u.done;u=s.next()){var c=u.value;this.sendListen_(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={},e="js";R()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+Ft.replace(/\./g,"-")]=1,k()?t["framework.cordova"]=1:P()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=Ke.getInstance().currentlyOnline();return W(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Ve),pn=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),dn=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new pn(ie,t),r=new pn(ie,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return pn.MIN},t}(),vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return un},set:function(t){un=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return ae(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw m("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return pn.MIN},e.prototype.maxPost=function(){return new pn(oe,un)},e.prototype.makePost=function(t,e){return y("string"==typeof t,"KeyIndex indexValue must always be a string."),new pn(t,un)},e.prototype.toString=function(){return".key"},e}(dn),gn=new vn,yn=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),mn=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:_n.EMPTY_NODE,this.right=null!=o?o:_n.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return _n.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return _n.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),bn=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new mn(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),_n=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,mn.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,mn.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new yn(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new yn(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new yn(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new yn(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new bn,t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function wn(t,e){return ae(t.name,e.name)}function In(t,e){return ae(t,e)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Tn,En,Sn,Cn=function(t){return"number"==typeof t?"number:"+fe(t):"string:"+t},kn=function(t){if(t.isLeafNode()){var e=t.val();y("string"==typeof e||"number"==typeof e||"object"==typeof e&&B(e,".sv"),"Priority must be a string or number.")}else y(t===cn||t.isEmpty(),"priority of unexpected type.");y(t===cn||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Nn=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,y(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),kn(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Tn},set:function(t){Tn=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return Ze(e)?this:".priority"===Ge(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=Ge(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:(y(".priority"!==r||1===ze(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Qe(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Cn(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?fe(this.value_):this.value_,this.lazyHash_=zt(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(y(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return y(i>=0,"Unknown leaf type: "+n),y(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var An,Pn,Rn=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?ae(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return pn.MIN},e.prototype.maxPost=function(){return new pn(oe,new Nn("[PRIORITY-POST]",Sn))},e.prototype.makePost=function(t,e){var n=En(t);return new pn(e,new Nn("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(dn)),Dn=Math.log(2),On=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Dn,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),xn=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new mn(a,o.node,mn.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],a=n?n(o):o,new mn(a,o.node,mn.BLACK,c,h)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),h=t[o],l=n?n(h):h;u(new mn(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?s(l,mn.BLACK):(s(l,mn.BLACK),s(l,mn.RED))}return o}(new On(t.length));return new _n(r||e,o)},Ln={},Mn=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return y(Ln&&Rn,"ChildrenNode.ts has not been loaded"),An=An||new t({".priority":Ln},{".priority":Rn})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=K(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof _n?e:null},t.prototype.hasIndex=function(t){return B(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){y(e!==gn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,a=n.getIterator(pn.Wrap),s=a.getNext();s;)o=o||e.isDefinedOn(s.node),i.push(s),s=a.getNext();r=o?xn(i,e.getCompare()):Ln;var c=e.toString(),h=u({},this.indexSet_);h[c]=e;var l=u({},this.indexes_);return l[c]=r,new t(l,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(H(this.indexes_,(function(t,i){var o=K(r.indexSet_,i);if(y(o,"Missing index implementation for "+i),t===Ln){if(o.isDefinedOn(e.node)){for(var a=[],s=n.getIterator(pn.Wrap),u=s.getNext();u;)u.name!==e.name&&a.push(u),u=s.getNext();return a.push(e),xn(a,o.getCompare())}return Ln}var c=n.get(e.name),h=t;return c&&(h=h.remove(new pn(e.name,c))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(H(this.indexes_,(function(t){if(t===Ln)return t;var r=n.get(e.name);return r?t.remove(new pn(e.name,r)):t})),this.indexSet_)},t}(),Fn=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&kn(this.priorityNode_),this.children_.isEmpty()&&y(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Pn||(Pn=new t(new _n(In),null,Mn.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Pn},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Pn:e},t.prototype.getChild=function(t){var e=Ge(t);return null===e?this:this.getImmediateChild(e).getChild(Qe(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(y(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new pn(e,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?Pn:this.priorityNode_;return new t(i,a,o)},t.prototype.updateChild=function(t,e){var n=Ge(t);if(null===n)return e;y(".priority"!==Ge(t)||1===ze(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(Qe(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Rn,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Cn(this.getPriority().val())+":"),this.forEachChild(Rn,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":zt(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new pn(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new pn(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new pn(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,pn.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,pn.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Un?-1:0},t.prototype.withIndex=function(e){if(e===gn||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===gn||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Rn),r=e.getIterator(Rn),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===gn?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Un=new(function(t){function e(){return t.call(this,new _n(In),Fn.EMPTY_NODE,Mn.Default)||this}return s(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Fn.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Fn));Object.defineProperties(pn,{MIN:{value:new pn(ie,Fn.EMPTY_NODE)},MAX:{value:new pn(oe,Un)}}),vn.__EMPTY_NODE=Fn.EMPTY_NODE,Nn.__childrenNodeConstructor=Fn,cn=Un,function(t){Sn=t}(Un);function jn(t,e){if(void 0===e&&(e=null),null===t)return Fn.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),y(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Nn(t,jn(e));if(t instanceof Array){var n=Fn.EMPTY_NODE;return le(t,(function(e,r){if(B(t,e)&&"."!==e.substring(0,1)){var i=jn(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(jn(e))}var r=[],i=!1;if(le(t,(function(t,e){if("."!==t.substring(0,1)){var n=jn(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new pn(t,n)))}})),0===r.length)return Fn.EMPTY_NODE;var o=xn(r,wn,(function(t){return t.name}),In);if(i){var a=xn(r,Rn.getCompare());return new Fn(o,jn(e),new Mn({".priority":a},{".priority":Rn}))}return new Fn(o,jn(e),Mn.Default)}!function(t){En=t}(jn);
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var qn,Vn,Bn=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,y(!Ze(e)&&".priority"!==Ge(e),"Can't create PathIndex with empty path or .priority key"),n}return s(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?ae(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=jn(t),r=Fn.EMPTY_NODE.updateChild(this.indexPath_,n);return new pn(e,r)},e.prototype.maxPost=function(){var t=Fn.EMPTY_NODE.updateChild(this.indexPath_,Un);return new pn(oe,t)},e.prototype.toString=function(){return Xe(this.indexPath_,0).join("/")},e}(dn),Kn=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?ae(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return pn.MIN},e.prototype.maxPost=function(){return pn.MAX},e.prototype.makePost=function(t,e){var n=jn(t);return new pn(e,n)},e.prototype.toString=function(){return".value"},e}(dn)),Wn="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Hn=(qn=0,Vn=[],function(t){var e,n=t===qn;qn=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=Wn.charAt(t%64),t=Math.floor(t/64);y(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===Vn[e];e--)Vn[e]=0;Vn[e]++}else for(e=0;e<12;e++)Vn[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=Wn.charAt(Vn[e]);return y(20===i.length,"nextPushId: Length should be 20."),i}),Gn=function(t){if("2147483647"===t)return"-";var e=ge(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return oe;var o=n[i],a=Wn.charAt(Wn.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},zn=function(t){if("-2147483648"===t)return ie;var e=ge(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=Wn.charAt(Wn.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function Qn(t){return{type:"value",snapshotNode:t}}function Yn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Xn(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function $n(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var Jn=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){y(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(Xn(e,a)):y(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Yn(e,n)):o.trackChildChange($n(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Rn,(function(t,r){e.hasChild(t)||n.trackChildChange(Xn(t,r))})),e.isLeafNode()||e.forEachChild(Rn,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange($n(e,r,i))}else n.trackChildChange(Yn(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Fn.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Zn=function(){function t(e){this.indexedFilter_=new Jn(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new pn(e,n))||(n=Fn.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Fn.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Fn.EMPTY_NODE);var i=this;return e.forEachChild(Rn,(function(t,e){i.matches(new pn(t,e))||(r=r.updateImmediateChild(t,Fn.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),tr=function(){function t(t){this.rangedFilter_=new Zn(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new pn(e,n))||(n=Fn.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Fn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Fn.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Fn.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();){a=i.getNext();!l&&c(s,a)<=0&&(l=!0),l&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,Fn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var s=t;y(s.numChildren()===this.limit_,"");var u=new pn(e,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(s.hasChild(e)){for(var l=s.getImmediateChild(e),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===e||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:o(f,u);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange($n(e,n,l)),s.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Xn(e,l));var d=s.updateImmediateChild(e,Fn.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Yn(f.name,f.node)),d.updateImmediateChild(f.name,f.node)):d}return n.isEmpty()?t:h&&o(c,u)>=0?(null!=i&&(i.trackChildChange(Xn(c.name,c.node)),i.trackChildChange(Yn(e,n))),s.updateImmediateChild(e,n).updateImmediateChild(c.name,Fn.EMPTY_NODE)):t},t}(),er=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Rn}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return y(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return y(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ie},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return y(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return y(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:oe},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return y(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Rn},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function nr(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function rr(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function ir(t,e){var n=t.copy();return n.index_=e,n}function or(t){var e,n={};return t.isDefault()||(t.index_===Rn?e="$priority":t.index_===Kn?e="$value":t.index_===gn?e="$key":(y(t.index_ instanceof Bn,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=q(e),t.startSet_&&(n.startAt=q(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+q(t.indexStartName_))),t.endSet_&&(n.endAt=q(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+q(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function ar(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Rn&&(e.i=t.index_.toString()),e}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var sr=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=Zt("p:rest:"),o.listens_={},o}return s(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(y(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t._path.toString();this.log_("Listen called for "+a+" "+t._queryIdentifier);var s=e.getListenId_(t,r),u={};this.listens_[s]=u;var c=or(t._queryParams);this.restRequest_(a+".json",c,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),K(o.listens_,s)===u)&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=or(t._queryParams),r=t._path.toString(),i=new E;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var o=f(i,2),a=o[0],s=o[1];a&&a.accessToken&&(e.auth=a.accessToken),s&&s.token&&(e.ac=s.token);var u=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}(e);r.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(n&&4===c.readyState){r.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var t=null;if(c.status>=200&&c.status<300){try{t=j(c.responseText)}catch(t){ne("Failed to parse JSON response for "+u+": "+c.responseText)}n(null,t)}else 401!==c.status&&404!==c.status&&ne("Got unsuccessful REST response for "+u+" Status: "+c.status),n(c.status);n=null}},c.open("GET",u,!0),c.send()}))},e}(Ve),ur=function(){function t(){this.rootNode_=Fn.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function cr(){return{value:null,children:new Map}}function hr(t,e,n){if(Ze(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=Ge(e);t.children.has(r)||t.children.set(r,cr()),hr(t.children.get(r),e=Qe(e),n)}}function lr(t,e){if(Ze(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(Rn,(function(e,n){hr(t,new We(e),n)})),lr(t,e)}if(t.children.size>0){var r=Ge(e);if(e=Qe(e),t.children.has(r))lr(t.children.get(r),e)&&t.children.delete(r);return 0===t.children.size}return!0}function fr(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t,(function(t,r){fr(r,new We(e.toString()+"/"+t),n)}))}var pr,dr,vr=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=u({},t);return this.last_&&le(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),gr=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new vr(t);var n=1e4+2e4*Math.random();me(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;le(e,(function(e,i){i>0&&B(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),me(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function yr(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(dr=pr||(pr={}))[dr.OVERWRITE=0]="OVERWRITE",dr[dr.MERGE=1]="MERGE",dr[dr.ACK_USER_WRITE=2]="ACK_USER_WRITE",dr[dr.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var mr,br=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=pr.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(Ze(this.path)){if(null!=this.affectedTree.value)return y(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new We(e));return new t(He(),n,this.revert)}return y(Ge(this.path)===e,"operationForChild called for unrelated child."),new t(Qe(this.path),this.affectedTree,this.revert)},t}(),_r=function(){function t(t,e){this.source=t,this.path=e,this.type=pr.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return Ze(this.path)?new t(this.source,He()):new t(this.source,Qe(this.path))},t}(),wr=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=pr.OVERWRITE}return t.prototype.operationForChild=function(e){return Ze(this.path)?new t(this.source,He(),this.snap.getImmediateChild(e)):new t(this.source,Qe(this.path),this.snap)},t}(),Ir=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=pr.MERGE}return t.prototype.operationForChild=function(e){if(Ze(this.path)){var n=this.children.subtree(new We(e));return n.isEmpty()?null:n.value?new wr(this.source,He(),n.value):new t(this.source,He(),n)}return y(Ge(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Qe(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Tr=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(Ze(t))return this.isFullyInitialized()&&!this.filtered_;var e=Ge(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Er=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Sr(t,e,n,r,i,o){var a=r.filter((function(t){return t.type===n}));a.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw m("Should only compare child_ events.");var r=new pn(e.childName,e.snapshotNode),i=new pn(n.childName,n.snapshotNode);return t.index_.compare(r,i)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t,e,n)})),a.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,o);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Cr(t,e){return{eventCache:t,serverCache:e}}function kr(t,e,n,r){return Cr(new Tr(e,n,r),t.serverCache)}function Nr(t,e,n,r){return Cr(t.eventCache,new Tr(e,n,r))}function Ar(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Pr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Rr=function(){function t(t,e){void 0===e&&(mr||(mr=new _n(se)),e=mr),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return le(e,(function(t,e){n=n.set(new We(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:He(),value:this.value};if(Ze(t))return null;var n=Ge(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(Qe(t),e);return null!=i?{path:Je(new We(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(Ze(e))return this;var n=Ge(e),r=this.children.get(n);return null!==r?r.subtree(Qe(e)):new t(null)},t.prototype.set=function(e,n){if(Ze(e))return new t(n,this.children);var r=Ge(e),i=(this.children.get(r)||new t(null)).set(Qe(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(Ze(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=Ge(e),r=this.children.get(n);if(r){var i=r.remove(Qe(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(Ze(t))return this.value;var e=Ge(t),n=this.children.get(e);return n?n.get(Qe(t)):null},t.prototype.setTree=function(e,n){if(Ze(e))return n;var r=Ge(e),i=(this.children.get(r)||new t(null)).setTree(Qe(e),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(He(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Je(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,He(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(Ze(t))return null;var i=Ge(t),o=this.children.get(i);return o?o.findOnPath_(Qe(t),Je(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,He(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(Ze(e))return this;this.value&&r(n,this.value);var i=Ge(e),o=this.children.get(i);return o?o.foreachOnPath_(Qe(e),Je(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(He(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(Je(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),Dr=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new Rr(null))},t}();function Or(t,e,n){if(Ze(e))return new Dr(new Rr(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=tn(i,e);return o=o.updateChild(a,n),new Dr(t.writeTree_.set(i,o))}var s=new Rr(n),u=t.writeTree_.setTree(e,s);return new Dr(u)}function xr(t,e,n){var r=t;return le(n,(function(t,n){r=Or(r,Je(e,t),n)})),r}function Lr(t,e){if(Ze(e))return Dr.empty();var n=t.writeTree_.setTree(e,new Rr(null));return new Dr(n)}function Mr(t,e){return null!=Fr(t,e)}function Fr(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(tn(n.path,e)):null}function Ur(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Rn,(function(t,n){e.push(new pn(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new pn(t,n.value))})),e}function jr(t,e){if(Ze(e))return t;var n=Fr(t,e);return new Dr(null!=n?new Rr(n):t.writeTree_.subtree(e))}function qr(t){return t.writeTree_.isEmpty()}function Vr(t,e){return Br(He(),t.writeTree_,e)}function Br(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?(y(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Br(Je(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(Je(t,".priority"),r)),n}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Kr(t,e){return ni(e,t)}function Wr(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));y(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,o=!1,a=t.allWrites.length-1;i&&a>=0;){var s=t.allWrites[a];s.visible&&(a>=n&&Hr(s,r.path)?i=!1:rn(r.path,s.path)&&(o=!0)),a--}if(i){if(o)return function(t){t.visibleWrites=zr(t.allWrites,Gr,He()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0;r.snap?t.visibleWrites=Lr(t.visibleWrites,r.path):le(r.children,(function(e){t.visibleWrites=Lr(t.visibleWrites,Je(r.path,e))}));return!0}return!1}function Hr(t,e){if(t.snap)return rn(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&rn(Je(t.path,n),e))return!0;return!1}function Gr(t){return t.visible}function zr(t,e,n){for(var r=Dr.empty(),i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,s=void 0;if(o.snap)rn(n,a)?r=Or(r,s=tn(n,a),o.snap):rn(a,n)&&(s=tn(a,n),r=Or(r,He(),o.snap.getChild(s)));else{if(!o.children)throw m("WriteRecord should have .snap or .children");if(rn(n,a))r=xr(r,s=tn(n,a),o.children);else if(rn(a,n))if(Ze(s=tn(a,n)))r=xr(r,He(),o.children);else{var u=K(o.children,Ge(s));if(u){var c=u.getChild(Qe(s));r=Or(r,He(),c)}}}}}return r}function Qr(t,e,n,r,i){if(r||i){var o=jr(t.visibleWrites,e);if(!i&&qr(o))return n;if(i||null!=n||Mr(o,He())){return Vr(zr(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(rn(t.path,e)||rn(e,t.path))}),e),n||Fn.EMPTY_NODE)}return null}var a=Fr(t.visibleWrites,e);if(null!=a)return a;var s=jr(t.visibleWrites,e);return qr(s)?n:null!=n||Mr(s,He())?Vr(s,n||Fn.EMPTY_NODE):null}function Yr(t,e,n,r){return Qr(t.writeTree,t.treePath,e,n,r)}function Xr(t,e){return function(t,e,n){var r=Fn.EMPTY_NODE,i=Fr(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Rn,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=jr(t.visibleWrites,e);return n.forEachChild(Rn,(function(t,e){var n=Vr(jr(o,new We(t)),e);r=r.updateImmediateChild(t,n)})),Ur(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return Ur(jr(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function $r(t,e,n,r){return function(t,e,n,r,i){y(r||i,"Either existingEventSnap or existingServerSnap must exist");var o=Je(e,n);if(Mr(t.visibleWrites,o))return null;var a=jr(t.visibleWrites,o);return qr(a)?i.getChild(n):Vr(a,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function Jr(t,e){return function(t,e){return Fr(t.visibleWrites,e)}(t.writeTree,Je(t.treePath,e))}function Zr(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=jr(t.visibleWrites,e),c=Fr(u,He());if(null!=c)s=c;else{if(null==n)return[];s=Vr(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var h=[],l=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),p=f.getNext();p&&h.length<i;)0!==l(p,r)&&h.push(p),p=f.getNext();return h}(t.writeTree,t.treePath,e,n,r,i,o)}function ti(t,e,n){return function(t,e,n,r){var i=Je(e,n),o=Fr(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?Vr(jr(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function ei(t,e){return ni(Je(t.treePath,e),t.writeTree)}function ni(t,e){return{treePath:t,writeTree:e}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var ri=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;y("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),y(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,$n(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,Xn(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,Yn(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw m("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,$n(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),ii=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),oi=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Tr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ti(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Pr(this.viewCache_),i=Zr(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function ai(t,e,n,r,i){var o,a,s=new ri;if(n.type===pr.OVERWRITE){var u=n;u.source.fromUser?o=ci(t,e,u.path,u.snap,r,i,s):(y(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Ze(u.path),o=ui(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===pr.MERGE){var c=n;c.source.fromUser?o=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=Je(n,r);hi(e,Ge(c))&&(s=ci(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=Je(n,r);hi(e,Ge(c))||(s=ci(t,s,c,u,i,o,a))})),s}(t,e,c.path,c.children,r,i,s):(y(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=fi(t,e,c.path,c.children,r,i,a,s))}else if(n.type===pr.ACK_USER_WRITE){var h=n;o=h.revert?function(t,e,n,r,i,o){var a;if(null!=Jr(r,n))return e;var s=new oi(r,e,i),u=e.eventCache.getNode(),c=void 0;if(Ze(n)||".priority"===Ge(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=Yr(r,Pr(e));else{var l=e.serverCache.getNode();y(l instanceof Fn,"serverChildren would be complete if leaf node"),h=Xr(r,l)}h=h,c=t.filter.updateFullNode(u,h,o)}else{var f=Ge(n),p=ti(r,f,e.serverCache);null==p&&e.serverCache.isCompleteForChild(f)&&(p=u.getImmediateChild(f)),(c=null!=p?t.filter.updateChild(u,f,p,Qe(n),s,o):e.eventCache.getNode().hasChild(f)?t.filter.updateChild(u,f,Fn.EMPTY_NODE,Qe(n),s,o):u).isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Yr(r,Pr(e))).isLeafNode()&&(c=t.filter.updateFullNode(c,a,o))}return a=e.serverCache.isFullyInitialized()||null!=Jr(r,He()),kr(e,c,a,t.filter.filtersNodes())}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t,e,h.path,r,i,s):function(t,e,n,r,i,o,a){if(null!=Jr(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(Ze(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return ui(t,e,n,u.getNode().getChild(n),i,o,s,a);if(Ze(n)){var c=new Rr(null);return u.getNode().forEachChild(gn,(function(t,e){c=c.set(new We(t),e)})),fi(t,e,n,c,i,o,s,a)}return e}var h=new Rr(null);return r.foreach((function(t,e){var r=Je(n,t);u.isCompleteForPath(r)&&(h=h.set(t,u.getNode().getChild(r)))})),fi(t,e,n,h,i,o,s,a)}(t,e,h.path,h.affectedTree,r,i,s)}else{if(n.type!==pr.LISTEN_COMPLETE)throw m("Unknown operation type: "+n.type);o=function(t,e,n,r,i){var o=e.serverCache,a=Nr(e,o.getNode(),o.isFullyInitialized()||Ze(n),o.isFiltered());return si(t,a,n,r,ii,i)}(t,e,n.path,r,s)}var l=s.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Ar(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Qn(Ar(e)))}}(e,o,l),{viewCache:o,changes:l}}function si(t,e,n,r,i,o){var a=e.eventCache;if(null!=Jr(r,n))return e;var s=void 0,u=void 0;if(Ze(n))if(y(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var c=Pr(e),h=Xr(r,c instanceof Fn?c:Fn.EMPTY_NODE);s=t.filter.updateFullNode(e.eventCache.getNode(),h,o)}else{var l=Yr(r,Pr(e));s=t.filter.updateFullNode(e.eventCache.getNode(),l,o)}else{var f=Ge(n);if(".priority"===f){y(1===ze(n),"Can't have a priority with additional path components");var p=a.getNode(),d=$r(r,n,p,u=e.serverCache.getNode());s=null!=d?t.filter.updatePriority(p,d):a.getNode()}else{var v=Qe(n),g=void 0;if(a.isCompleteForChild(f)){u=e.serverCache.getNode();var m=$r(r,n,a.getNode(),u);g=null!=m?a.getNode().getImmediateChild(f).updateChild(v,m):a.getNode().getImmediateChild(f)}else g=ti(r,f,e.serverCache);s=null!=g?t.filter.updateChild(a.getNode(),f,g,v,i,o):a.getNode()}}return kr(e,s,a.isFullyInitialized()||Ze(n),t.filter.filtersNodes())}function ui(t,e,n,r,i,o,a,s){var u,c=e.serverCache,h=a?t.filter:t.filter.getIndexedFilter();if(Ze(n))u=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){var l=c.getNode().updateChild(n,r);u=h.updateFullNode(c.getNode(),l,null)}else{var f=Ge(n);if(!c.isCompleteForPath(n)&&ze(n)>1)return e;var p=Qe(n),d=c.getNode().getImmediateChild(f).updateChild(p,r);u=".priority"===f?h.updatePriority(c.getNode(),d):h.updateChild(c.getNode(),f,d,p,ii,null)}var v=Nr(e,u,c.isFullyInitialized()||Ze(n),h.filtersNodes());return si(t,v,n,i,new oi(i,v,o),s)}function ci(t,e,n,r,i,o,a){var s,u,c=e.eventCache,h=new oi(i,e,o);if(Ze(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=kr(e,u,!0,t.filter.filtersNodes());else{var l=Ge(n);if(".priority"===l)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=kr(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=Qe(n),p=c.getNode().getImmediateChild(l),d=void 0;if(Ze(f))d=r;else{var v=h.getCompleteChild(l);d=null!=v?".priority"===Ye(f)&&v.getChild($e(f)).isEmpty()?v:v.updateChild(f,r):Fn.EMPTY_NODE}if(p.equals(d))s=e;else s=kr(e,t.filter.updateChild(c.getNode(),l,d,f,h,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function hi(t,e){return t.eventCache.isCompleteForChild(e)}function li(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function fi(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=Ze(n)?r:new Rr(null).setTree(n,r);var h=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(h.hasChild(n)){var u=li(0,e.serverCache.getNode().getImmediateChild(n),r);c=ui(t,c,new We(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!h.hasChild(n)&&!u){var l=li(0,e.serverCache.getNode().getImmediateChild(n),r);c=ui(t,c,new We(n),l,i,o,a,s)}})),c}var pi,di=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new Jn(r.getIndex()),o=(n=r).loadsAllData()?new Jn(n.getIndex()):n.hasLimit()?new tr(n):new Zn(n);this.processor_=
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(Fn.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(Fn.EMPTY_NODE,s.getNode(),null),h=new Tr(u,a.isFullyInitialized(),i.filtersNodes()),l=new Tr(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Cr(l,h),this.eventGenerator_=new Er(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function vi(t,e){var n=Pr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ze(e)&&!n.getImmediateChild(Ge(e)).isEmpty())?n.getChild(e):null}function gi(t){return 0===t.eventRegistrations_.length}function yi(t,e,n){var r=[];if(n){y(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var o=[],a=0;a<t.eventRegistrations_.length;++a){var s=t.eventRegistrations_[a];if(s.matches(e)){if(e.hasAnyCallback()){o=o.concat(t.eventRegistrations_.slice(a+1));break}}else o.push(s)}t.eventRegistrations_=o}else t.eventRegistrations_=[];return r}function mi(t,e,n,r){e.type===pr.MERGE&&null!==e.source.queryId&&(y(Pr(t.viewCache_),"We should always have a full cache before handling merges"),y(Ar(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,o,a=t.viewCache_,s=ai(t.processor_,a,e,n,r);return i=t.processor_,o=s.viewCache,y(o.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),y(o.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),y(s.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,bi(t,s.changes,s.viewCache.eventCache.getNode(),null)}function bi(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Sr(t,i,"child_removed",e,r,n),Sr(t,i,"child_added",e,r,n),Sr(t,i,"child_moved",o,r,n),Sr(t,i,"child_changed",e,r,n),Sr(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var _i,wi=function(){this.views=new Map};function Ii(t,e,n,r){var i,o,a=e.source.queryId;if(null!==a){var s=t.views.get(a);return y(null!=s,"SyncTree gave us an op for an invalid query."),mi(s,e,n,r)}var u=[];try{for(var c=l(t.views.values()),h=c.next();!h.done;h=c.next()){s=h.value;u=u.concat(mi(s,e,n,r))}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return u}function Ti(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=Yr(n,i?r:null),u=!1;s?u=!0:r instanceof Fn?(s=Xr(n,r),u=!1):(s=Fn.EMPTY_NODE,u=!1);var c=Cr(new Tr(s,u,!1),new Tr(r,i,!1));return new di(e,c)}return a}function Ei(t,e,n,r,i,o){var a=Ti(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Rn,(function(t,e){r.push(Yn(t,e))})),n.isFullyInitialized()&&r.push(Qn(n.getNode())),bi(t,r,n.getNode(),e)}(a,n)}function Si(t,e,n,r){var i,o,a=e._queryIdentifier,s=[],u=[],c=Pi(t);if("default"===a)try{for(var h=l(t.views.entries()),p=h.next();!p.done;p=h.next()){var d=f(p.value,2),v=d[0],g=d[1];u=u.concat(yi(g,n,r)),gi(g)&&(t.views.delete(v),g.query._queryParams.loadsAllData()||s.push(g.query))}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else(g=t.views.get(a))&&(u=u.concat(yi(g,n,r)),gi(g)&&(t.views.delete(a),g.query._queryParams.loadsAllData()||s.push(g.query)));return c&&!Pi(t)&&s.push(new(y(pi,"Reference.ts has not been loaded"),pi)(e._repo,e._path)),{removed:s,events:u}}function Ci(t){var e,n,r=[];try{for(var i=l(t.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function ki(t,e){var n,r,i=null;try{for(var o=l(t.views.values()),a=o.next();!a.done;a=o.next()){var s=a.value;i=i||vi(s,e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Ni(t,e){if(e._queryParams.loadsAllData())return Ri(t);var n=e._queryIdentifier;return t.views.get(n)}function Ai(t,e){return null!=Ni(t,e)}function Pi(t){return null!=Ri(t)}function Ri(t){var e,n;try{for(var r=l(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Di=1,Oi=function(t){this.listenProvider_=t,this.syncPointTree_=new Rr(null),this.pendingWriteTree_={visibleWrites:Dr.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function xi(t,e,n,r,i){return function(t,e,n,r,i){y(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Or(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?Bi(t,new wr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Li(t,e,n,r){!function(t,e,n,r){y(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=xr(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=Rr.fromObject(n);return Bi(t,new Ir({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}function Mi(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(Wr(t.pendingWriteTree_,e)){var i=new Rr(null);return null!=r.snap?i=i.set(He(),!0):le(r.children,(function(t){i=i.set(new We(t),!0)})),Bi(t,new br(r.path,i,n))}return[]}function Fi(t,e,n){return Bi(t,new wr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Ui(t,e,n,r){var i=e._path,o=t.syncPointTree_.get(i),a=[];if(o&&("default"===e._queryIdentifier||Ai(o,e))){var s=Si(o,e,n,r);0===o.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex((function(t){return t._queryParams.loadsAllData()})),h=t.syncPointTree_.findOnPath(i,(function(t,e){return Pi(e)}));if(c&&!h){var l=t.syncPointTree_.subtree(i);if(!l.isEmpty())for(var f=function(t){return t.fold((function(t,e,n){if(e&&Pi(e))return[Ri(e)];var r=[];return e&&(r=Ci(e)),le(n,(function(t,e){r=r.concat(e)})),r}))}(l),p=0;p<f.length;++p){var d=f[p],v=d.query,g=Hi(t,d);t.listenProvider_.startListening($i(v),Gi(t,v),g.hashFn,g.onComplete)}}if(!h&&u.length>0&&!r)if(c){t.listenProvider_.stopListening($i(e),null)}else u.forEach((function(e){var n=t.queryToTagMap.get(zi(e));t.listenProvider_.stopListening($i(e),n)}));!function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=zi(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,u)}return a}function ji(t,e,n){var r=e._path,i=null,o=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=tn(t,r);i=i||ki(e,n),o=o||Pi(e)}));var a,s=t.syncPointTree_.get(r);(s?(o=o||Pi(s),i=i||ki(s,He())):(s=new wi,t.syncPointTree_=t.syncPointTree_.set(r,s)),null!=i)?a=!0:(a=!1,i=Fn.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=ki(e,He());n&&(i=i.updateImmediateChild(t,n))})));var u=Ai(s,e);if(!u&&!e._queryParams.loadsAllData()){var c=zi(e);y(!t.queryToTagMap.has(c),"View does not exist, but we have a tag");var h=Di++;t.queryToTagMap.set(c,h),t.tagToQueryMap.set(h,c)}var l=Ei(s,e,n,Kr(t.pendingWriteTree_,r),i,a);if(!u&&!o){var f=Ni(s,e);l=l.concat(function(t,e,n){var r=e._path,i=Gi(t,e),o=Hi(t,n),a=t.listenProvider_.startListening($i(e),i,o.hashFn,o.onComplete),s=t.syncPointTree_.subtree(r);if(i)y(!Pi(s.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold((function(t,e,n){if(!Ze(t)&&e&&Pi(e))return[Ri(e).query];var r=[];return e&&(r=r.concat(Ci(e).map((function(t){return t.query})))),le(n,(function(t,e){r=r.concat(e)})),r})),c=0;c<u.length;++c){var h=u[c];t.listenProvider_.stopListening($i(h),Gi(t,h))}return a}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t,e,f))}return l}function qi(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=ki(n,tn(t,e));if(r)return r}));return Qr(r,e,i,n,!0)}function Vi(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=tn(t,n);r=r||ki(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||ki(i,He()):(i=new wi,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Tr(r,!0,!1):null;return function(t){return Ar(t.viewCache_)}(Ti(i,e,Kr(t.pendingWriteTree_,e._path),o?a.getNode():Fn.EMPTY_NODE,o))}function Bi(t,e){return Ki(e,t.syncPointTree_,null,Kr(t.pendingWriteTree_,He()))}function Ki(t,e,n,r){if(Ze(t.path))return Wi(t,e,n,r);var i=e.get(He());null==n&&null!=i&&(n=ki(i,He()));var o=[],a=Ge(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,h=ei(r,a);o=o.concat(Ki(s,u,c,h))}return i&&(o=o.concat(Ii(i,t,r,n))),o}function Wi(t,e,n,r){var i=e.get(He());null==n&&null!=i&&(n=ki(i,He()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=ei(r,e),u=t.operationForChild(e);u&&(o=o.concat(Wi(u,i,a,s)))})),i&&(o=o.concat(Ii(i,t,r,n))),o}function Hi(t,e){var n=e.query,r=Gi(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||Fn.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=Qi(t,n);if(r){var i=Yi(r),o=i.path,a=i.queryId,s=tn(o,e);return Xi(t,o,new _r(yr(a),s))}return[]}(t,n._path,r):function(t,e){return Bi(t,new _r({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return Ui(t,n,null,i)}}}function Gi(t,e){var n=zi(e);return t.queryToTagMap.get(n)}function zi(t){return t._path.toString()+"$"+t._queryIdentifier}function Qi(t,e){return t.tagToQueryMap.get(e)}function Yi(t){var e=t.indexOf("$");return y(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new We(t.substr(0,e))}}function Xi(t,e,n){var r=t.syncPointTree_.get(e);return y(r,"Missing sync point for query tag that we're tracking"),Ii(r,n,Kr(t.pendingWriteTree_,e),null)}function $i(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(y(_i,"Reference.ts has not been loaded"),_i)(t._repo,t._path):t}var Ji=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),Zi=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=Je(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return qi(this.syncTree_,this.path_)},t}(),to=function(t,e,n){return t&&"object"==typeof t?(y(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?eo(t[".sv"],e,n):"object"==typeof t[".sv"]?no(t[".sv"],e):void y(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},eo=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:y(!1,"Unexpected server value: "+t)}},no=function(t,e,n){t.hasOwnProperty("increment")||y(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&y(!1,"Unexpected increment value: "+r);var i=e.node();if(y(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},ro=function(t,e,n,r){return oo(e,new Zi(n,t),r)},io=function(t,e,n){return oo(t,new Ji(e),n)};function oo(t,e,n){var r,i=t.getPriority().val(),o=to(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=to(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new Nn(s,jn(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Nn(o))),u.forEachChild(Rn,(function(t,i){var o=oo(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var ao=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function so(t,e){for(var n=e instanceof We?e:new We(e),r=t,i=Ge(n);null!==i;){var o=K(r.node.children,i)||{children:{},childCount:0};r=new ao(i,r,o),i=Ge(n=Qe(n))}return r}function uo(t){return t.node.value}function co(t,e){t.node.value=e,vo(t)}function ho(t){return t.node.childCount>0}function lo(t,e){le(t.node.children,(function(n,r){e(new ao(n,t,r))}))}function fo(t,e,n,r){n&&!r&&e(t),lo(t,(function(t){fo(t,e,!0,r)})),n&&r&&e(t)}function po(t){return new We(null===t.parent?t.name:po(t.parent)+"/"+t.name)}function vo(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===uo(t)&&!ho(t)}(n),i=B(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,vo(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,vo(t))}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t.parent,t.name,t)}var go=/[\[\].#$\/\u0000-\u001F\u007F]/,yo=/[\[\].#$\u0000-\u001F\u007F]/,mo=10485760,bo=function(t){return"string"==typeof t&&0!==t.length&&!go.test(t)},_o=function(t){return"string"==typeof t&&0!==t.length&&!yo.test(t)},wo=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!re(t)||t&&"object"==typeof t&&B(t,".sv")},Io=function(t,e,n,r){r&&void 0===e||To($(t,"value"),e,n)},To=function(t,e,n){var r=n instanceof We?new on(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+sn(r));if("function"==typeof e)throw new Error(t+"contains a function "+sn(r)+" with contents = "+e.toString());if(re(e))throw new Error(t+"contains "+e.toString()+" "+sn(r));if("string"==typeof e&&e.length>3495253.3333333335&&tt(e)>mo)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+sn(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(le(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!bo(e)))throw new Error(t+" contains an invalid key ("+e+") "+sn(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,s;s=e,(a=r).parts_.length>0&&(a.byteLength_+=1),a.parts_.push(s),a.byteLength_+=tt(s),an(a),To(t,n,r),function(t){var e=t.parts_.pop();t.byteLength_-=tt(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)})),i&&o)throw new Error(t+' contains ".value" child '+sn(r)+" in addition to actual children.")}},Eo=function(t,e,n,r){if(!r||void 0!==e){var i=$(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var o=[];le(e,(function(t,e){var r=new We(t);if(To(i,e,Je(n,r)),".priority"===Ye(r)&&!wo(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=Xe(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!bo(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(en);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&rn(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,o)}},So=function(t,e,n){if(!n||void 0!==e){if(re(e))throw new Error($(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!wo(e))throw new Error($(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Co=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error($(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},ko=function(t,e,n,r){if(!(r&&void 0===n||bo(n)))throw new Error($(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},No=function(t,e,n,r){if(!(r&&void 0===n||_o(n)))throw new Error($(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ao=function(t,e){if(".info"===Ge(e))throw new Error(t+" failed = Can't modify data under /.info/")},Po=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!bo(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),_o(t)}(n))throw new Error($(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Ro=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error($(t,e)+"must be a boolean.")},Do=function(){this.eventLists_=[],this.recursionDepth_=0};function Oo(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||nn(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function xo(t,e,n){Oo(t,n),Mo(t,(function(t){return nn(t,e)}))}function Lo(t,e,n){Oo(t,n),Mo(t,(function(t){return rn(t,e)||rn(e,t)}))}function Mo(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];if(i)e(i.path)?(Fo(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}n&&(t.eventLists_=[]),t.recursionDepth_--}function Fo(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();Yt&&Jt("event: "+n.toString()),ye(r)}}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Uo="repo_interrupt",jo=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Do,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=cr(),this.transactionQueueTree_=new ao,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function qo(t,e,n){if(t.stats_=Re(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new sr(t.repoInfo_,(function(e,n,r,i){Ko(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return Wo(t,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{q(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new fn(t.repoInfo_,e,(function(e,n,r,i){Ko(t,e,n,r,i)}),(function(e){Wo(t,e)}),(function(e){!function(t,e){le(e,(function(e,n){Ho(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}var r,i,o;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=(r=t.repoInfo_,i=function(){return new gr(t.stats_,t.server_)},o=r.toString(),Pe[o]||(Pe[o]=i()),Pe[o]),t.infoData_=new ur,t.infoSyncTree_=new Oi({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=Fi(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),Ho(t,"connected",!1),t.serverSyncTree_=new Oi({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);Lo(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}function Vo(t){var e=t.infoData_.getNode(new We(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function Bo(t){return(e=(e={timestamp:Vo(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function Ko(t,e,n,r,i){t.dataUpdateCount++;var o=new We(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var a=[];if(i)if(r){var s=H(n,(function(t){return jn(t)}));a=function(t,e,n,r){var i=Qi(t,r);if(i){var o=Yi(i),a=o.path,s=o.queryId,u=tn(a,e),c=Rr.fromObject(n);return Xi(t,a,new Ir(yr(s),u,c))}return[]}(t.serverSyncTree_,o,s,i)}else{var u=jn(n);a=function(t,e,n,r){var i=Qi(t,r);if(null!=i){var o=Yi(i),a=o.path,s=o.queryId,u=tn(a,e);return Xi(t,a,new wr(yr(s),u,n))}return[]}(t.serverSyncTree_,o,u,i)}else if(r){var c=H(n,(function(t){return jn(t)}));a=function(t,e,n){var r=Rr.fromObject(n);return Bi(t,new Ir({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,o,c)}else{var h=jn(n);a=Fi(t.serverSyncTree_,o,h)}var l=o;a.length>0&&(l=na(t,o)),Lo(t.eventQueue_,l,a)}function Wo(t,e){Ho(t,"connected",e),!1===e&&function(t){Jo(t,"onDisconnectEvents");var e=Bo(t),n=cr();fr(t.onDisconnect_,He(),(function(r,i){var o=ro(r,i,t.serverSyncTree_,e);hr(n,r,o)}));var r=[];fr(n,He(),(function(e,n){r=r.concat(Fi(t.serverSyncTree_,e,n));var i=sa(t,e);na(t,i)})),t.onDisconnect_=cr(),Lo(t.eventQueue_,He(),r)}(t)}function Ho(t,e,n){var r=new We("/.info/"+e),i=jn(n);t.infoData_.updateSnapshot(r,i);var o=Fi(t.infoSyncTree_,r,i);Lo(t.eventQueue_,r,o)}function Go(t){return t.nextWriteId_++}function zo(t,e,n,r,i){Jo(t,"set",{path:e.toString(),value:n,priority:r});var o=Bo(t),a=jn(n,r),s=qi(t.serverSyncTree_,e),u=io(a,s,o),c=Go(t),h=xi(t.serverSyncTree_,e,u,c,!0);Oo(t.eventQueue_,h),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||ne("set at "+e+" failed: "+n);var a=Mi(t.serverSyncTree_,c,!o);Lo(t.eventQueue_,e,a),Zo(t,i,n,r)}));var l=sa(t,e);na(t,l),Lo(t.eventQueue_,l,[])}function Qo(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&lr(t.onDisconnect_,e),Zo(t,n,r,i)}))}function Yo(t,e,n,r){var i=jn(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&hr(t.onDisconnect_,e,i),Zo(t,r,n,o)}))}function Xo(t,e,n){var r;r=".info"===Ge(e._path)?Ui(t.infoSyncTree_,e,n):Ui(t.serverSyncTree_,e,n),xo(t.eventQueue_,e._path,r)}function $o(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Uo)}function Jo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),Jt.apply(void 0,p([r],f(e)))}function Zo(t,e,n,r){e&&ye((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function ta(t,e,n){return qi(t.serverSyncTree_,e,n)||Fn.EMPTY_NODE}function ea(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||aa(t,e),uo(e)){var n=ia(t,e);y(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=ta(t,e,r),o=i,a=i.hash(),s=0;s<n.length;s++){var u=n[s];y(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=tn(e,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var h=o.val(!0),l=e;t.server_.put(l.toString(),h,(function(r){Jo(t,"transaction put response",{path:l.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(Mi(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);aa(t,so(t.transactionQueueTree_,e)),ea(t,t.transactionQueueTree_),Lo(t.eventQueue_,e,i);for(s=0;s<o.length;s++)ye(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{ne("transaction at "+l.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}na(t,e)}}),a)}(t,po(e),n)}else ho(e)&&lo(e,(function(e){ea(t,e)}))}function na(t,e){var n=ra(t,e),r=po(n);return function(t,e,n){if(0===e.length)return;for(var r=[],i=[],o=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),a=function(a){var s,u,c=e[a],h=tn(n,c.path),l=!1;if(y(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)l=!0,s=c.abortReason,i=i.concat(Mi(t.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)l=!0,s="maxretry",i=i.concat(Mi(t.serverSyncTree_,c.currentWriteId,!0));else{var f=ta(t,c.path,o);c.currentInputSnapshot=f;var p=e[a].update(f.val());if(void 0!==p){To("transaction failed: Data returned ",p,c.path);var d=jn(p);"object"==typeof p&&null!=p&&B(p,".priority")||(d=d.updatePriority(f.getPriority()));var v=c.currentWriteId,g=Bo(t),m=io(d,f,g);c.currentOutputSnapshotRaw=d,c.currentOutputSnapshotResolved=m,c.currentWriteId=Go(t),o.splice(o.indexOf(v),1),i=(i=i.concat(xi(t.serverSyncTree_,c.path,m,c.currentWriteId,c.applyLocally))).concat(Mi(t.serverSyncTree_,v,!0))}else l=!0,s="nodata",i=i.concat(Mi(t.serverSyncTree_,c.currentWriteId,!0))}Lo(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,u=e[a].unwatcher,setTimeout(u,Math.floor(0)),e[a].onComplete&&("nodata"===s?r.push((function(){return e[a].onComplete(null,!1,e[a].currentInputSnapshot)})):r.push((function(){return e[a].onComplete(new Error(s),!1,null)}))))},s=0;s<e.length;s++)a(s);aa(t,t.transactionQueueTree_);for(s=0;s<r.length;s++)ye(r[s]);ea(t,t.transactionQueueTree_)}(t,ia(t,n),r),r}function ra(t,e){var n,r=t.transactionQueueTree_;for(n=Ge(e);null!==n&&void 0===uo(r);)r=so(r,n),n=Ge(e=Qe(e));return r}function ia(t,e){var n=[];return oa(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function oa(t,e,n){var r=uo(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);lo(e,(function(e){oa(t,e,n)}))}function aa(t,e){var n=uo(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,co(e,n.length>0?n:void 0)}lo(e,(function(e){aa(t,e)}))}function sa(t,e){var n=po(ra(t,e)),r=so(t.transactionQueueTree_,e);return function(t,e,n){for(var r=n?t:t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){ua(t,e)})),ua(t,r),fo(r,(function(e){ua(t,e)})),n}function ua(t,e){var n=uo(e);if(n){for(var r=[],i=[],o=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?(y(o===a-1,"All SENT items should be at beginning of queue."),o=a,n[a].status=3,n[a].abortReason="set"):(y(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(Mi(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?co(e,void 0):n.length=o+1,Lo(t.eventQueue_,po(e),i);for(a=0;a<r.length;a++)ye(r[a])}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var ca=function(t,e){var n=ha(t),r=n.namespace;"firebase.com"===n.domain&&ee(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||ee("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ne("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Ce(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new We(n.pathString)}},ha=function(t){var e="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"==typeof t){var c=t.indexOf("//");c>=0&&(s=t.substring(0,c-1),t=t.substring(c+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,f)));var p=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=l(t.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):ne("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(c=e.indexOf(":"))>=0?(a="https"===s||"wss"===s,u=parseInt(e.substring(c+1),10)):c=e.length;var d=e.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in p&&(o=p.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},la=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+q(this.snapshot.exportVal())},t}(),fa=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),pa=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return y(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),da=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new E;return Qo(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){Ao("OnDisconnect.remove",this._path);var t=new E;return Yo(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){Ao("OnDisconnect.set",this._path),Io("OnDisconnect.set",t,this._path,!1);var e=new E;return Yo(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){Ao("OnDisconnect.setWithPriority",this._path),Io("OnDisconnect.setWithPriority",t,this._path,!1),So("OnDisconnect.setWithPriority",e,!1);var n=new E;return function(t,e,n,r,i){var o=jn(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&hr(t.onDisconnect_,e,o),Zo(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){Ao("OnDisconnect.update",this._path),Eo("OnDisconnect.update",t,this._path,!1);var e=new E;return function(t,e,n,r){if(W(n))return Jt("onDisconnect().update() called with empty data.  Don't do anything."),void Zo(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&le(n,(function(n,r){var i=jn(r);hr(t.onDisconnect_,Je(e,n),i)})),Zo(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),va=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return Ze(this._path)?null:Ye(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ba(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=ar(this._queryParams),e=ce(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return ar(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=nt(e))instanceof t))return!1;var n=this._repo===e._repo,r=nn(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function ga(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function ya(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===gn){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ie)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==oe)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Rn){if(null!=e&&!wo(e)||null!=n&&!wo(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(y(t.getIndex()instanceof Bn||t.getIndex()===Kn,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ma(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var ba=function(t){function e(e,n){return t.call(this,e,n,new er,!1)||this}return s(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=$e(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(va),_a=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new We(e),r=Ta(this.ref,e);return new t(this._node.getChild(n),r,Rn)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,Ta(n.ref,r),Rn))}))},t.prototype.hasChild=function(t){var e=new We(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function wa(t,e){return(t=nt(t))._checkNotDeleted("ref"),void 0!==e?Ta(t._root,e):t._root}function Ia(t,e){(t=nt(t))._checkNotDeleted("refFromURL");var n=ca(e,t._repo.repoInfo_.nodeAdmin);Po("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||ee("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),wa(t,n.path.toString())}function Ta(t,e){var n,r,i,o;return null===Ge((t=nt(t))._path)?(n="child",r="path",o=!1,(i=e)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),No(n,r,i,o)):No("child","path",e,!1),new ba(t._repo,Je(t._path,e))}function Ea(t,e){t=nt(t),Ao("push",t._path),Io("push",e,t._path,!0);var n,r=Vo(t._repo),i=Hn(r),o=Ta(t,i),a=Ta(t,i);return n=null!=e?Ca(a,e).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),o}function Sa(t){return Ao("remove",t._path),Ca(t,null)}function Ca(t,e){t=nt(t),Ao("set",t._path),Io("set",e,t._path,!1);var n=new E;return zo(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function ka(t,e){t=nt(t),Ao("setPriority",t._path),So("setPriority",e,!1);var n=new E;return zo(t._repo,Je(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function Na(t,e,n){if(Ao("setWithPriority",t._path),Io("setWithPriority",e,t._path,!1),So("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new E;return zo(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Aa(t,e){Eo("update",e,t._path,!1);var n=new E;return function(t,e,n,r){Jo(t,"update",{path:e.toString(),value:n});var i=!0,o=Bo(t),a={};if(le(n,(function(n,r){i=!1,a[n]=ro(Je(e,n),jn(r),t.serverSyncTree_,o)})),i)Jt("update() called with empty data.  Don't do anything."),Zo(0,r,"ok",void 0);else{var s=Go(t),u=Li(t.serverSyncTree_,e,a,s);Oo(t.eventQueue_,u),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||ne("update at "+e+" failed: "+n);var a=Mi(t.serverSyncTree_,s,!o),u=a.length>0?na(t,e):e;Lo(t.eventQueue_,u,a),Zo(0,r,n,i)})),le(n,(function(n){var r=sa(t,Je(e,n));na(t,r)})),Lo(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function Pa(t){return function(t,e){var n=Vi(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=jn(n).withIndex(e._queryParams.getIndex()),i=Fi(t.serverSyncTree_,e._path,r);return xo(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return Jo(t,"get for query "+q(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=nt(t))._repo,t).then((function(e){return new _a(e,new ba(t._repo,t._path),t._queryParams.getIndex())}))}var Ra=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new la("value",this,new _a(t.snapshotNode,new ba(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new fa(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),Da=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new fa(this,t,e):null},t.prototype.createEvent=function(t,e){y(null!=t.childName,"Child events should have a childName.");var n=Ta(new ba(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new la(t.type,this,new _a(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function Oa(t,e,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){Xo(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new pa(n,o||void 0),c="value"===e?new Ra(u):new Da(e,u);return function(t,e,n){var r;r=".info"===Ge(e._path)?ji(t.infoSyncTree_,e,n):ji(t.serverSyncTree_,e,n),xo(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return Xo(t._repo,t,c)}}function xa(t,e,n,r){return Oa(t,"value",e,n,r)}function La(t,e,n,r){return Oa(t,"child_added",e,n,r)}function Ma(t,e,n,r){return Oa(t,"child_changed",e,n,r)}function Fa(t,e,n,r){return Oa(t,"child_moved",e,n,r)}function Ua(t,e,n,r){return Oa(t,"child_removed",e,n,r)}function ja(t,e,n){var r=null,i=n?new pa(n):null;"value"===e?r=new Ra(i):e&&(r=new Da(e,i)),Xo(t._repo,t,r)}var qa=function(){},Va=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){Io("endAt",this._value,t._path,!0);var e=rr(t._queryParams,this._value,this._key);if(ma(e),ya(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new va(t._repo,t._path,e,t._orderByCalled)},e}(qa);function Ba(t,e){return ko("endAt","key",e,!0),new Va(t,e)}var Ka=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){Io("endBefore",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===gn?("string"==typeof n&&(n=zn(n)),i=rr(e,n,r)):i=rr(e,n,null==r?ie:zn(r)),i.endBeforeSet_=!0,i);if(ma(o),ya(o),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new va(t._repo,t._path,o,t._orderByCalled)},e}(qa);function Wa(t,e){return ko("endBefore","key",e,!0),new Ka(t,e)}var Ha=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){Io("startAt",this._value,t._path,!0);var e=nr(t._queryParams,this._value,this._key);if(ma(e),ya(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new va(t._repo,t._path,e,t._orderByCalled)},e}(qa);function Ga(t,e){return void 0===t&&(t=null),ko("startAt","key",e,!0),new Ha(t,e)}var za=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){Io("startAfter",this._value,t._path,!1);var e=function(t,e,n){var r;t.index_===gn?("string"==typeof e&&(e=Gn(e)),r=nr(t,e,n)):r=nr(t,e,null==n?oe:Gn(n));return r.startAfterSet_=!0,r}(t._queryParams,this._value,this._key);if(ma(e),ya(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new va(t._repo,t._path,e,t._orderByCalled)},e}(qa);function Qa(t,e){return ko("startAfter","key",e,!0),new za(t,e)}var Ya=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return s(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new va(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),t._orderByCalled);var e,n,r},e}(qa);function Xa(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Ya(t)}var $a=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return s(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new va(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),t._orderByCalled);var e,n,r},e}(qa);function Ja(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new $a(t)}var Za=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return s(e,t),e.prototype._apply=function(t){ga(t,"orderByChild");var e=new We(this._path);if(Ze(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new Bn(e),r=ir(t._queryParams,n);return ya(r),new va(t._repo,t._path,r,!0)},e}(qa);function ts(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return No("orderByChild","path",t,!1),new Za(t)}var es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){ga(t,"orderByKey");var e=ir(t._queryParams,gn);return ya(e),new va(t._repo,t._path,e,!0)},e}(qa);function ns(){return new es}var rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){ga(t,"orderByPriority");var e=ir(t._queryParams,Rn);return ya(e),new va(t._repo,t._path,e,!0)},e}(qa);function is(){return new rs}var os=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){ga(t,"orderByValue");var e=ir(t._queryParams,Kn);return ya(e),new va(t._repo,t._path,e,!0)},e}(qa);function as(){return new os}var ss=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){if(Io("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Va(this._value,this._key)._apply(new Ha(this._value,this._key)._apply(t))},e}(qa);function us(t,e){return ko("equalTo","key",e,!0),new ss(t,e)}function cs(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=nt(t);try{for(var a=l(r),s=a.next();!s.done;s=a.next()){var u=s.value;o=u._apply(o)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return o}!function(t){y(!pi,"__referenceConstructor has already been defined"),pi=t}(ba),function(t){y(!_i,"__referenceConstructor has already been defined"),_i=t}(ba);
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var hs={},ls=!1;function fs(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||ee("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Jt("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=ca(o,i),u=s.repoInfo,c=void 0;void 0!==Mt&&(c=Mt.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=ca(o,i)).repoInfo):a=!s.repoInfo.secure;var h=i&&a?new we(we.OWNER):new _e(t.name,t.options,e);Po("Invalid Firebase Database URL",s),Ze(s.path)||ee("Database URL must point to the root of a Firebase Database (not including a child path).");var l=function(t,e,n,r){var i=hs[e.name];i||(i={},hs[e.name]=i);var o=i[t.toURLString()];o&&ee("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new jo(t,ls,n,r),i[t.toURLString()]=o,o}(u,t,h,new be(t.name,n));return new ps(l,t)}var ps=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(qo(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new ba(this._repo,He())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,e=this.app.name,(n=hs[e])&&n[t.key]===t||ee("Database "+e+"("+t.repoInfo_+") has already been deleted."),$o(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&ee("Cannot call "+t+" on a deleted database.")},t}();function ds(t,e,n,r){void 0===r&&(r={}),(t=nt(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&ee("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,o=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ee('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new we(we.OWNER);else if(r.mockUserToken){var a=S(r.mockUserToken,t.app.options.projectId);o=new we(a)}!function(t,e,n,r){t.repoInfo_=new Ce(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(i,e,n,o)}function vs(t){(t=nt(t))._checkNotDeleted("goOffline"),$o(t._repo)}function gs(t){var e;(t=nt(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(Uo)}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var ys={".sv":"timestamp"};
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var ms=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function bs(t,e,n){var r;if(t=nt(t),Ao("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,o=new E,a=xa(t,(function(){}));return function(t,e,n,r,i,o){Jo(t,"transaction on "+e);var a={path:e,update:n,onComplete:r,status:null,order:Gt(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=ta(t,e,void 0);a.currentInputSnapshot=s;var u=a.update(s.val());if(void 0===u)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{To("transaction failed: Data returned ",u,a.path),a.status=0;var c=so(t.transactionQueueTree_,e),h=uo(c)||[];h.push(a),co(c,h);var l=void 0;"object"==typeof u&&null!==u&&B(u,".priority")?(l=K(u,".priority"),y(wo(l),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):l=(qi(t.serverSyncTree_,e)||Fn.EMPTY_NODE).getPriority().val();var f=Bo(t),p=jn(u,l),d=io(p,s,f);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=d,a.currentWriteId=Go(t);var v=xi(t.serverSyncTree_,e,d,a.currentWriteId,a.applyLocally);Lo(t.eventQueue_,e,v),ea(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(function(e,n,r){var i=null;e?o.reject(e):(i=new _a(r,new ba(t._repo,t._path),Rn),o.resolve(new ms(n,i)))}),a,i),o.promise}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var _s=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){X("OnDisconnect.cancel",0,1,arguments.length),J("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){X("OnDisconnect.remove",0,1,arguments.length),J("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){X("OnDisconnect.set",1,2,arguments.length),J("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){X("OnDisconnect.setWithPriority",2,3,arguments.length),J("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if(X("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,ne("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}J("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),ws=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return X("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Is=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return X("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return X("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return X("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return X("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return X("DataSnapshot.child",0,1,arguments.length),e=String(e),No("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return X("DataSnapshot.hasChild",1,1,arguments.length),No("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return X("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return X("DataSnapshot.forEach",1,1,arguments.length),J("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return X("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return X("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return X("DataSnapshot.ref",0,0,arguments.length),new Es(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Ts=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var o,a=this;X("Query.on",2,4,arguments.length),J("Query.on","callback",n,!1);var s=t.getCancelAndContextArgs_("Query.on",r,i),u=function(t,e){n.call(s.context,new Is(a.database,t),e)};u.userCallback=n,u.context=s.context;var c=null===(o=s.cancel)||void 0===o?void 0:o.bind(s.context);switch(e){case"value":return xa(this._delegate,u,c),n;case"child_added":return La(this._delegate,u,c),n;case"child_removed":return Ua(this._delegate,u,c),n;case"child_changed":return Ma(this._delegate,u,c),n;case"child_moved":return Fa(this._delegate,u,c),n;default:throw new Error($("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if(X("Query.off",0,3,arguments.length),Co("Query.off",t,!0),J("Query.off","callback",e,!0),Z("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,ja(this._delegate,t,r)}else ja(this._delegate,t)},t.prototype.get=function(){var t=this;return Pa(this._delegate).then((function(e){return new Is(t.database,e)}))},t.prototype.once=function(e,n,r,i){var o=this;X("Query.once",1,4,arguments.length),J("Query.once","callback",n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),s=new E,u=function(t,e){var r=new Is(o.database,t);n&&n.call(a.context,r,e),s.resolve(r)};u.userCallback=n,u.context=a.context;var c=function(t){a.cancel&&a.cancel.call(a.context,t),s.reject(t)};switch(e){case"value":xa(this._delegate,u,c,{onlyOnce:!0});break;case"child_added":La(this._delegate,u,c,{onlyOnce:!0});break;case"child_removed":Ua(this._delegate,u,c,{onlyOnce:!0});break;case"child_changed":Ma(this._delegate,u,c,{onlyOnce:!0});break;case"child_moved":Fa(this._delegate,u,c,{onlyOnce:!0});break;default:throw new Error($("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise},t.prototype.limitToFirst=function(e){return X("Query.limitToFirst",1,1,arguments.length),new t(this.database,cs(this._delegate,Xa(e)))},t.prototype.limitToLast=function(e){return X("Query.limitToLast",1,1,arguments.length),new t(this.database,cs(this._delegate,Ja(e)))},t.prototype.orderByChild=function(e){return X("Query.orderByChild",1,1,arguments.length),new t(this.database,cs(this._delegate,ts(e)))},t.prototype.orderByKey=function(){return X("Query.orderByKey",0,0,arguments.length),new t(this.database,cs(this._delegate,ns()))},t.prototype.orderByPriority=function(){return X("Query.orderByPriority",0,0,arguments.length),new t(this.database,cs(this._delegate,is()))},t.prototype.orderByValue=function(){return X("Query.orderByValue",0,0,arguments.length),new t(this.database,cs(this._delegate,as()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),X("Query.startAt",0,2,arguments.length),new t(this.database,cs(this._delegate,Ga(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),X("Query.startAfter",0,2,arguments.length),new t(this.database,cs(this._delegate,Qa(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),X("Query.endAt",0,2,arguments.length),new t(this.database,cs(this._delegate,Ba(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),X("Query.endBefore",0,2,arguments.length),new t(this.database,cs(this._delegate,Wa(e,n)))},t.prototype.equalTo=function(e,n){return X("Query.equalTo",1,2,arguments.length),new t(this.database,cs(this._delegate,us(e,n)))},t.prototype.toString=function(){return X("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return X("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if(X("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,J(t,"cancel",r.cancel,!0),r.context=n,Z(t,"context",r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error($(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Es(this.database,new ba(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Es=function(t){function e(e,n){var r=t.call(this,e,new va(n._repo,n._path,new er,!1))||this;return r.database=e,r._delegate=n,r}return s(e,t),e.prototype.getKey=function(){return X("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return X("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,Ta(this._delegate,t))},e.prototype.getParent=function(){X("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return X("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){X("Reference.set",1,2,arguments.length),J("Reference.set","onComplete",e,!0);var n=Ca(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if(X("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,ne("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ao("Reference.update",this._delegate._path),J("Reference.update","onComplete",e,!0);var i=Aa(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){X("Reference.setWithPriority",2,3,arguments.length),J("Reference.setWithPriority","onComplete",n,!0);var r=Na(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){X("Reference.remove",0,1,arguments.length),J("Reference.remove","onComplete",t,!0);var e=Sa(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;X("Reference.transaction",1,3,arguments.length),J("Reference.transaction","transactionUpdate",t,!1),J("Reference.transaction","onComplete",e,!0),Ro("Reference.transaction","applyLocally",n,!0);var i=bs(this._delegate,t,{applyLocally:n}).then((function(t){return new ws(t.committed,new Is(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){X("Reference.setPriority",1,2,arguments.length),J("Reference.setPriority","onComplete",e,!0);var n=ka(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;X("Reference.push",0,2,arguments.length),J("Reference.push","onComplete",n,!0);var i=Ea(this._delegate,t),o=i.then((function(t){return new e(r.database,t)}));n&&o.then((function(){return n(null)}),(function(t){return n(t)}));var a=new e(this.database,i);return a.then=o.then.bind(o),a.catch=o.catch.bind(o,void 0),a},e.prototype.onDisconnect=function(){return Ao("Reference.onDisconnect",this._delegate._path),new _s(new da(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Ts),Ss=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),ds(this._delegate,t,e,n)},t.prototype.ref=function(t){if(X("database.ref",0,1,arguments.length),t instanceof Es){var e=Ia(this._delegate,t.toString());return new Es(this,e)}e=wa(this._delegate,t);return new Es(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";X(e,1,1,arguments.length);var n=Ia(this._delegate,t);return new Es(this,n)},t.prototype.goOffline=function(){return X("database.goOffline",0,0,arguments.length),vs(this._delegate)},t.prototype.goOnline=function(){return X("database.goOnline",0,0,arguments.length),gs(this._delegate)},t.ServerValue={TIMESTAMP:ys,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Cs=Object.freeze({__proto__:null,forceLongPolling:function(){Ue.forceDisallow(),Le.forceAllow()},forceWebSockets:function(){Le.forceDisallow()},isWebSocketsAvailable:function(){return Ue.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new vr(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);le(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n,r;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */t.stats_.incrementCounter(e),n=t.statsReporter_,r=e,n.statsToReport_[r]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,i=t.customAuthImpl,o=t.namespace,a=t.nodeAdmin,s=void 0!==a&&a;Ut(r);var u=new ot("auth-internal",new st("database-standalone"));return u.setComponent(new rt("auth-internal",(function(){return i}),"PRIVATE")),{instance:new Ss(fs(e,u,void 0,n,s),e),namespace:o}}}),ks=fn;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */fn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},fn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Ns=qe,As=Ce,Ps=Object.freeze({__proto__:null,DataConnection:ks,RealTimeConnection:Ns,hijackHash:function(t){var e=fn.prototype.put;return fn.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){fn.prototype.put=e}},ConnectionTarget:As,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){ls=t}(t)}}),Rs=Ss.ServerValue;!function(t){Ut(t.SDK_VERSION);var e=t.INTERNAL.registerComponent(new rt("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Ss(fs(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Es,Query:Ts,Database:Ss,DataSnapshot:Is,enableLogging:$t,INTERNAL:Cs,ServerValue:Rs,TEST_ACCESS:Ps}).setMultipleInstances(!0));t.registerVersion("@firebase/database","0.10.7"),R()&&($c3dc2c70c292881adc144d86adaedde9$exports=e)}(Lt);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ******************************************************************************/
var Ds=function(t,e){return(Ds=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Os(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var xs,Ls="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},Ms=Ms||{},Fs=Ls||self;function Us(){}function js(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function qs(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Vs="closure_uid_"+(1e9*Math.random()>>>0),Bs=0;function Ks(t,e,n){return t.call.apply(t.bind,arguments)}function Ws(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Hs(t,e,n){return(Hs=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ks:Ws).apply(null,arguments)}function Gs(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function zs(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Qs(){this.s=this.s,this.o=this.o}var Ys={};Qs.prototype.s=!1,Qs.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Vs)&&t[Vs]||(t[Vs]=++Bs)}(this);delete Ys[t]}},Qs.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Xs=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},$s=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Js(t){return Array.prototype.concat.apply([],arguments)}function Zs(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function tu(t){return/^[\s\xa0]*$/.test(t)}var eu,nu=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ru(t,e){return-1!=t.indexOf(e)}function iu(t,e){return t<e?-1:t>e?1:0}t:{var ou=Fs.navigator;if(ou){var au=ou.userAgent;if(au){eu=au;break t}}eu=""}function su(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function uu(t){var e={};for(var n in t)e[n]=t[n];return e}var cu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function hu(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<cu.length;o++)n=cu[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lu(t){return lu[" "](t),t}lu[" "]=Us;var fu,pu=ru(eu,"Opera"),du=ru(eu,"Trident")||ru(eu,"MSIE"),vu=ru(eu,"Edge"),gu=vu||du,yu=ru(eu,"Gecko")&&!(ru(eu.toLowerCase(),"webkit")&&!ru(eu,"Edge"))&&!(ru(eu,"Trident")||ru(eu,"MSIE"))&&!ru(eu,"Edge"),mu=ru(eu.toLowerCase(),"webkit")&&!ru(eu,"Edge");function bu(){var t=Fs.document;return t?t.documentMode:void 0}t:{var _u="",wu=function(){var t=eu;return yu?/rv:([^\);]+)(\)|;)/.exec(t):vu?/Edge\/([\d\.]+)/.exec(t):du?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):mu?/WebKit\/(\S+)/.exec(t):pu?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(wu&&(_u=wu?wu[1]:""),du){var Iu=bu();if(null!=Iu&&Iu>parseFloat(_u)){fu=String(Iu);break t}}fu=_u}var Tu,Eu={};function Su(){return function(t){var e=Eu;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=nu(String(fu)).split("."),n=nu("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;t=iu(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||iu(0==o[2].length,0==a[2].length)||iu(o[2],a[2]),o=o[3],a=a[3]}while(0==t)}return 0<=t}))}if(Fs.document&&du){var Cu=bu();Tu=Cu||(parseInt(fu,10)||void 0)}else Tu=void 0;var ku=Tu,Nu=function(){if(!Fs.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Fs.addEventListener("test",Us,e),Fs.removeEventListener("test",Us,e)}catch(t){}return t}();function Au(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Pu(t,e){if(Au.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(yu){t:{try{lu(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ru[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Pu.Z.h.call(this)}}Au.prototype.h=function(){this.defaultPrevented=!0},zs(Pu,Au);var Ru={2:"touch",3:"pen",4:"mouse"};Pu.prototype.h=function(){Pu.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Du="closure_listenable_"+(1e6*Math.random()|0),Ou=0;function xu(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Ou,this.ca=this.fa=!1}function Lu(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Mu(t){this.src=t,this.g={},this.h=0}function Fu(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=Xs(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Lu(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Uu(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Mu.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var a=Uu(t,e,r,i);return-1<a?(e=t[a],n||(e.fa=!1)):((e=new xu(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var ju="closure_lm_"+(1e6*Math.random()|0),qu={};function Vu(t,e,n,r,i){if(r&&r.once)return Ku(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vu(t,e[o],n,r,i);return null}return n=Xu(n),t&&t[Du]?t.N(e,n,qs(r)?!!r.capture:!!r,i):Bu(t,e,n,!1,r,i)}function Bu(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=qs(i)?!!i.capture:!!i,s=Qu(t);if(s||(t[ju]=s=new Mu(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=zu;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Nu||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Gu(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ku(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ku(t,e[o],n,r,i);return null}return n=Xu(n),t&&t[Du]?t.O(e,n,qs(r)?!!r.capture:!!r,i):Bu(t,e,n,!0,r,i)}function Wu(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Wu(t,e[o],n,r,i);else r=qs(r)?!!r.capture:!!r,n=Xu(n),t&&t[Du]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Uu(o=t.g[e],n,r,i))&&(Lu(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Qu(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Uu(e,n,r,i)),(n=-1<t?e[t]:null)&&Hu(n))}function Hu(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Du])Fu(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Gu(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Qu(e))?(Fu(n,t),0==n.h&&(n.src=null,e[ju]=null)):Lu(t)}}}function Gu(t){return t in qu?qu[t]:qu[t]="on"+t}function zu(t,e){if(t.ca)t=!0;else{e=new Pu(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Hu(t),t=n.call(r,e)}return t}function Qu(t){return(t=t[ju])instanceof Mu?t:null}var Yu="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xu(t){return"function"==typeof t?t:(t[Yu]||(t[Yu]=function(e){return t.handleEvent(e)}),t[Yu])}function $u(){Qs.call(this),this.i=new Mu(this),this.P=this,this.I=null}function Ju(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Au(e,t);else if(e instanceof Au)e.target=e.target||t;else{var i=e;hu(e=new Au(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.g=n[o];i=Zu(a,r,!0,e)&&i}if(i=Zu(a=e.g=t,r,!0,e)&&i,i=Zu(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Zu(a=e.g=n[o],r,!1,e)&&i}function Zu(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ca&&a.capture==n){var s=a.listener,u=a.ia||a.src;a.fa&&Fu(t.i,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}zs($u,Qs),$u.prototype[Du]=!0,$u.prototype.removeEventListener=function(t,e,n,r){Wu(this,t,e,n,r)},$u.prototype.M=function(){if($u.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Lu(n[r]);delete e.g[t],e.h--}}this.I=null},$u.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},$u.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var tc=Fs.JSON.stringify;function ec(){var t=cc,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var nc,rc=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=ic.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),ic=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new oc}),(function(t){return t.reset()})),oc=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function ac(t){Fs.setTimeout((function(){throw t}),0)}function sc(t,e){nc||function(){var t=Fs.Promise.resolve(void 0);nc=function(){t.then(hc)}}(),uc||(nc(),uc=!0),cc.add(t,e)}var uc=!1,cc=new rc;function hc(){for(var t;t=ec();){try{t.h.call(t.g)}catch(t){ac(t)}var e=ic;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}uc=!1}function lc(t,e){$u.call(this),this.h=t||1,this.g=e||Fs,this.j=Hs(this.kb,this),this.l=Date.now()}function fc(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function pc(t,e,n){if("function"==typeof t)n&&(t=Hs(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Hs(t.handleEvent,t)}return 2147483647<Number(e)?-1:Fs.setTimeout(t,e||0)}function dc(t){t.g=pc((function(){t.g=null,t.i&&(t.i=!1,dc(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}zs(lc,$u),(xs=lc.prototype).da=!1,xs.S=null,xs.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Ju(this,"tick"),this.da&&(fc(this),this.start()))}},xs.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},xs.M=function(){lc.Z.M.call(this),fc(this),delete this.g};var vc=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ds(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:dc(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Fs.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(Qs);function gc(t){Qs.call(this),this.h=t,this.g={}}zs(gc,Qs);var yc=[];function mc(t,e,n,r){Array.isArray(n)||(n&&(yc[0]=n.toString()),n=yc);for(var i=0;i<n.length;i++){var o=Vu(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function bc(t){su(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Hu(t)}),t),t.g={}}function _c(){this.g=!0}function wc(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return tc(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}gc.prototype.M=function(){gc.Z.M.call(this),bc(this)},gc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},_c.prototype.Aa=function(){this.g=!1},_c.prototype.info=function(){};var Ic={},Tc=null;function Ec(){return Tc=Tc||new $u}function Sc(t){Au.call(this,Ic.Ma,t)}function Cc(t){var e=Ec();Ju(e,new Sc(e,t))}function kc(t,e){Au.call(this,Ic.STAT_EVENT,t),this.stat=e}function Nc(t){var e=Ec();Ju(e,new kc(e,t))}function Ac(t,e){Au.call(this,Ic.Na,t),this.size=e}function Pc(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Fs.setTimeout((function(){t()}),e)}Ic.Ma="serverreachability",zs(Sc,Au),Ic.STAT_EVENT="statevent",zs(kc,Au),Ic.Na="timingevent",zs(Ac,Au);var Rc={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Dc={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Oc(){}function xc(t){return t.h||(t.h=t.i())}function Lc(){}Oc.prototype.h=null;var Mc,Fc={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Uc(){Au.call(this,"d")}function jc(){Au.call(this,"c")}function qc(){}function Vc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new gc(this),this.P=Kc,t=gu?125:void 0,this.W=new lc(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Bc}function Bc(){this.i=null,this.g="",this.h=!1}zs(Uc,Au),zs(jc,Au),zs(qc,Oc),qc.prototype.g=function(){return new XMLHttpRequest},qc.prototype.i=function(){return{}},Mc=new qc;var Kc=45e3,Wc={},Hc={};function Gc(t,e,n){t.K=1,t.v=vh(ch(e)),t.s=n,t.U=!0,zc(t,null)}function zc(t,e){t.F=Date.now(),$c(t),t.A=ch(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Nh(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Bc,t.g=Al(t.l,n?e:null,!t.s),0<t.O&&(t.L=new vc(Hs(t.Ia,t,t.g),t.O)),mc(t.V,t.g,"readystatechange",t.gb),e=t.H?uu(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Cc(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");a=2<=l.length&&"type"==l[1]?a+(h+"=")+c+"&":a+(h+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Qc(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Yc(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Xc(t,n))==Hc){4==e&&(t.o=4,Nc(14),i=!1),wc(t.j,t.m,null,"[Incomplete Response]");break}if(r==Wc){t.o=4,Nc(15),wc(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}wc(t.j,t.m,r,null),nh(t,r)}Qc(t)&&r!=Hc&&r!=Wc&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Nc(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),wl(e),e.L=!0,Nc(11))):(wc(t.j,t.m,n,"[Invalid Chunked Response]"),eh(t),th(t))}function Xc(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Hc:(n=Number(e.substring(n,r)),isNaN(n)?Wc:(r+=1)+n>e.length?Hc:(e=e.substr(r,n),t.C=r+n,e))}function $c(t){t.Y=Date.now()+t.P,Jc(t,t.P)}function Jc(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Pc(Hs(t.eb,t),e)}function Zc(t){t.B&&(Fs.clearTimeout(t.B),t.B=null)}function th(t){0==t.l.G||t.I||El(t.l,t)}function eh(t){Zc(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,fc(t.W),bc(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function nh(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Lh(n.i,t)))if(n.I=t.N,!t.J&&Lh(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Tl(n),fl(n)}_l(n),Nc(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Pc(Hs(n.ab,n),6e3));if(1>=xh(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Cl(n,11)}else if((t.J||n.g==t)&&Tl(n),!tu(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var a=o[3];null!=a&&(n.ma=a,n.h.info("VER="+n.ma));var s=o[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(ru(h,"spdy")||ru(h,"quic")||ru(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Mh(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,dh(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=Nl(r,r.H?r.la:null,r.W),p.J){Fh(r.i,p);var d=p,v=r.K;v&&d.setTimeout(v),d.B&&(Zc(d),$c(d)),r.g=p}else bl(r);0<n.l.length&&vl(n)}else"stop"!=o[0]&&"close"!=o[0]||Cl(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Cl(n,7):ll(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Cc(4)}catch(o){}}function rh(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(js(t)||"string"==typeof t)$s(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(js(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(js(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ih(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ih)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function oh(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ah(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ah(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ah(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(xs=Vc.prototype).setTimeout=function(t){this.P=t},xs.gb=function(t){t=t.target;var e=this.L;e&&3==al(t)?e.l():this.Ia(t)},xs.Ia=function(t){try{if(t==this.g)t:{var e=al(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||gu||this.g&&(this.h.h||this.g.ga()||sl(this.g)))){this.I||4!=e||7==n||Cc(8==n||0>=r?3:2),Zc(this);var i=this.g.ba();this.N=i;e:if(Qc(this)){var o=sl(this.g);t="";var a=o.length,s=4==al(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){eh(this),th(this);var u="";break e}this.h.i=new Fs.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:s&&n==a-1});o.splice(0,a),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!tu(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Nc(12),eh(this),th(this);break t}wc(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,nh(this,i)}this.U?(Yc(this,e,u),gu&&this.i&&3==e&&(mc(this.V,this.W,"tick",this.fb),this.W.start())):(wc(this.j,this.m,u,null),nh(this,u)),4==e&&eh(this),this.i&&!this.I&&(4==e?El(this.l,this):(this.i=!1,$c(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Nc(12)):(this.o=0,Nc(13)),eh(this),th(this)}}}catch(e){}},xs.fb=function(){if(this.g){var t=al(this.g),e=this.g.ga();this.C<e.length&&(Zc(this),Yc(this,t,e),this.i&&4!=t&&$c(this))}},xs.cancel=function(){this.I=!0,eh(this)},xs.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Cc(3),Nc(17)),eh(this),this.o=2,th(this)):Jc(this,this.Y-t)},(xs=ih.prototype).R=function(){oh(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},xs.T=function(){return oh(this),this.g.concat()},xs.get=function(t,e){return ah(this.h,t)?this.h[t]:e},xs.set=function(t,e){ah(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},xs.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var sh=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function uh(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof uh){this.g=void 0!==e?e:t.g,hh(this,t.j),this.s=t.s,lh(this,t.i),fh(this,t.m),this.l=t.l,e=t.h;var n=new Eh;n.i=e.i,e.g&&(n.g=new ih(e.g),n.h=e.h),ph(this,n),this.o=t.o}else t&&(n=String(t).match(sh))?(this.g=!!e,hh(this,n[1]||"",!0),this.s=gh(n[2]||""),lh(this,n[3]||"",!0),fh(this,n[4]),this.l=gh(n[5]||"",!0),ph(this,n[6]||"",!0),this.o=gh(n[7]||"")):(this.g=!!e,this.h=new Eh(null,this.g))}function ch(t){return new uh(t)}function hh(t,e,n){t.j=n?gh(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function lh(t,e,n){t.i=n?gh(e,!0):e}function fh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ph(t,e,n){e instanceof Eh?(t.h=e,function(t,e){e&&!t.j&&(Sh(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ch(this,e),Nh(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=yh(e,Ih)),t.h=new Eh(e,t.g))}function dh(t,e,n){t.h.set(e,n)}function vh(t){return dh(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function gh(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function yh(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,mh),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function mh(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}uh.prototype.toString=function(){var t=[],e=this.j;e&&t.push(yh(e,bh,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(yh(e,bh,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(yh(n,"/"==n.charAt(0)?wh:_h,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",yh(n,Th)),t.join("")};var bh=/[#\/\?@]/g,_h=/[#\?:]/g,wh=/[#\?]/g,Ih=/[#\?@]/g,Th=/#/g;function Eh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Sh(t){t.g||(t.g=new ih,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ch(t,e){Sh(t),e=Ah(t,e),ah(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ah((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&oh(t)))}function kh(t,e){return Sh(t),e=Ah(t,e),ah(t.g.h,e)}function Nh(t,e,n){Ch(t,e),0<n.length&&(t.i=null,t.g.set(Ah(t,e),Zs(n)),t.h+=n.length)}function Ah(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(xs=Eh.prototype).add=function(t,e){Sh(this),this.i=null,t=Ah(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},xs.forEach=function(t,e){Sh(this),this.g.forEach((function(n,r){$s(n,(function(n){t.call(e,n,r,this)}),this)}),this)},xs.T=function(){Sh(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},xs.R=function(t){Sh(this);var e=[];if("string"==typeof t)kh(this,t)&&(e=Js(e,this.g.get(Ah(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Js(e,t[n])}return e},xs.set=function(t,e){return Sh(this),this.i=null,kh(this,t=Ah(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},xs.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},xs.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.i=t.join("&")};var Ph=function(t,e){this.h=t,this.g=e};function Rh(t){this.l=t||Dh,Fs.PerformanceNavigationTiming?t=0<(t=Fs.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Fs.g&&Fs.g.Ea&&Fs.g.Ea()&&Fs.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Dh=10;function Oh(t){return!!t.h||!!t.g&&t.g.size>=t.j}function xh(t){return t.h?1:t.g?t.g.size:0}function Lh(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Mh(t,e){t.g?t.g.add(e):t.h=e}function Fh(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Uh(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Os(t.g.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Zs(t.i)}function jh(){}function qh(){this.g=new jh}function Vh(t,e,n){var r=n||"";try{rh(t,(function(t,n){var i=t;qs(t)&&(i=tc(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Bh(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Kh(t){this.l=t.$b||null,this.j=t.ib||!1}function Wh(t,e){$u.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Hh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Rh.prototype.cancel=function(){var t,e;if(this.i=Uh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Os(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},jh.prototype.stringify=function(t){return Fs.JSON.stringify(t,void 0)},jh.prototype.parse=function(t){return Fs.JSON.parse(t,void 0)},zs(Kh,Oc),Kh.prototype.g=function(){return new Wh(this.l,this.j)},Kh.prototype.i=function(t){return function(){return t}}({}),zs(Wh,$u);var Hh=0;function Gh(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function zh(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Qh(t)}function Qh(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(xs=Wh.prototype).open=function(t,e){if(this.readyState!=Hh)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Qh(this)},xs.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Fs).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},xs.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,zh(this)),this.readyState=Hh},xs.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Qh(this)),this.g&&(this.readyState=3,Qh(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Fs.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Gh(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},xs.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?zh(this):Qh(this),3==this.readyState&&Gh(this)}},xs.Ua=function(t){this.g&&(this.response=this.responseText=t,zh(this))},xs.Ta=function(t){this.g&&(this.response=t,zh(this))},xs.ha=function(){this.g&&zh(this)},xs.setRequestHeader=function(t,e){this.v.append(t,e)},xs.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},xs.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Wh.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Yh=Fs.JSON.parse;function Xh(t){$u.call(this),this.headers=new ih,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=$h,this.K=this.L=!1}zs(Xh,$u);var $h="",Jh=/^https?$/i,Zh=["POST","PUT"];function tl(t){return"content-type"==t.toLowerCase()}function el(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,nl(t),il(t)}function nl(t){t.D||(t.D=!0,Ju(t,"complete"),Ju(t,"error"))}function rl(t){if(t.h&&void 0!==Ms&&(!t.C[1]||4!=al(t)||2!=t.ba()))if(t.v&&4==al(t))pc(t.Fa,0,t);else if(Ju(t,"readystatechange"),4==al(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(sh)[1]||null;if(!o&&Fs.self&&Fs.self.location){var a=Fs.self.location.protocol;o=a.substr(0,a.length-1)}i=!Jh.test(o?o.toLowerCase():"")}e=i}if(e)Ju(t,"complete"),Ju(t,"success");else{t.m=6;try{var s=2<al(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.ba()+"]",nl(t)}}finally{il(t)}}}function il(t,e){if(t.g){ol(t);var n=t.g,r=t.C[0]?Us:null;t.g=null,t.C=null,e||Ju(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function ol(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Fs.clearTimeout(t.A),t.A=null)}function al(t){return t.g?t.g.readyState:0}function sl(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case $h:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ul(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return su(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):dh(t,e,n))}function cl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function hl(t){this.za=0,this.l=[],this.h=new _c,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=cl("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=cl("baseRetryDelayMs",5e3,t),this.$a=cl("retryDelaySeedMs",1e4,t),this.Ya=cl("forwardChannelMaxRetries",2,t),this.ra=cl("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Rh(t&&t.concurrentRequestLimit),this.Ca=new qh,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function ll(t){if(pl(t),3==t.G){var e=t.V++,n=ch(t.F);dh(n,"SID",t.J),dh(n,"RID",e),dh(n,"TYPE","terminate"),yl(t,n),(e=new Vc(t,t.h,e,void 0)).K=2,e.v=vh(ch(n)),n=!1,Fs.navigator&&Fs.navigator.sendBeacon&&(n=Fs.navigator.sendBeacon(e.v.toString(),"")),!n&&Fs.Image&&((new Image).src=e.v,n=!0),n||(e.g=Al(e.l,null),e.g.ea(e.v)),e.F=Date.now(),$c(e)}kl(t)}function fl(t){t.g&&(wl(t),t.g.cancel(),t.g=null)}function pl(t){fl(t),t.u&&(Fs.clearTimeout(t.u),t.u=null),Tl(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Fs.clearTimeout(t.m),t.m=null)}function dl(t,e){t.l.push(new Ph(t.Za++,e)),3==t.G&&vl(t)}function vl(t){Oh(t.i)||t.m||(t.m=!0,sc(t.Ha,t),t.C=0)}function gl(t,e){var n;n=e?e.m:t.V++;var r=ch(t.F);dh(r,"SID",t.J),dh(r,"RID",n),dh(r,"AID",t.U),yl(t,r),t.o&&t.s&&ul(r,t.o,t.s),n=new Vc(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ml(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Mh(t.i,n),Gc(n,r,e)}function yl(t,e){t.j&&rh({},(function(t,n){dh(e,n,t)}))}function ml(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Hs(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].h,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),s=!1;else try{Vh(h,a,"req"+c+"_")}catch(t){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function bl(t){t.g||t.u||(t.Y=1,sc(t.Ga,t),t.A=0)}function _l(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Pc(Hs(t.Ga,t),Sl(t,t.A)),t.A++,!0)}function wl(t){null!=t.B&&(Fs.clearTimeout(t.B),t.B=null)}function Il(t){t.g=new Vc(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=ch(t.oa);dh(e,"RID","rpc"),dh(e,"SID",t.J),dh(e,"CI",t.N?"0":"1"),dh(e,"AID",t.U),yl(t,e),dh(e,"TYPE","xmlhttp"),t.o&&t.s&&ul(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=vh(ch(e)),n.s=null,n.U=!0,zc(n,t)}function Tl(t){null!=t.v&&(Fs.clearTimeout(t.v),t.v=null)}function El(t,e){var n=null;if(t.g==e){Tl(t),wl(t),t.g=null;var r=2}else{if(!Lh(t.i,e))return;n=e.D,Fh(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Ju(r=Ec(),new Ac(r,n,e,i)),vl(t)}else bl(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(xh(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Pc(Hs(t.Ha,t,e),Sl(t,t.C)),t.C++,0)))}(t,e)||2==r&&_l(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Cl(t,5);break;case 4:Cl(t,10);break;case 3:Cl(t,6);break;default:Cl(t,2)}}function Sl(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Cl(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Hs(t.jb,t);n||(n=new uh("//www.google.com/images/cleardot.gif"),Fs.location&&"http"==Fs.location.protocol||hh(n,"https"),vh(n)),function(t,e){var n=new _c;if(Fs.Image){var r=new Image;r.onload=Gs(Bh,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Gs(Bh,n,r,"TestLoadImage: error",!1,e),r.onabort=Gs(Bh,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Gs(Bh,n,r,"TestLoadImage: timeout",!1,e),Fs.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Nc(2);t.G=0,t.j&&t.j.va(e),kl(t),pl(t)}function kl(t){t.G=0,t.I=-1,t.j&&(0==Uh(t.i).length&&0==t.l.length||(t.i.i.length=0,Zs(t.l),t.l.length=0),t.j.ua())}function Nl(t,e,n){var r=function(t){return t instanceof uh?ch(t):new uh(t,void 0)}(n);if(""!=r.i)e&&lh(r,e+"."+r.i),fh(r,r.m);else{var i=Fs.location;r=function(t,e,n,r){var i=new uh(null,void 0);return t&&hh(i,t),e&&lh(i,e),n&&fh(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&su(t.aa,(function(t,e){dh(r,e,t)})),e=t.D,n=t.sa,e&&n&&dh(r,e,n),dh(r,"VER",t.ma),yl(t,r),r}function Al(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Xh(new Kh({ib:!0})):new Xh(t.qa)).L=t.H,e}function Pl(){}function Rl(){if(du&&!(10<=Number(ku)))throw Error("Environmental error: no available transport.")}function Dl(t,e){$u.call(this),this.g=new hl(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!tu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!tu(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Ll(this)}function Ol(t){Uc.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function xl(){jc.call(this),this.status=1}function Ll(t){this.g=t}(xs=Xh.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Mc.g(),this.C=this.u?xc(this.u):xc(Mc),this.g.onreadystatechange=Hs(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void el(this,t)}t=n||"";var i=new ih(this.headers);r&&rh(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=tl,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Fs.FormData&&t instanceof Fs.FormData,!(0<=Xs(Zh,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ol(this),0<this.B&&((this.K=function(t){return du&&Su()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Hs(this.pa,this)):this.A=pc(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){el(this,t)}},xs.pa=function(){void 0!==Ms&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ju(this,"timeout"),this.abort(8))},xs.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ju(this,"complete"),Ju(this,"abort"),il(this))},xs.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),il(this,!0)),Xh.Z.M.call(this)},xs.Fa=function(){this.s||(this.F||this.v||this.l?rl(this):this.cb())},xs.cb=function(){rl(this)},xs.ba=function(){try{return 2<al(this)?this.g.status:-1}catch(t){return-1}},xs.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},xs.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Yh(e)}},xs.Da=function(){return this.m},xs.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(xs=hl.prototype).ma=8,xs.G=1,xs.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},xs.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Vc(this,this.h,t,void 0),n=this.s;if(this.P&&(n?hu(n=uu(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=ml(this,e,r),dh(i=ch(this.F),"RID",t),dh(i,"CVER",22),this.D&&dh(i,"X-HTTP-Session-Id",this.D),yl(this,i),this.o&&n&&ul(i,this.o,n),Mh(this.i,e),this.Ra&&dh(i,"TYPE","init"),this.ja?(dh(i,"$req",r),dh(i,"SID","null"),e.$=!0,Gc(e,i,null)):Gc(e,i,r),this.G=2}}else 3==this.G&&(t?gl(this,t):0==this.l.length||Oh(this.i)||gl(this))},xs.Ga=function(){if(this.u=null,Il(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Pc(Hs(this.bb,this),t)}},xs.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Nc(10),fl(this),Il(this))},xs.ab=function(){null!=this.v&&(this.v=null,fl(this),_l(this),Nc(19))},xs.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Nc(2)):(this.h.info("Failed to ping google.com"),Nc(1))},(xs=Pl.prototype).xa=function(){},xs.wa=function(){},xs.va=function(){},xs.ua=function(){},xs.Oa=function(){},Rl.prototype.g=function(t,e){return new Dl(t,e)},zs(Dl,$u),Dl.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),sc(Hs(t.hb,t,e))),Nc(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Nl(t,null,t.W),vl(t)},Dl.prototype.close=function(){ll(this.g)},Dl.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,dl(this.g,e)}else this.v?((e={}).__data__=tc(t),dl(this.g,e)):dl(this.g,t)},Dl.prototype.M=function(){this.g.j=null,delete this.j,ll(this.g),delete this.g,Dl.Z.M.call(this)},zs(Ol,Uc),zs(xl,jc),zs(Ll,Pl),Ll.prototype.xa=function(){Ju(this.g,"a")},Ll.prototype.wa=function(t){Ju(this.g,new Ol(t))},Ll.prototype.va=function(t){Ju(this.g,new xl(t))},Ll.prototype.ua=function(){Ju(this.g,"b")},Rl.prototype.createWebChannel=Rl.prototype.g,Dl.prototype.send=Dl.prototype.u,Dl.prototype.open=Dl.prototype.m,Dl.prototype.close=Dl.prototype.close,Rc.NO_ERROR=0,Rc.TIMEOUT=8,Rc.HTTP_ERROR=6,Dc.COMPLETE="complete",Lc.EventType=Fc,Fc.OPEN="a",Fc.CLOSE="b",Fc.ERROR="c",Fc.MESSAGE="d",$u.prototype.listen=$u.prototype.N,Xh.prototype.listenOnce=Xh.prototype.O,Xh.prototype.getLastError=Xh.prototype.La,Xh.prototype.getLastErrorCode=Xh.prototype.Da,Xh.prototype.getStatus=Xh.prototype.ba,Xh.prototype.getResponseJson=Xh.prototype.Qa,Xh.prototype.getResponseText=Xh.prototype.ga,Xh.prototype.send=Xh.prototype.ea;var Ml=function(){return new Rl},Fl=function(){return Ec()},Ul=Rc,jl=Dc,ql=Ic,Vl={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Bl=Kh,Kl=Lc,Wl=Xh,Hl=r(),Gl=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Gl.o=-1;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var zl={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ql=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return s(e,t),e}(Error),Yl=new yt("@firebase/firestore");function Xl(){return Yl.logLevel}function $l(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yl.logLevel<=ct.DEBUG){var r=e.map(tf);Yl.debug.apply(Yl,p(["Firestore (8.7.0): "+t],r))}}function Jl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yl.logLevel<=ct.ERROR){var r=e.map(tf);Yl.error.apply(Yl,p(["Firestore (8.7.0): "+t],r))}}function Zl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yl.logLevel<=ct.WARN){var r=e.map(tf);Yl.warn.apply(Yl,p(["Firestore (8.7.0): "+t],r))}}function tf(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function ef(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw Jl(e),new Error(e)}function nf(t,e){t||ef()}function rf(t,e){return t}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function of(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var af=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=of(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function sf(t,e){return t<e?-1:t>e?1:0}function uf(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function cf(t){return t+"\0"}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var hf=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ql(zl.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ql(zl.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ql(zl.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ql(zl.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?sf(this.nanoseconds,t.nanoseconds):sf(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),lf=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new hf(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function ff(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function pf(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function df(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var vf=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&ef(),void 0===n?n=t.length-e:n>t.length-e&&ef(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new Ql(zl.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(vf),yf=/^[_a-zA-Z][_a-zA-Z0-9]*$/,mf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return yf.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ql(zl.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ql(zl.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ql(zl.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ql(zl.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(vf),bf=function(){function t(t){this.fields=t,t.sort(mf.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return uf(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),_f=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return sf(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();_f.EMPTY_BYTE_STRING=new _f("");var wf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function If(t){if(nf(!!t),"string"==typeof t){var e=0,n=wf.exec(t);if(nf(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Tf(t.seconds),nanos:Tf(t.nanos)}}function Tf(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ef(t){return"string"==typeof t?_f.fromBase64String(t):_f.fromUint8Array(t)}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Sf(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Cf(t){var e=t.mapValue.fields.__previous_value__;return Sf(e)?Cf(e):e}function kf(t){var e=If(t.mapValue.fields.__local_write_time__.timestampValue);return new hf(e.seconds,e.nanos)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Nf(t){return null==t}function Af(t){return 0===t&&1/t==-1/0}function Pf(t){return"number"==typeof t&&Number.isInteger(t)&&!Af(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Rf=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(gf.fromString(e))},t.fromName=function(e){return new t(gf.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===gf.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return gf.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new gf(e.slice()))},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Df(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sf(t)?4:10:ef()}function Of(t,e){var n=Df(t);if(n!==Df(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return kf(t).isEqual(kf(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=If(t.timestampValue),r=If(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ef(t.bytesValue).isEqual(Ef(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Tf(t.geoPointValue.latitude)===Tf(e.geoPointValue.latitude)&&Tf(t.geoPointValue.longitude)===Tf(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Tf(t.integerValue)===Tf(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Tf(t.doubleValue),r=Tf(e.doubleValue);return n===r?Af(n)===Af(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return uf(t.arrayValue.values||[],e.arrayValue.values||[],Of);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(ff(n)!==ff(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Of(n[i],r[i])))return!1;return!0}(t,e);default:return ef()}}function xf(t,e){return void 0!==(t.values||[]).find((function(t){return Of(t,e)}))}function Lf(t,e){var n=Df(t),r=Df(e);if(n!==r)return sf(n,r);switch(n){case 0:return 0;case 1:return sf(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Tf(t.integerValue||t.doubleValue),r=Tf(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Mf(t.timestampValue,e.timestampValue);case 4:return Mf(kf(t),kf(e));case 5:return sf(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ef(t),r=Ef(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=sf(n[i],r[i]);if(0!==o)return o}return sf(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=sf(Tf(t.latitude),Tf(e.latitude));return 0!==n?n:sf(Tf(t.longitude),Tf(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Lf(n[i],r[i]);if(o)return o}return sf(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=sf(r[a],o[a]);if(0!==s)return s;var u=Lf(n[r[a]],i[o[a]]);if(0!==u)return u}return sf(r.length,o.length)}(t.mapValue,e.mapValue);default:throw ef()}}function Mf(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return sf(t,e);var n=If(t),r=If(e),i=sf(n.seconds,r.seconds);return 0!==i?i:sf(n.nanos,r.nanos)}function Ff(t){return Uf(t)}function Uf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=If(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ef(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Rf.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Uf(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Uf(t.fields[o])}return e+"}"}(t.mapValue):ef();var e,n}function jf(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function qf(t){return!!t&&"integerValue"in t}function Vf(t){return!!t&&"arrayValue"in t}function Bf(t){return!!t&&"nullValue"in t}function Kf(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wf(t){return!!t&&"mapValue"in t}function Hf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},If(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return pf(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Hf(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Hf(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Gf=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Wf(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Hf(e)},t.prototype.setAll=function(t){var e=this,n=mf.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var a=e.getFieldsMap(n);e.applyChanges(a,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Hf(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Wf(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Of(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Wf(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){pf(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Hf(this.value))},t}();function zf(t){var e=[];return pf(t.fields,(function(t,n){var r=new mf([t]);if(Wf(n)){var i=zf(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new bf(e)}var Qf=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,lf.min(),Gf.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Gf.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Gf.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Gf.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Gf.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Yf=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Xf(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new Yf(t,e,n,r,i,o,a)}function $f(t){var e=rf(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Ff(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Nf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=hp(e.startAt)),e.endAt&&(n+="|ub:",n+=hp(e.endAt)),e.h=n}return e.h}function Jf(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!fp(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Of(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dp(t.startAt,e.startAt)&&dp(t.endAt,e.endAt)}function Zf(t){return Rf.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var tp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return s(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new ep(t,n,r):"array-contains"===n?new op(t,r):"in"===n?new ap(t,r):"not-in"===n?new sp(t,r):"array-contains-any"===n?new up(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new np(t,n):new rp(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Lf(e,this.value)):null!==e&&Df(this.value)===Df(e)&&this.m(Lf(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ef()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),ep=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Rf.fromName(r.referenceValue),i}return s(e,t),e.prototype.matches=function(t){var e=Rf.comparator(t.key,this.key);return this.m(e)},e}(tp),np=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ip("in",n),r}return s(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(tp),rp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ip("not-in",n),r}return s(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(tp);function ip(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Rf.fromName(t.referenceValue)}))}var op=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Vf(e)&&xf(e.arrayValue,this.value)},e}(tp),ap=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&xf(this.value.arrayValue,e)},e}(tp),sp=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return s(e,t),e.prototype.matches=function(t){if(xf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!xf(this.value.arrayValue,e)},e}(tp),up=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return s(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Vf(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return xf(e.value.arrayValue,t)}))},e}(tp),cp=function(t,e){this.position=t,this.before=e};function hp(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Ff(t)})).join(",")}var lp=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fp(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function pp(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?Rf.comparator(Rf.fromName(a.referenceValue),n.key):Lf(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function dp(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Of(t.position[n],e.position[n]))return!1;return!0}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var vp=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function gp(t,e,n,r,i,o,a,s){return new vp(t,e,n,r,i,o,a,s)}function yp(t){return new vp(t)}function mp(t){return!Nf(t.limit)&&"F"===t.limitType}function bp(t){return!Nf(t.limit)&&"L"===t.limitType}function _p(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function wp(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Ip(t){return null!==t.collectionGroup}function Tp(t){var e=rf(t);if(null===e.p){e.p=[];var n=wp(e),r=_p(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new lp(n)),e.p.push(new lp(mf.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new lp(mf.keyField(),u))}}}return e.p}function Ep(t){var e=rf(t);if(!e.T)if("F"===e.limitType)e.T=Xf(e.path,e.collectionGroup,Tp(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Tp(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new lp(o.field,a))}var s=e.endAt?new cp(e.endAt.position,!e.endAt.before):null,u=e.startAt?new cp(e.startAt.position,!e.startAt.before):null;e.T=Xf(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function Sp(t,e,n){return new vp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Cp(t,e){return Jf(Ep(t),Ep(e))&&t.limitType===e.limitType}function kp(t){return $f(Ep(t))+"|lt:"+t.limitType}function Np(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Ff(e.value);var e})).join(", ")+"]"),Nf(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+hp(t.startAt)),t.endAt&&(e+=", endAt: "+hp(t.endAt)),"Target("+e+")"}(Ep(t))+"; limitType="+t.limitType+")"}function Ap(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Rf.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!pp(t.startAt,Tp(t),e)||t.endAt&&pp(t.endAt,Tp(t),e))}(t,e)}function Pp(t){return function(e,n){for(var r=!1,i=0,o=Tp(t);i<o.length;i++){var a=o[i],s=Rp(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function Rp(t,e,n){var r=t.field.isKeyField()?Rf.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Lf(r,i):ef()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ef()}}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Dp(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Af(e)?"-0":e}}function Op(t){return{integerValue:""+t}}function xp(t,e){return Pf(e)?Op(e):Dp(t,e)}
/**
  * @license
  * Copyright 2018 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Lp=function(){this._=void 0};function Mp(t,e,n){return t instanceof jp?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof qp?Vp(t,e):t instanceof Bp?Kp(t,e):function(t,e){var n=Up(t,e),r=Hp(n)+Hp(t.A);return qf(n)&&qf(t.A)?Op(r):Dp(t.R,r)}(t,e)}function Fp(t,e,n){return t instanceof qp?Vp(t,e):t instanceof Bp?Kp(t,e):n}function Up(t,e){return t instanceof Wp?qf(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(Lp),qp=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return s(e,t),e}(Lp);function Vp(t,e){for(var n=Gp(e),r=function(t){n.some((function(e){return Of(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Bp=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return s(e,t),e}(Lp);function Kp(t,e){for(var n=Gp(e),r=function(t){n=n.filter((function(e){return!Of(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Wp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return s(e,t),e}(Lp);function Hp(t){return Tf(t.integerValue||t.doubleValue)}function Gp(t){return Vf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var zp=function(t,e){this.field=t,this.transform=e},Qp=function(t,e){this.version=t,this.transformResults=e},Yp=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Xp(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var $p=function(){};function Jp(t,e,n){t instanceof rd?function(t,e,n){var r=t.value.clone(),i=ad(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof id?function(t,e,n){if(Xp(t.precondition,e)){var r=ad(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(od(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Zp(t,e,n){t instanceof rd?function(t,e,n){if(Xp(t.precondition,e)){var r=t.value.clone(),i=sd(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(nd(e),r).setHasLocalMutations()}}(t,e,n):t instanceof id?function(t,e,n){if(Xp(t.precondition,e)){var r=sd(t.fieldTransforms,n,e),i=e.data;i.setAll(od(t)),i.setAll(r),e.convertToFoundDocument(nd(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Xp(t.precondition,e)&&e.convertToNoDocument(lf.min())}(t,e)}function td(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=Up(o.transform,a||null);null!=s&&(null==n&&(n=Gf.empty()),n.set(o.field,s))}return n||null}function ed(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&uf(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof qp&&e instanceof qp||t instanceof Bp&&e instanceof Bp?uf(t.elements,e.elements,Of):t instanceof Wp&&e instanceof Wp?Of(t.A,e.A):t instanceof jp&&e instanceof jp}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function nd(t){return t.isFoundDocument()?t.version:lf.min()}var rd=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return s(e,t),e}($p),id=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return s(e,t),e}($p);function od(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function ad(t,e,n){var r=new Map;nf(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,Fp(a,s,n[i]))}return r}function sd(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,Mp(s,u,e))}return r}var ud,cd,hd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return s(e,t),e}($p),ld=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return s(e,t),e}($p),fd=function(t){this.count=t};function pd(t){switch(t){case zl.OK:return ef();case zl.CANCELLED:case zl.UNKNOWN:case zl.DEADLINE_EXCEEDED:case zl.RESOURCE_EXHAUSTED:case zl.INTERNAL:case zl.UNAVAILABLE:case zl.UNAUTHENTICATED:return!1;case zl.INVALID_ARGUMENT:case zl.NOT_FOUND:case zl.ALREADY_EXISTS:case zl.PERMISSION_DENIED:case zl.FAILED_PRECONDITION:case zl.ABORTED:case zl.OUT_OF_RANGE:case zl.UNIMPLEMENTED:case zl.DATA_LOSS:return!0;default:return ef()}}function dd(t){if(void 0===t)return Jl("GRPC error has no .code"),zl.UNKNOWN;switch(t){case ud.OK:return zl.OK;case ud.CANCELLED:return zl.CANCELLED;case ud.UNKNOWN:return zl.UNKNOWN;case ud.DEADLINE_EXCEEDED:return zl.DEADLINE_EXCEEDED;case ud.RESOURCE_EXHAUSTED:return zl.RESOURCE_EXHAUSTED;case ud.INTERNAL:return zl.INTERNAL;case ud.UNAVAILABLE:return zl.UNAVAILABLE;case ud.UNAUTHENTICATED:return zl.UNAUTHENTICATED;case ud.INVALID_ARGUMENT:return zl.INVALID_ARGUMENT;case ud.NOT_FOUND:return zl.NOT_FOUND;case ud.ALREADY_EXISTS:return zl.ALREADY_EXISTS;case ud.PERMISSION_DENIED:return zl.PERMISSION_DENIED;case ud.FAILED_PRECONDITION:return zl.FAILED_PRECONDITION;case ud.ABORTED:return zl.ABORTED;case ud.OUT_OF_RANGE:return zl.OUT_OF_RANGE;case ud.UNIMPLEMENTED:return zl.UNIMPLEMENTED;case ud.DATA_LOSS:return zl.DATA_LOSS;default:return ef()}}(cd=ud||(ud={}))[cd.OK=0]="OK",cd[cd.CANCELLED=1]="CANCELLED",cd[cd.UNKNOWN=2]="UNKNOWN",cd[cd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",cd[cd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",cd[cd.NOT_FOUND=5]="NOT_FOUND",cd[cd.ALREADY_EXISTS=6]="ALREADY_EXISTS",cd[cd.PERMISSION_DENIED=7]="PERMISSION_DENIED",cd[cd.UNAUTHENTICATED=16]="UNAUTHENTICATED",cd[cd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",cd[cd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",cd[cd.ABORTED=10]="ABORTED",cd[cd.OUT_OF_RANGE=11]="OUT_OF_RANGE",cd[cd.UNIMPLEMENTED=12]="UNIMPLEMENTED",cd[cd.INTERNAL=13]="INTERNAL",cd[cd.UNAVAILABLE=14]="UNAVAILABLE",cd[cd.DATA_LOSS=15]="DATA_LOSS";
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var vd=function(){function t(t,e){this.comparator=t,this.root=e||yd.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yd.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yd.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new gd(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new gd(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new gd(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new gd(this.root,t,this.comparator,!0)},t}(),gd=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),yd=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw ef();if(this.right.isRed())throw ef();var t=this.left.check();if(t!==this.right.check())throw ef();return t+(this.isRed()?0:1)},t}();yd.EMPTY=null,yd.RED=!0,yd.BLACK=!1,yd.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw ef()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw ef()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw ef()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw ef()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw ef()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new yd(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var md=function(){function t(t){this.comparator=t,this.data=new vd(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new bd(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new bd(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),bd=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),_d=new vd(Rf.comparator);function wd(){return _d}var Id=new vd(Rf.comparator);function Td(){return Id}var Ed=new vd(Rf.comparator);function Sd(){return Ed}var Cd=new md(Rf.comparator);function kd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Cd,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Nd=new md(sf);function Ad(){return Nd}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Pd=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Rd.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(lf.min(),r,Ad(),wd(),kd())},t}(),Rd=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(_f.EMPTY_BYTE_STRING,n,kd(),kd(),kd())},t}(),Dd=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Od=function(t,e){this.targetId=t,this.V=e},xd=function(t,e,n,r){void 0===n&&(n=_f.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ld=function(){function t(){this.S=0,this.D=Ud(),this.C=_f.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=kd(),e=kd(),n=kd();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:ef()}})),new Rd(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Ud()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Md=function(){function t(t){this.W=t,this.G=new Map,this.H=wd(),this.J=Fd(),this.Y=new md(sf)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:ef()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Zf(i))if(0===n){var o=new Rf(i.path);this.tt(e,o,Qf.newNoDocument(o,lf.min()))}else nf(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Zf(o.target)){var a=new Rf(o.target.path);null!==e.H.get(a)||e.at(i,a)||e.tt(i,a,Qf.newNoDocument(a,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=kd();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Pd(t,n,this.Y,this.H,r);return this.H=wd(),this.J=Fd(),this.Y=new md(sf),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Ld,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new md(sf),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||$l("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Ld),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Fd(){return new vd(Rf.comparator)}function Ud(){return new vd(Rf.comparator)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var jd={asc:"ASCENDING",desc:"DESCENDING"},qd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vd=function(t,e){this.databaseId=t,this.I=e};function Bd(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kd(t,e){return t.I?e.toBase64():e.toUint8Array()}function Wd(t,e){return Bd(t,e.toTimestamp())}function Hd(t){return nf(!!t),lf.fromTimestamp(function(t){var e=If(t);return new hf(e.seconds,e.nanos)}(t))}function Gd(t,e){return function(t){return new gf(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function zd(t){var e=gf.fromString(t);return nf(yv(e)),e}function Qd(t,e){return Gd(t.databaseId,e.path)}function Yd(t,e){var n=zd(e);if(n.get(1)!==t.databaseId.projectId)throw new Ql(zl.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ql(zl.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Rf(Zd(n))}function Xd(t,e){return Gd(t.databaseId,e)}function $d(t){var e=zd(t);return 4===e.length?gf.emptyPath():Zd(e)}function Jd(t){return new gf(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zd(t){return nf(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function tv(t,e,n){return{name:Qd(t,e),fields:n.value.mapValue.fields}}function ev(t,e,n){var r=Yd(t,e.name),i=Hd(e.updateTime),o=new Gf({mapValue:{fields:e.fields}}),a=Qf.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function nv(t,e){var n;if(e instanceof rd)n={update:tv(t,e.key,e.value)};else if(e instanceof hd)n={delete:Qd(t,e.key)};else if(e instanceof id)n={update:tv(t,e.key,e.data),updateMask:gv(e.fieldMask)};else{if(!(e instanceof ld))return ef();n={verify:Qd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof jp)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof qp)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Bp)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Wp)return{fieldPath:e.field.canonicalString(),increment:n.A};throw ef()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Wd(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:ef()}(t,e.precondition)),n}function rv(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Yp.updateTime(Hd(t.updateTime)):void 0!==t.exists?Yp.exists(t.exists):Yp.none()}(e.currentDocument):Yp.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)nf("REQUEST_TIME"===e.setToServerValue),n=new jp;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new qp(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Bp(i)}else"increment"in e?n=new Wp(t,e.increment):ef();var o=mf.fromServerFormat(e.fieldPath);return new zp(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Yd(t,e.update.name),o=new Gf({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new bf(e.map((function(t){return mf.fromServerFormat(t)})))}(e.updateMask);return new id(i,o,a,n,r)}return new rd(i,o,n,r)}if(e.delete){var s=Yd(t,e.delete);return new hd(s,n)}if(e.verify){var u=Yd(t,e.verify);return new ld(u,n)}return ef()}function iv(t,e){return{documents:[Xd(t,e.path)]}}function ov(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Xd(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Xd(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Kf(t.value))return{unaryFilter:{field:fv(t.field),op:"IS_NAN"}};if(Bf(t.value))return{unaryFilter:{field:fv(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Kf(t.value))return{unaryFilter:{field:fv(t.field),op:"IS_NOT_NAN"}};if(Bf(t.value))return{unaryFilter:{field:fv(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fv(t.field),op:lv(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:fv(t.field),direction:hv(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||Nf(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=uv(e.startAt)),e.endAt&&(n.structuredQuery.endAt=uv(e.endAt)),n}function av(t){var e=$d(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){nf(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=sv(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new lp(pv(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Nf(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=cv(n.startAt));var h=null;return n.endAt&&(h=cv(n.endAt)),gp(e,i,s,a,u,"F",c,h)}function sv(t){return t?void 0!==t.unaryFilter?[vv(t)]:void 0!==t.fieldFilter?[dv(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return sv(t)})).reduce((function(t,e){return t.concat(e)})):ef():[]}function uv(t){return{before:t.before,values:t.position}}function cv(t){var e=!!t.before,n=t.values||[];return new cp(n,e)}function hv(t){return jd[t]}function lv(t){return qd[t]}function fv(t){return{fieldPath:t.canonicalString()}}function pv(t){return mf.fromServerFormat(t.fieldPath)}function dv(t){return tp.create(pv(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return ef()}}(t.fieldFilter.op),t.fieldFilter.value)}function vv(t){switch(t.unaryFilter.op){case"IS_NAN":var e=pv(t.unaryFilter.field);return tp.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=pv(t.unaryFilter.field);return tp.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=pv(t.unaryFilter.field);return tp.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=pv(t.unaryFilter.field);return tp.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return ef()}}function gv(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function yv(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function mv(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=_v(e)),e=bv(t.get(n),e);return _v(e)}function bv(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function _v(t){return t+""}function wv(t){var e=t.length;if(nf(e>=2),2===e)return nf(""===t.charAt(0)&&""===t.charAt(1)),gf.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("",o);switch((a<0||a>n)&&ef(),t.charAt(a+1)){case"":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:ef()}o=a+2}return new gf(r)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Iv=function(t,e){this.seconds=t,this.nanoseconds=e},Tv=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Tv.store="owner",Tv.key="owner";var Ev=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ev.store="mutationQueues",Ev.keyPath="userId";var Sv=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Sv.store="mutations",Sv.keyPath="batchId",Sv.userMutationsIndex="userMutationsIndex",Sv.userMutationsKeyPath=["userId","batchId"];var Cv=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,mv(e)]},t.key=function(t,e,n){return[t,mv(e),n]},t}();Cv.store="documentMutations",Cv.PLACEHOLDER=new Cv;var kv=function(t,e){this.path=t,this.readTime=e},Nv=function(t,e){this.path=t,this.version=e},Av=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Av.store="remoteDocuments",Av.readTimeIndex="readTimeIndex",Av.readTimeIndexPath="readTime",Av.collectionReadTimeIndex="collectionReadTimeIndex",Av.collectionReadTimeIndexPath=["parentPath","readTime"];var Pv=function(t){this.byteSize=t};Pv.store="remoteDocumentGlobal",Pv.key="remoteDocumentGlobalKey";var Rv=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Rv.store="targets",Rv.keyPath="targetId",Rv.queryTargetsIndexName="queryTargetsIndex",Rv.queryTargetsKeyPath=["canonicalId","targetId"];var Dv=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Dv.store="targetDocuments",Dv.keyPath=["targetId","path"],Dv.documentTargetsIndex="documentTargetsIndex",Dv.documentTargetsKeyPath=["path","targetId"];var Ov=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ov.key="targetGlobalKey",Ov.store="targetGlobal";var xv=function(t,e){this.collectionId=t,this.parent=e};xv.store="collectionParents",xv.keyPath=["collectionId","parent"];var Lv=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Lv.store="clientMetadata",Lv.keyPath="clientId";var Mv=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Mv.store="bundles",Mv.keyPath="bundleId";var Fv=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Fv.store="namedQueries",Fv.keyPath="name";var Uv=p(p([],p(p([],p(p([],p(p([],[Ev.store,Sv.store,Cv.store,Av.store,Rv.store,Tv.store,Ov.store,Dv.store]),[Lv.store])),[Pv.store])),[xv.store])),[Mv.store,Fv.store]),jv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",qv=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Vv=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Bv=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&ef(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Kv=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Vv,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Gv(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=$v(e.target.error);n.ft.reject(new Gv(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Gv(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||($l("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Qv(e)},t}(),Wv=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(C())&&Jl("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return $l("SimpleDb","Removing database:",t),Yv(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=C(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return void 0!==Hl&&"YES"===(null===(t=Hl.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return c(this,void 0,void 0,(function(){var e,n=this;return h(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:($l("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Gv(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Ql(zl.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Gv(t,n))},i.onupgradeneeded=function(t){$l("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){$l("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,a,s,u;return h(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,c,l;return h(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.At(t)];case 2:return s.db=h.sent(),e=Kv.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),Bv.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,$l("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Hv=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Yv(this.Pt.delete())},t}(),Gv=function(t){function e(e,n){var r=this;return(r=t.call(this,zl.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return s(e,t),e}(Ql);function zv(t){return"IndexedDbTransactionError"===t.name}var Qv=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?($l("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):($l("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Yv(n)},t.prototype.add=function(t){return $l("SimpleDb","ADD",this.store.name,t,t),Yv(this.store.add(t))},t.prototype.get=function(t){var e=this;return Yv(this.store.get(t)).next((function(n){return void 0===n&&(n=null),$l("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return $l("SimpleDb","DELETE",this.store.name,t),Yv(this.store.delete(t))},t.prototype.count=function(){return $l("SimpleDb","COUNT",this.store.name),Yv(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){$l("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Bv((function(n,r){e.onerror=function(t){var e=$v(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Bv((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Hv(i),a=e(i.primaryKey,i.value,o);if(a instanceof Bv){var s=a.catch((function(t){return o.done(),Bv.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Bv.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Yv(t){return new Bv((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=$v(t.target.error);n(e)}}))}var Xv=!1;function $v(t){var e=Wv._t(C());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ql("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Xv||(Xv=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Jv=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return s(e,t),e}(qv);function Zv(t,e){var n=rf(t);return Wv.It(n.Mt,e)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var tg=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Jp(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Zp(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Zp(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(lf.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),kd())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&uf(this.mutations,t.mutations,(function(t,e){return ed(t,e)}))&&uf(this.baseMutations,t.baseMutations,(function(t,e){return ed(t,e)}))},t}(),eg=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){nf(e.mutations.length===r.length);for(var i=Sd(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),ng=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=lf.min()),void 0===o&&(o=lf.min()),void 0===a&&(a=_f.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),rg=function(t){this.Lt=t};function ig(t,e){if(e.document)return ev(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Rf.fromSegments(e.noDocument.path),r=cg(e.noDocument.readTime),i=Qf.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Rf.fromSegments(e.unknownDocument.path);return r=cg(e.unknownDocument.version),Qf.newUnknownDocument(o,r)}return ef()}function og(t,e,n){var r=ag(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Qd(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Bd(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new Av(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=ug(e.version);return a=e.hasCommittedMutations,new Av(null,new kv(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=ug(e.version);return new Av(new Nv(c,h),null,null,!0,r,i)}return ef()}function ag(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function sg(t){var e=new hf(t[0],t[1]);return lf.fromTimestamp(e)}function ug(t){var e=t.toTimestamp();return new Iv(e.seconds,e.nanoseconds)}function cg(t){var e=new hf(t.seconds,t.nanoseconds);return lf.fromTimestamp(e)}function hg(t,e){for(var n=(e.baseMutations||[]).map((function(e){return rv(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return rv(t.Lt,e)})),s=hf.fromMillis(e.localWriteTimeMs);return new tg(e.batchId,s,n,a)}function lg(t){var e,n,r=cg(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?cg(t.lastLimboFreeSnapshotVersion):lf.min();return void 0!==t.query.documents?(nf(1===(n=t.query).documents.length),e=Ep(yp($d(n.documents[0])))):e=function(t){return Ep(av(t))}(t.query),new ng(e,t.targetId,0,t.lastListenSequenceNumber,r,i,_f.fromBase64String(t.resumeToken))}function fg(t,e){var n,r=ug(e.snapshotVersion),i=ug(e.lastLimboFreeSnapshotVersion);n=Zf(e.target)?iv(t.Lt,e.target):ov(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Rv(e.targetId,$f(e.target),r,o,e.sequenceNumber,i,n)}function pg(t){var e=av({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Sp(e,e.limit,"L"):e}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var dg=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return vg(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:cg(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return vg(t).put({bundleId:(n=e).id,createTime:ug(Hd(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return gg(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:pg(e.bundledQuery),readTime:cg(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return gg(t).put(function(t){return{name:t.name,readTime:ug(Hd(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function vg(t){return Zv(t,Mv.store)}function gg(t){return Zv(t,Fv.store)}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var yg=function(){function t(){this.Bt=new mg}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Bv.resolve()},t.prototype.getCollectionParents=function(t,e){return Bv.resolve(this.Bt.getEntries(e))},t}(),mg=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new md(gf.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new md(gf.comparator)).toArray()},t}(),bg=function(){function t(){this.qt=new mg}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:mv(i)};return _g(t).put(o)}return Bv.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[cf(e),""],!1,!0);return _g(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(wv(o.parent))}return n}))},t}();function _g(t){return Zv(t,xv.store)}
/**
  * @license
  * Copyright 2018 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var wg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ig=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Tg(t,e,n){var r=t.store(Sv.store),i=t.store(Cv.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){nf(1===s)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Cv.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Bv.waitFor(o).next((function(){return c}))}function Eg(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ef();e=t.noDocument}return JSON.stringify(e).length}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */Ig.DEFAULT_COLLECTION_PERCENTILE=10,Ig.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ig.DEFAULT=new Ig(41943040,Ig.DEFAULT_COLLECTION_PERCENTILE,Ig.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ig.DISABLED=new Ig(-1,0,0);var Sg=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return nf(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kg(t).$t({index:Sv.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Ng(t),a=kg(t);return a.add({}).next((function(s){nf("number"==typeof s);for(var u=new tg(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return nv(t.Lt,e)})),i=n.mutations.map((function(e){return nv(t.Lt,e)}));return new Sv(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new md((function(t,e){return sf(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],v=Cv.key(i.userId,d.key.path,s);l=l.add(d.key.path.popLast()),h.push(a.put(c)),h.push(o.put(v,Cv.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[s]=u.keys()})),Bv.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return kg(t).get(e).next((function(t){return t?(nf(t.userId===n.userId),hg(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Bv.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return kg(t).$t({index:Sv.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(nf(e.batchId>=r),o=hg(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return kg(t).$t({index:Sv.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kg(t).Nt(Sv.userMutationsIndex,n).next((function(t){return t.map((function(t){return hg(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Cv.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ng(t).$t({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],h=wv(u);if(s===n.userId&&e.path.isEqual(h))return kg(t).get(c).next((function(t){if(!t)throw ef();nf(t.userId===n.userId),o.push(hg(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new md(sf),i=[];return e.forEach((function(e){var o=Cv.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Ng(t).$t({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=wv(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),Bv.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Cv.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new md(sf);return Ng(t).$t({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],h=wv(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(kg(t).get(e).next((function(t){if(null===t)throw ef();nf(t.userId===n.userId),r.push(hg(n.R,t))})))})),Bv.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Tg(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Bv.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Bv.resolve();var r=IDBKeyRange.lowerBound(Cv.prefixForUser(e.userId)),i=[];return Ng(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=wv(t[1]);i.push(o)}else r.done()})).next((function(){nf(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Cg(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Ag(t).get(this.userId).next((function(t){return t||new Ev(e.userId,-1,"")}))},t}();function Cg(t,e,n){var r=Cv.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Ng(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function kg(t){return Zv(t,Sv.store)}function Ng(t){return Zv(t,Cv.store)}function Ag(t){return Zv(t,Ev.store)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Pg=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Rg=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Pg(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return lf.fromTimestamp(new hf(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Dg(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return nf(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Dg(t).$t((function(a,s){var u=lg(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Bv.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Dg(t).$t((function(t,n){var r=lg(n);e(r)}))},t.prototype.Xt=function(t){return Og(t).get(Ov.key).next((function(t){return nf(null!==t),t}))},t.prototype.Zt=function(t,e){return Og(t).put(Ov.key,e)},t.prototype.te=function(t,e){return Dg(t).put(fg(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=$f(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Dg(t).$t({range:r,index:Rv.queryTargetsIndexName},(function(t,n,r){var o=lg(n);Jf(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=xg(t);return e.forEach((function(e){var a=mv(e.path);i.push(o.put(new Dv(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),Bv.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=xg(t);return Bv.forEach(e,(function(e){var o=mv(e.path);return Bv.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=xg(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=xg(t),i=kd();return r.$t({range:n,kt:!0},(function(t,e,n){var r=wv(t[1]),o=new Rf(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=mv(e.path),r=IDBKeyRange.bound([n],[cf(n)],!1,!0),i=0;return xg(t).$t({index:Dv.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Dg(t).get(e).next((function(t){return t?lg(t):null}))},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Dg(t){return Zv(t,Rv.store)}function Og(t){return Zv(t,Ov.store)}function xg(t){return Zv(t,Dv.store)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Lg(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){if(t.code!==zl.FAILED_PRECONDITION||t.message!==jv)throw t;return $l("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Mg(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=sf(n,i);return 0===a?sf(r,o):a}var Fg=function(){function t(t){this.ne=t,this.buffer=new md(Mg),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Mg(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ug=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;$l("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return c(e,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return zv(e=n.sent())?($l("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Lg(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),jg=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Bv.resolve(Gl.o);var r=new Fg(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?($l("LruGarbageCollector","Garbage collection skipped; disabled"),Bv.resolve(wg)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?($l("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),wg):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,a,s,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?($l("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,s=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Xl()<=ct.DEBUG&&$l("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-h)+"ms"),Bv.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),qg=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new jg(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Vg(t,n)},t.prototype.removeReference=function(t,e,n){return Vg(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Vg(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Ag(t).Ot((function(r){return Cg(t,r,e).next((function(t){return t&&(n=!0),Bv.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),xg(t).delete([0,mv(a.path)])}))}));i.push(u)}})).next((function(){return Bv.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Vg(t,e)},t.prototype.we=function(t,e){var n,r=xg(t),i=Gl.o;return r.$t({index:Dv.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var a=r.path,s=r.sequenceNumber;0===o?(i!==Gl.o&&e(new Rf(wv(n)),i),i=s,n=a):i=Gl.o})).next((function(){i!==Gl.o&&e(new Rf(wv(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Vg(t,e){return xg(t).put(function(t,e){return new Dv(0,mv(t.path),e)}(e,t.currentSequenceNumber))}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Bg=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){pf(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return df(this.inner)},t}(),Kg=function(){function t(){this.changes=new Bg((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:lf.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Qf.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Bv.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Wg=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return zg(t).put(Qg(e),n)},t.prototype.removeEntry=function(t,e){var n=zg(t),r=Qg(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return zg(t).get(Qg(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return zg(t).get(Qg(e)).next((function(t){return{document:n.ye(e,t),size:Eg(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=wd();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=wd(),i=new vd(Rf.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Eg(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Bv.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return zg(t).$t({range:r},(function(t,e,r){for(var a=Rf.fromSegments(t);o&&Rf.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=wd(),o=e.path.length+1,a={};if(n.isEqual(lf.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=ag(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Av.collectionReadTimeIndex}return zg(t).$t(a,(function(t,n,a){if(t.length===o){var s=ig(r.R,n);e.path.isPrefixOf(s.key.path)?Ap(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Hg(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Gg(t).get(Pv.key).next((function(t){return nf(!!t),t}))},t.prototype.me=function(t,e){return Gg(t).put(Pv.key,e)},t.prototype.ye=function(t,e){if(e){var n=ig(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(lf.min()))return n}return Qf.newInvalidDocument(t)},t}(),Hg=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Bg((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return s(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new md((function(t,e){return sf(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=og(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Eg(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=og(e.Ie.R,Qf.newNoDocument(o,lf.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Bv.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Kg);
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Gg(t){return Zv(t,Pv.store)}function zg(t){return Zv(t,Av.store)}function Qg(t){return t.path.toArray()}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Yg=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;nf(n<r&&n>=0&&r<=11);var o=new Kv("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Tv.store)}(t),function(t){t.createObjectStore(Ev.store,{keyPath:Ev.keyPath}),t.createObjectStore(Sv.store,{keyPath:Sv.keyPath,autoIncrement:!0}).createIndex(Sv.userMutationsIndex,Sv.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Cv.store)}(t),Xg(t),function(t){t.createObjectStore(Av.store)}(t));var a=Bv.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Dv.store),t.deleteObjectStore(Rv.store),t.deleteObjectStore(Ov.store)}(t),Xg(t)),a=a.next((function(){return function(t){var e=t.store(Ov.store),n=new Ov(0,0,lf.min().toTimestamp(),0);return e.put(Ov.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(Sv.store).Nt().next((function(n){t.deleteObjectStore(Sv.store),t.createObjectStore(Sv.store,{keyPath:Sv.keyPath,autoIncrement:!0}).createIndex(Sv.userMutationsIndex,Sv.userMutationsKeyPath,{unique:!0});var r=e.store(Sv.store),i=n.map((function(t){return r.put(t)}));return Bv.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(Lv.store,{keyPath:Lv.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(Pv.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Av.store);e.createIndex(Av.readTimeIndex,Av.readTimeIndexPath,{unique:!1}),e.createIndex(Av.collectionReadTimeIndex,Av.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(Mv.store,{keyPath:Mv.keyPath})}(t),function(t){t.createObjectStore(Fv.store,{keyPath:Fv.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(Av.store).$t((function(t,n){e+=Eg(n)})).next((function(){var n=new Pv(e);return t.store(Pv.store).put(Pv.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Ev.store),r=t.store(Sv.store);return n.Nt().next((function(n){return Bv.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Sv.userMutationsIndex,i).next((function(r){return Bv.forEach(r,(function(r){nf(r.userId===n.userId);var i=hg(e.R,r);return Tg(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Dv.store),n=t.store(Av.store);return t.store(Ov.store).get(Ov.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new gf(n),a=function(t){return[0,mv(t)]}(o);r.push(e.get(a).next((function(n){return n?Bv.resolve():function(n){return e.put(new Dv(0,mv(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Bv.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(xv.store,{keyPath:xv.keyPath});var n=e.store(xv.store),r=new mg,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:mv(i)})}};return e.store(Av.store).$t({kt:!0},(function(t,e){var n=new gf(t);return i(n.popLast())})).next((function(){return e.store(Cv.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=wv(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Rv.store);return n.$t((function(t,r){var i=lg(r),o=fg(e.R,i);return n.put(o)}))},t}();function Xg(t){t.createObjectStore(Dv.store,{keyPath:Dv.keyPath}).createIndex(Dv.documentTargetsIndex,Dv.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Rv.store,{keyPath:Rv.keyPath}).createIndex(Rv.queryTargetsIndexName,Rv.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ov.store)}var $g="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Jg=function(){function t(e,n,r,i,o,a,s,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Ql(zl.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qg(this,i),this.Le=n+"main",this.R=new rg(u),this.Be=new Wv(this.Le,11,new Yg(this.R)),this.qe=new Rg(this.referenceDelegate,this.R),this.Ut=new bg,this.Ue=function(t,e){return new Wg(t,e)}(this.R,this.Ut),this.Ke=new dg,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Jl("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ql(zl.FAILED_PRECONDITION,$g);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Gl(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return c(e,void 0,void 0,(function(){return h(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return c(e,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return c(e,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return ty(e).put(new Lv(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(zv(e))return $l("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return $l("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Zg(t).get(Tv.key).next((function(t){return Bv.resolve(e.tn(t))}))},t.prototype.en=function(t){return ty(t).delete(this.clientId)},t.prototype.nn=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i=this;return h(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Zv(t,Lv.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Bv.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Bv.resolve(!0):Zg(t).get(Tv.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Ql(zl.FAILED_PRECONDITION,$g);return!1}}return!(!e.networkEnabled||!e.inForeground)||ty(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&$l("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return c(this,void 0,void 0,(function(){var t=this;return h(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Tv.store,Lv.store],(function(e){var n=new Jv(e,Gl.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return ty(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Sg.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;$l("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Uv,(function(o){return i=new Jv(o,r.Ne?r.Ne.next():Gl.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Jl("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Ql(zl.FAILED_PRECONDITION,jv);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Zg(t).get(Tv.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ql(zl.FAILED_PRECONDITION,$g)}))},t.prototype.Ze=function(t){var e=new Tv(this.clientId,this.allowTabSynchronization,Date.now());return Zg(t).put(Tv.key,e)},t.yt=function(){return Wv.yt()},t.prototype.Xe=function(t){var e=this,n=Zg(t);return n.get(Tv.key).next((function(t){return e.tn(t)?($l("IndexedDbPersistence","Releasing primary lease."),n.delete(Tv.key)):Bv.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Jl("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return $l("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Jl("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Jl("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Zg(t){return Zv(t,Tv.store)}function ty(t){return Zv(t,Lv.store)}function ey(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ny=function(t,e){this.progress=t,this.wn=e},ry=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Rf.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Ip(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Rf(e)).next((function(t){var e=Td();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Td();return this.Ut.getCollectionParents(t,i).next((function(a){return Bv.forEach(a,(function(a){var s=function(t,e){return new vp(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c);null==h&&(h=Qf.newInvalidDocument(c),r=r.insert(c,h)),Zp(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Ap(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=kd(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof id&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),iy=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=kd(),i=kd(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),oy=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(lf.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var a=i.Cn(e,o);return(mp(e)||bp(e))&&i.Nn(e.limitType,a,r,n)?i.Dn(t,e):(Xl()<=ct.DEBUG&&$l("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Np(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return a.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new md(Pp(t));return e.forEach((function(e,r){Ap(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Xl()<=ct.DEBUG&&$l("QueryEngine","Using full collection scan to execute query:",Np(e)),this.Sn.getDocumentsMatchingQuery(t,e,lf.min())},t}(),ay=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new vd(sf),this.kn=new Bg((function(t){return $f(t)}),Jf),this.$n=lf.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new ry(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function sy(t,e,n,r){return new ay(t,e,n,r)}function uy(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o;return h(this,(function(a){switch(a.label){case 0:return n=rf(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new ry(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=kd(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function cy(t,e){var n=rf(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=Bv.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);nf(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function hy(t){var e=rf(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function ly(t,e){var n=rf(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return nf(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=wd();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(fy(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(lf.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return Bv.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.Fn=i,t}))}function fy(t,e,n,r,i){var o=kd();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=wd();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(lf.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):$l("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function py(t,e){var n=rf(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function dy(t,e){var n=rf(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Bv.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new ng(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function vy(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a;return h(this,(function(s){switch(s.label){case 0:r=rf(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!zv(a=s.sent()))throw a;return $l("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function gy(t,e,n){var r=rf(t),i=lf.min(),o=kd();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=rf(t),i=r.kn.get(n);return void 0!==i?Bv.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Ep(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:lf.min(),n?o:kd())})).next((function(t){return{documents:t,Bn:o}}))}))}function yy(t,e){var n=rf(t),r=rf(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function my(t){var e=rf(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=rf(t),i=wd(),o=ag(n),a=zg(e),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:Av.readTimeIndex,range:s},(function(t,e){var n=ig(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:sg(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function by(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){return[2,(e=rf(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=zg(t),n=lf.min();return e.$t({index:Av.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=sg(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function _y(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,a,s,u,c,l,f,p,d;return h(this,(function(h){switch(h.label){case 0:for(i=rf(t),o=kd(),a=wd(),s=Sd(),u=0,c=n;u<c.length;u++)l=c[u],f=e.qn(l.metadata.name),l.document&&(o=o.add(f)),a=a.insert(f,e.Un(l)),s=s.insert(f,e.Kn(l.metadata.readTime));return p=i.On.newChangeBuffer({trackRemovals:!0}),[4,dy(i,function(t){return Ep(yp(gf.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=h.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return fy(t,p,a,lf.min(),s).next((function(e){return p.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function wy(t,e,n){return void 0===n&&(n=kd()),c(this,void 0,void 0,(function(){var r,i;return h(this,(function(o){switch(o.label){case 0:return[4,dy(t,Ep(pg(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=rf(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Hd(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var a=r.withResumeToken(_f.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Ke.saveNamedQuery(t,e)}))}))]}}))}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Iy=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Bv.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Hd(n.createTime)}),Bv.resolve()},t.prototype.getNamedQuery=function(t,e){return Bv.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:pg(t.bundledQuery),readTime:Hd(t.readTime)}}(e)),Bv.resolve()},t}(),Ty=function(){function t(){this.Wn=new md(Ey.Gn),this.zn=new md(Ey.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Ey(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Ey(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Rf(new gf([])),r=new Ey(n,t),i=new Ey(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Rf(new gf([])),n=new Ey(e,t),r=new Ey(e,t+1),i=kd();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Ey(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Ey=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Rf.comparator(t.key,e.key)||sf(t.ns,e.ns)},t.Hn=function(t,e){return sf(t.ns,e.ns)||Rf.comparator(t.key,e.key)},t}(),Sy=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new md(Ey.Gn)}return t.prototype.checkEmpty=function(t){return Bv.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new tg(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new Ey(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Bv.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Bv.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Bv.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Bv.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Bv.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Ey(e,0),i=new Ey(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Bv.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new md(sf);return e.forEach((function(t){var e=new Ey(t,0),i=new Ey(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Bv.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Rf.isDocumentKey(i)||(i=i.child(""));var o=new Ey(new Rf(i),0),a=new md(sf);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),Bv.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;nf(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Bv.forEach(e.mutations,(function(i){var o=new Ey(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Ey(e,0),r=this.rs.firstAfterOrEqual(n);return Bv.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Bv.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Cy=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new vd(Rf.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Bv.resolve(n?n.document.clone():Qf.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=wd();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Qf.newInvalidDocument(t))})),Bv.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=wd(),i=new Rf(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||Ap(e,c)&&(r=r.insert(c.key,c.clone()))}return Bv.resolve(r)},t.prototype.fs=function(t,e){return Bv.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new ky(this)},t.prototype.getSize=function(t){return Bv.resolve(this.size)},t}(),ky=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return s(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Bv.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Kg),Ny=function(){function t(t){this.persistence=t,this.ds=new Bg((function(t){return $f(t)}),Jf),this.lastRemoteSnapshotVersion=lf.min(),this.highestTargetId=0,this.ws=0,this._s=new Ty,this.targetCount=0,this.ys=Pg.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Bv.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Bv.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Bv.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Bv.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Bv.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Pg(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Bv.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Bv.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Bv.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),Bv.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Bv.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Bv.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Bv.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Bv.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Bv.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Bv.resolve(n)},t.prototype.containsKey=function(t,e){return Bv.resolve(this._s.containsKey(e))},t}(),Ay=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Gl(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Ny(this),this.Ut=new yg,this.Ue=function(t,e){return new Cy(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new rg(e),this.Ke=new Iy(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Sy(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;$l("MemoryPersistence","Starting transaction:",t);var i=new Py(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Bv.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Py=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return s(e,t),e}(qv),Ry=function(){function t(t){this.persistence=t,this.As=new Ty,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw ef()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Bv.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Bv.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Bv.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Bv.forEach(this.vs,(function(r){var i=Rf.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Bv.or([function(){return Bv.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Dy=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Oy(t,e){return"firestore_clients_"+t+"_"+e}function xy(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Ly(t,e){return"firestore_targets_"+t+"_"+e}Dy.UNAUTHENTICATED=new Dy(null),Dy.GOOGLE_CREDENTIALS=new Dy("google-credentials-uid"),Dy.FIRST_PARTY=new Dy("first-party-uid");var My=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Ql(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(Jl("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Fy=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ql(i.error.code,i.error.message)),o?new t(e,i.state,r):(Jl("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Uy=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ad(),a=0;i&&a<r.activeTargetIds.length;++a)i=Pf(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Jl("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),jy=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Jl("SharedClientState","Failed to parse online state: "+e),null)},t}(),qy=function(){function t(){this.activeTargetIds=Ad()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Vy=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new vd(sf),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Oy(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new qy),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,l,f=this;return h(this,(function(h){switch(h.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Oy(this.persistenceKey,r)))&&(o=Uy.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Ly(this.persistenceKey,t));if(n){var r=Fy.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Ly(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return $l("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){$l("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){$l("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if($l("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Jl("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return c(e,void 0,void 0,(function(){var t,e,r,i,o,a;return h(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=Gl.o;if(null!=t)try{var n=JSON.parse(t);nf("number"==typeof n),e=n}catch(t){Jl("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Gl.o&&this.sequenceNumberHandler(a);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new My(this.currentUser,t,e,n),i=xy(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=xy(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Ly(this.persistenceKey,t),i=new Fy(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Uy.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return My.Vs(new Dy(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Fy.Vs(r,e)},t.prototype.js=function(t){return jy.Vs(t)},t.prototype.ii=function(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:($l("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ad();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),By=function(){function t(){this.li=new qy,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new qy,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Ky=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Wy=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){$l("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){$l("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Hy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Gy=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),zy=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return s(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var a=new Wl;a.listenOnce(jl.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case Ul.NO_ERROR:var e=a.getResponseJson();$l("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Ul.TIMEOUT:$l("Connection",'RPC "'+t+'" timed out'),o(new Ql(zl.DEADLINE_EXCEEDED,"Request time out"));break;case Ul.HTTP_ERROR:var n=a.getStatus();if($l("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(zl).indexOf(e)>=0?e:zl.UNKNOWN}(r.status);o(new Ql(s,r.message))}else o(new Ql(zl.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ql(zl.UNAVAILABLE,"Connection failed."));break;default:ef()}}finally{$l("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Ml(),o=Fl(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Bl({})),this.Fi(a.initMessageHeaders,e),k()||P()||C().indexOf("Electron/")>=0||((n=C()).indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0)||C().indexOf("MSAppHost/")>=0||A()||(a.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");$l("Connection","Creating WebChannel: "+s,a);var u=i.createWebChannel(s,a),c=!1,h=!1,l=new Gy({Ei:function(t){h?$l("Connection","Not sending because WebChannel is closed:",t):(c||($l("Connection","Opening WebChannel transport."),u.open(),c=!0),$l("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,Kl.EventType.OPEN,(function(){h||$l("Connection","WebChannel transport opened.")})),f(u,Kl.EventType.CLOSE,(function(){h||(h=!0,$l("Connection","WebChannel transport closed"),l.Vi())})),f(u,Kl.EventType.ERROR,(function(t){h||(h=!0,Zl("Connection","WebChannel transport errored:",t),l.Vi(new Ql(zl.UNAVAILABLE,"The operation could not be completed")))})),f(u,Kl.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];nf(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){$l("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=ud[t];if(void 0!==e)return dd(e)}(o),s=i.message;void 0===a&&(a=zl.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new Ql(a,s)),u.close()}else $l("Connection","WebChannel received:",n),l.Si(n)}})),f(o,ql.STAT_EVENT,(function(t){t.stat===Vl.PROXY?$l("Connection","Detected buffering proxy"):t.stat===Vl.NOPROXY&&$l("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);$l("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return $l("RestConnection","Received: ",t),t}),(function(e){throw Zl("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Hy[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Qy(){return"undefined"!=typeof window?window:null}function Yy(){return"undefined"!=typeof document?document:null}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Xy(t){return new Vd(t,!0)}var $y=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&$l("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Jy=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new $y(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return c(this,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===zl.RESOURCE_EXHAUSTED?(Jl(e.toString()),Jl("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===zl.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Ql(zl.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return c(t,void 0,void 0,(function(){return h(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return $l("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():($l("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Zy=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return s(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:ef()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(nf(void 0===e||"string"==typeof e),_f.fromBase64String(e||"")):(nf(void 0===e||e instanceof Uint8Array),_f.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?zl.UNKNOWN:dd(t.code);return new Ql(e,t.message||"")}(s);n=new xd(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Yd(t,r.document.name),o=Hd(r.document.updateTime);var s=new Gf({mapValue:{fields:r.document.fields}}),u=(a=Qf.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new Dd(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Yd(t,r.document),o=r.readTime?Hd(r.readTime):lf.min(),s=Qf.newNoDocument(i,o),a=r.removedTargetIds||[],n=new Dd([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Yd(t,r.document),o=r.removedTargetIds||[],n=new Dd([],o,i,null);else{if(!("filter"in e))return ef();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new fd(r),o=h.targetId,n=new Od(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return lf.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?lf.min():e.readTime?Hd(e.readTime):lf.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Jd(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Zf(r)?{documents:iv(t,r)}:{query:ov(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Kd(t,e.resumeToken):e.snapshotVersion.compareTo(lf.min())>0&&(n.readTime=Bd(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ef()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Jd(this.R),e.removeTarget=t,this.cr(e)},e}(Jy),tm=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return s(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(nf(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(nf(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Hd(t.updateTime):Hd(e);return n.isEqual(lf.min())&&(n=Hd(e)),new Qp(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Hd(t.commitTime);return this.listener.Tr(n,e)}return nf(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Jd(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return nv(e.R,t)}))};this.cr(n)},e}(Jy),em=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return s(e,t),e.prototype.br=function(){if(this.Rr)throw new Ql(zl.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===zl.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ql(zl.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===zl.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ql(zl.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),nm=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Jl(e),this.Vr=!1):$l("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),rm=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return c(o,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return fm(this)?($l("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return(e=rf(t)).Or.add(4),[4,om(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,im(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new nm(n,r)};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function im(t){return c(this,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:if(!fm(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function om(t){return c(this,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function am(t,e){var n=rf(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),lm(n)?hm(n):km(n).er()&&um(n,e))}function sm(t,e){var n=rf(t),r=km(n);n.$r.delete(e),r.er()&&cm(n,e),0===n.$r.size&&(r.er()?r.ir():fm(n)&&n.Br.set("Unknown"))}function um(t,e){t.qr.U(e.targetId),km(t).mr(e)}function cm(t,e){t.qr.U(e),km(t).yr(e)}function hm(t){t.qr=new Md({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),km(t).start(),t.Br.Sr()}function lm(t){return fm(t)&&!km(t).tr()&&t.$r.size>0}function fm(t){return 0===rf(t).Or.size}function pm(t){t.qr=void 0}function dm(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){return t.$r.forEach((function(e,n){um(t,e)})),[2]}))}))}function vm(t,e){return c(this,void 0,void 0,(function(){return h(this,(function(n){return pm(t),lm(t)?(t.Br.Nr(e),hm(t)):t.Br.set("Unknown"),[2]}))}))}function gm(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o;return h(this,(function(a){switch(a.label){case 0:if(t.Br.set("Online"),!(e instanceof xd&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o;return h(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.$r.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),$l("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,ym(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Dd?t.qr.X(e):e instanceof Od?t.qr.rt(e):t.qr.et(e),n.isEqual(lf.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,hy(t.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(_f.EMPTY_BYTE_STRING,n.snapshotVersion)),cm(t,e);var r=new ng(n.target,e,1,n.sequenceNumber);um(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return $l("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,ym(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function ym(t,e,n){return c(this,void 0,void 0,(function(){var r=this;return h(this,(function(i){switch(i.label){case 0:if(!zv(e))throw e;return t.Or.add(1),[4,om(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return hy(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return c(r,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return $l("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,im(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function mm(t,e){return e().catch((function(n){return ym(t,n,e)}))}function bm(t){return c(this,void 0,void 0,(function(){var e,n,r,i,o;return h(this,(function(a){switch(a.label){case 0:e=rf(t),n=Nm(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return fm(t)&&t.kr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,py(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Nm(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,ym(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return _m(e)&&wm(e),[2]}}))}))}function _m(t){return fm(t)&&!Nm(t).tr()&&t.kr.length>0}function wm(t){Nm(t).start()}function Im(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){return Nm(t).Ar(),[2]}))}))}function Tm(t){return c(this,void 0,void 0,(function(){var e,n,r,i;return h(this,(function(o){for(e=Nm(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Em(t,e,n){return c(this,void 0,void 0,(function(){var r,i;return h(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=eg.from(r,e,n),[4,mm(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,bm(t)];case 2:return o.sent(),[2]}}))}))}function Sm(t,e){return c(this,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return e&&Nm(t).pr?[4,function(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return pd(r=e.code)&&r!==zl.ABORTED?(n=t.kr.shift(),Nm(t).sr(),[4,mm(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,bm(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return _m(t)&&wm(t),[2]}}))}))}function Cm(t,e){return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return n=rf(t),e?(n.Or.delete(2),[4,im(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,om(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function km(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=rf(t);return r.br(),new Zy(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:dm.bind(null,t),Ri:vm.bind(null,t),_r:gm.bind(null,t)}),t.Mr.push((function(n){return c(e,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),lm(t)?hm(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),pm(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Nm(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=rf(t);return r.br(),new tm(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Im.bind(null,t),Ri:Sm.bind(null,t),Ir:Tm.bind(null,t),Tr:Em.bind(null,t)}),t.Mr.push((function(n){return c(e,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,bm(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&($l("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr}var Am=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Vv,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ql(zl.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Pm(t,e){if(Jl("AsyncQueue",e+": "+t),zv(t))return new Ql(zl.UNAVAILABLE,e+": "+t);throw t}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Rm=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Rf.comparator(e.key,n.key)}:function(t,e){return Rf.comparator(t.key,e.key)},this.keyedMap=Td(),this.sortedSet=new vd(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Dm=function(){function t(){this.Qr=new vd(Rf.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):ef():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Om=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Rm.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Cp(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),xm=function(){this.Wr=void 0,this.listeners=[]},Lm=function(){this.queries=new Bg((function(t){return kp(t)}),Cp),this.onlineState="Unknown",this.Gr=new Set};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Mm(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return h(this,(function(c){switch(c.label){case 0:if(n=rf(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new xm),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=Pm(s,"Initialization of query '"+Np(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&qm(n),[2]}}))}))}function Fm(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a;return h(this,(function(s){return n=rf(t),r=e.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Um(t,e){for(var n=rf(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(a)&&(r=!0);u.Wr=a}}r&&qm(n)}function jm(t,e,n){var r=rf(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function qm(t){t.Gr.forEach((function(t){t.next()}))}var Vm=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Om(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Om.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Bm=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),Km=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Yd(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?ev(this.R,t.document,!1):Qf.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return Hd(t)},t}(),Wm=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=Hm(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new Km(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],h=(e.get(c)||kd()).add(a);e.set(c,h)}}return e},t.prototype.complete=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i;return h(this,(function(o){switch(o.label){case 0:return[4,_y(this.localStore,new Km(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,wy(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new ny(Object.assign({},this.progress),t))]}}))}))},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Hm(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Gm=function(t){this.key=t},zm=function(t){this.key=t},Qm=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=kd(),this.mutatedKeys=kd(),this.lo=Pp(t),this.fo=new Rm(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Dm,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=mp(this.query)&&i.size===this.query.limit?i.last():null,c=bp(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Ap(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(s=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(s=!0)),d&&(l?(a=a.add(l),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),mp(this.query)||bp(this.query))for(;a.size>this.query.limit;){var h=mp(this.query)?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ef()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new Om(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Dm,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=kd(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new zm(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Gm(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=kd();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Om.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Ym=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Xm=function(t){this.key=t,this.bo=!1},$m=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Bg((function(t){return kp(t)}),Cp),this.Vo=new Map,this.So=new Set,this.Do=new vd(Rf.comparator),this.Co=new Map,this.No=new Ty,this.xo={},this.Fo=new Map,this.ko=Pg.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Jm(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return n=kb(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,dy(n.localStore,Ep(e))];case 2:return a=u.sent(),s=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,Zm(n,e,r,"current"===s)];case 3:i=u.sent(),n.isPrimaryClient&&am(n.remoteStore,a),u.label=4;case 4:return[2,i]}}))}))}function Zm(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,a,s,u,l;return h(this,(function(f){switch(f.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,a;return h(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,gy(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(fb(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,gy(t.localStore,e,!0)];case 1:return i=f.sent(),o=new Qm(e,i.Bn),a=o._o(i.documents),s=Rd.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(a,t.isPrimaryClient,s),fb(t,n,u.To),l=new Ym(e,n,o),[2,(t.Po.set(e,l),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function tb(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return n=rf(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Cp(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,vy(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),sm(n.remoteStore,r.targetId),hb(n,r.targetId)})).catch(Lg)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return hb(n,r.targetId),[4,vy(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function eb(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a;return h(this,(function(s){switch(s.label){case 0:r=Nb(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=rf(t),i=hf.now(),o=e.reduce((function(t,e){return t.add(e.key)}),kd());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],h=td(c,n.get(c.key));null!=h&&a.push(new id(c.key,h,zf(h.value.mapValue),Yp.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new vd(sf)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,vb(r,i.changes)];case 3:return s.sent(),[4,bm(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=Pm(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function nb(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:n=rf(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,ly(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(nf(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?nf(r.bo):t.removedDocuments.size>0&&(nf(r.bo),r.bo=!1))})),[4,vb(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Lg(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function rb(t,e,n){var r=rf(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=rf(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&qm(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function ib(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a,s,u;return h(this,(function(c){switch(c.label){case 0:return(r=rf(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new vd(Rf.comparator)).insert(o,Qf.newNoDocument(o,lf.min())),s=kd().add(o),u=new Pd(lf.min(),new Map,new md(sf),a,s),[4,nb(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),db(r),[3,4];case 2:return[4,vy(r.localStore,e,!1).then((function(){return hb(r,e,n)})).catch(Lg)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function ob(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:n=rf(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,cy(n.localStore,e)];case 2:return i=o.sent(),cb(n,r,null),ub(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,vb(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Lg(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function ab(t,e,n){return c(this,void 0,void 0,(function(){var r,i;return h(this,(function(o){switch(o.label){case 0:r=rf(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=rf(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return nf(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),cb(r,e,n),ub(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,vb(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Lg(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function sb(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a;return h(this,(function(s){switch(s.label){case 0:fm((n=rf(t)).remoteStore)||$l("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=rf(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=Pm(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function ub(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function cb(t,e,n){var r=rf(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function hb(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||lb(t,e)}))}function lb(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(sm(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),db(t))}function fb(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Gm?(t.No.addReference(o.key,e),pb(t,o)):o instanceof zm?($l("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||lb(t,o.key)):ef()}}function pb(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||($l("SyncEngine","New document in limbo: "+n),t.So.add(r),db(t))}function db(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Rf(gf.fromString(e)),r=t.ko.next();t.Co.set(r,new Xm(n)),t.Do=t.Do.insert(n,r),am(t.remoteStore,new ng(Ep(yp(n.path)),r,2,Gl.o))}}function vb(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a;return h(this,(function(s){switch(s.label){case 0:return r=rf(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){a.push(r.Oo(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=iy.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return h(this,(function(h){switch(h.label){case 0:n=rf(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Bv.forEach(e,(function(e){return Bv.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Bv.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!zv(r=h.sent()))throw r;return $l("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.Fn.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(s,l));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function gb(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return(n=rf(t)).currentUser.isEqual(e)?[3,3]:($l("SyncEngine","User change. New user:",e.toKey()),[4,uy(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new Ql(zl.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,vb(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function yb(t,e){var n=rf(t),r=n.Co.get(e);if(r&&r.bo)return kd().add(r.key);var i=kd(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function mb(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return[4,gy((n=rf(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&fb(n,e.targetId,i.To),i)]}}))}))}function bb(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){return[2,my((e=rf(t)).localStore).then((function(t){return vb(e,t)}))]}))}))}function _b(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o;return h(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=rf(t),r=rf(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Bv.resolve(null)}))}))}((i=rf(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,bm(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(cb(i,e,r||null),ub(i,e),function(t,e){rf(rf(t)._n).Gt(e)}(i.localStore,e)):ef(),a.label=4;case 4:return[4,vb(i,o)];case 5:return a.sent(),[3,7];case 6:$l("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function wb(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return h(this,(function(h){switch(h.label){case 0:return kb(n=rf(t)),Nb(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Ib(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,Cm(n.remoteStore,!0)];case 2:for(h.sent(),o=0,a=i;o<a.length;o++)s=a[o],am(n.remoteStore,s);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return hb(n,e),vy(n.localStore,e,!0)})),sm(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,Ib(n,u)];case 5:return h.sent(),function(t){var e=rf(t);e.Co.forEach((function(t,n){sm(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new vd(Rf.comparator)}(n),n.$o=!1,[4,Cm(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function Ib(t,e,n){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,p,d,v,g;return h(this,(function(h){switch(h.label){case 0:n=rf(t),r=[],i=[],o=0,a=e,h.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(c=n.Vo.get(s))&&0!==c.length?[4,dy(n.localStore,Ep(c[0]))]:[3,7]):[3,13];case 2:u=h.sent(),l=0,f=c,h.label=3;case 3:return l<f.length?(p=f[l],d=n.Po.get(p),[4,mb(n,d)]):[3,6];case 4:(v=h.sent()).snapshot&&i.push(v.snapshot),h.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,yy(n.localStore,s)];case 8:return g=h.sent(),[4,dy(n.localStore,g)];case 9:return u=h.sent(),[4,Zm(n,Tb(g),s,!1)];case 10:h.sent(),h.label=11;case 11:r.push(u),h.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function Tb(t){return gp(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Eb(t){var e=rf(t);return rf(rf(e.localStore).persistence).fn()}function Sb(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,a;return h(this,(function(s){switch(s.label){case 0:return(i=rf(t)).$o?($l("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,my(i.localStore)];case 3:return o=s.sent(),a=Pd.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,vb(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,vy(i.localStore,e,!0)];case 6:return s.sent(),hb(i,e,r),[3,8];case 7:ef(),s.label=8;case 8:return[2]}}))}))}function Cb(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,f,p;return h(this,(function(d){switch(d.label){case 0:if(!(r=kb(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?($l("SyncEngine","Adding an already active target "+a),[3,5]):[4,yy(r.localStore,a)]):[3,6];case 2:return s=d.sent(),[4,dy(r.localStore,s)];case 3:return u=d.sent(),[4,Zm(r,Tb(s),u.targetId,!1)];case 4:d.sent(),am(r.remoteStore,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return h(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,vy(r.localStore,t,!1).then((function(){sm(r.remoteStore,t),hb(r,t)})).catch(Lg)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,f=n,d.label=7;case 7:return l<f.length?(p=f[l],[5,c(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function kb(t){var e=rf(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=nb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ib.bind(null,e),e.vo._r=Um.bind(null,e.eventManager),e.vo.Mo=jm.bind(null,e.eventManager),e}function Nb(t){var e=rf(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ob.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ab.bind(null,e),e}function Ab(t,e,n){var r=rf(t);(function(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a,s,u;return h(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=rf(t),r=Hd(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Ke.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(Hm(r)),i=new Wm(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=c.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return s=c.sent(),[4,vb(t,s.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=rf(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Ke.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(s.progress),[3,15];case 14:return Zl("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(
/**
    * @license
    * Copyright 2020 Google LLC
    *
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    *   http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    */
r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var Pb=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return this.R=Xy(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return sy(this.persistence,new oy,t.initialUser,this.R)},t.prototype.qo=function(t){return new Ay(Ry.bs,this.R)},t.prototype.Bo=function(t){return new By},t.prototype.terminate=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Rb=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return s(e,t),e.prototype.initialize=function(e){return c(this,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,by(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,Nb(this.Qo.syncEngine)];case 4:return n.sent(),[4,bm(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return sy(this.persistence,new oy,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Ug(e,t.asyncQueue)},e.prototype.qo=function(t){var e=ey(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ig.withCacheSize(this.cacheSizeBytes):Ig.DEFAULT;return new Jg(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Qy(),Yy(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new By},e}(Pb),Db=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return s(e,t),e.prototype.initialize=function(e){return c(this,void 0,void 0,(function(){var n,r=this;return h(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Vy?(this.sharedClientState.syncEngine={ui:_b.bind(null,n),ai:Sb.bind(null,n),hi:Cb.bind(null,n),fn:Eb.bind(null,n),ci:bb.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return c(r,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return[4,wb(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Qy();if(!Vy.yt(e))throw new Ql(zl.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ey(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Vy(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Rb),Ob=function(){function t(){}return t.prototype.initialize=function(t,e){return c(this,void 0,void 0,(function(){var n=this;return h(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return rb(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=gb.bind(null,this.syncEngine),[4,Cm(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Lm},t.prototype.createDatastore=function(t){var e,n=Xy(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new zy(e));return function(t,e,n){return new em(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return rb(a.syncEngine,t,0)},o=Wy.yt()?new Wy:new Ky,new rm(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new $m(t,e,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=rf(t),$l("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,om(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function xb(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return c(this,void 0,void 0,(function(){var r;return h(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Lb=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Mb=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Vv,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return c(this,void 0,void 0,(function(){var t,e,n,r;return h(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Bm(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return c(this,void 0,void 0,(function(){var t,e;return h(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return c(this,void 0,void 0,(function(){var t,e;return h(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),Fb=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return c(this,void 0,void 0,(function(){var e,n=this;return h(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Ql(zl.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return n=rf(t),r=Jd(n.R)+"/documents",i={documents:e.map((function(t){return Qd(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){nf(!!e.found),e.found.name,e.found.updateTime;var n=Yd(t,e.found.name),r=Hd(e.found.updateTime),i=new Gf({mapValue:{fields:e.found.fields}});return Qf.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){nf(!!e.missing),nf(!!e.readTime);var n=Yd(t,e.missing),r=Hd(e.readTime);return Qf.newNoDocument(n,r)}(t,e):ef()}(n.R,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());nf(!!e),s.push(e)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new hd(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return c(this,void 0,void 0,(function(){var t,e=this;return h(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Rf.fromPath(n);e.mutations.push(new ld(r,e.precondition(r)))})),[4,function(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return n=rf(t),r=Jd(n.R)+"/documents",i={writes:e.map((function(t){return nv(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw ef();e=lf.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ql(zl.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Yp.updateTime(e):Yp.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(lf.min()))throw new Ql(zl.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Yp.updateTime(e)}return Yp.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Ub=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new $y(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return c(t,void 0,void 0,(function(){var t,e,n=this;return h(this,(function(r){return t=new Fb(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Nf(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!pd(e)}return!1},t}(),jb=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Dy.UNAUTHENTICATED,this.clientId=af.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return c(r,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return $l("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ql(zl.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Vv;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return c(t,void 0,void 0,(function(){var t,n;return h(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Pm(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function qb(t,e){return c(this,void 0,void 0,(function(){var n,r,i=this;return h(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),$l("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return c(i,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,uy(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Vb(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Bb(t)];case 1:return n=i.sent(),$l("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return(n=rf(t)).asyncQueue.verifyOperationInProgress(),$l("RemoteStore","RemoteStore received new credentials"),r=fm(n),n.Or.add(3),[4,om(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,im(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Bb(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:($l("FirestoreClient","Using default OfflineComponentProvider"),[4,qb(t,new Pb)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Kb(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:($l("FirestoreClient","Using default OnlineComponentProvider"),[4,Vb(t,new Ob)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Wb(t){return Bb(t).then((function(t){return t.persistence}))}function Hb(t){return Bb(t).then((function(t){return t.localStore}))}function Gb(t){return Kb(t).then((function(t){return t.remoteStore}))}function zb(t){return Kb(t).then((function(t){return t.syncEngine}))}function Qb(t){return c(this,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:return[4,Kb(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Jm.bind(null,e.syncEngine),n.onUnlisten=tb.bind(null,e.syncEngine),n)]}}))}))}function Yb(t,e,n){var r=this;void 0===n&&(n={});var i=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(r,void 0,void 0,(function(){var r;return h(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Lb({next:function(o){e.enqueueAndForget((function(){return Fm(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Ql(zl.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Ql(zl.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new Vm(yp(n.path),o,{includeMetadataChanges:!0,so:!0});return Mm(t,a)},[4,Qb(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Xb(t,e,n){var r=this;void 0===n&&(n={});var i=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(r,void 0,void 0,(function(){var r;return h(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Lb({next:function(n){e.enqueueAndForget((function(){return Fm(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Ql(zl.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new Vm(n,o,{includeMetadataChanges:!0,so:!0});return Mm(t,a)},[4,Qb(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var $b=function(t,e,n,r,i,o,a,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},Jb=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Zb=new Map,t_=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},e_=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Dy.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),n_=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),r_=function(){function t(t){var e=this;this.currentUser=Dy.UNAUTHENTICATED,this.oc=new Vv,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){$l("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):($l("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?($l("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(nf("string"==typeof n.accessToken),new t_(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return c(n,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return nf(null===t||"string"==typeof t),new Dy(t)},t}(),i_=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Dy.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),o_=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new i_(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Dy.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function a_(t,e,n){if(!n)throw new Ql(zl.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function s_(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ql(zl.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function u_(t,e,n,r){if(!0===e&&!0===r)throw new Ql(zl.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function c_(t){if(!Rf.isDocumentKey(t))throw new Ql(zl.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function h_(t){if(Rf.isDocumentKey(t))throw new Ql(zl.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function l_(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":ef()}function f_(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ql(zl.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=l_(t);throw new Ql(zl.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function p_(t,e){if(e<=0)throw new Ql(zl.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var d_=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ql(zl.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ql(zl.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,u_("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),v_=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new d_({}),this._settingsFrozen=!1,t instanceof Jb?(this._databaseId=t,this._credentials=new e_):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ql(zl.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jb(t.options.projectId)}(t),this._credentials=new r_(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Ql(zl.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Ql(zl.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new d_(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new e_;switch(t.type){case"gapi":var e=t.client;return nf(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new o_(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ql(zl.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Zb.get(this))&&($l("ComponentProvider","Removing Datastore"),Zb.delete(this),t.terminate()),Promise.resolve();var t},t}(),g_=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new m_(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),y_=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),m_=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,yp(r))||this)._path=r,i.type="collection",i}return s(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new g_(this.firestore,null,new Rf(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(y_);
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function b_(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=nt(t),a_("collection","path",e),t instanceof v_)return h_(n=gf.fromString.apply(gf,p([e],r))),new m_(t,null,n);if(!(t instanceof g_||t instanceof m_))throw new Ql(zl.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return h_(n=gf.fromString.apply(gf,p([t.path],r)).child(gf.fromString(e))),new m_(t.firestore,null,n)}function __(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=nt(t),1===arguments.length&&(e=af.u()),a_("doc","path",e),t instanceof v_)return c_(n=gf.fromString.apply(gf,p([e],r))),new g_(t,null,new Rf(n));if(!(t instanceof g_||t instanceof m_))throw new Ql(zl.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return c_(n=t._path.child(gf.fromString.apply(gf,p([e],r)))),new g_(t.firestore,t instanceof m_?t.converter:null,new Rf(n))}function w_(t,e){return t=nt(t),e=nt(e),(t instanceof g_||t instanceof m_)&&(e instanceof g_||e instanceof m_)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function I_(t,e){return t=nt(t),e=nt(e),t instanceof y_&&e instanceof y_&&t.firestore===e.firestore&&Cp(t._query,e._query)&&t.converter===e.converter}var T_=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new $y(this,"async_queue_retry"),this.Tc=function(){var e=Yy();e&&$l("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Yy();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Yy();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise((function(t){})):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.Rc()}))},t.prototype.Rc=function(){return c(this,void 0,void 0,(function(){var t,e=this;return h(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!zv(t=n.sent()))throw t;return $l("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.Rc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ac=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Jl("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=Am.createAndSchedule(this,t,e,n,(function(t){return r.bc(t)}));return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&ef()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()}))},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function E_(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var S_=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Vv,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),C_=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new T_,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return s(e,t),e.prototype._terminate=function(){return this._firestoreClient||N_(this),this._firestoreClient.terminate()},e}(v_);
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function k_(t){return t._firestoreClient||N_(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function N_(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new $b(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new jb(t._credentials,t._queue,r)}function A_(t,e,n){var r=this,i=new Vv;return t.asyncQueue.enqueue((function(){return c(r,void 0,void 0,(function(){var r;return h(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,qb(t,n)];case 1:return o.sent(),[4,Vb(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===zl.FAILED_PRECONDITION||t.code===zl.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function P_(t){if(t._initialized||t._terminated)throw new Ql(zl.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var R_=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ql(zl.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mf(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),D_=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(_f.fromBase64String(e))}catch(e){throw new Ql(zl.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(_f.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),O_=function(t){this._methodName=t},x_=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ql(zl.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ql(zl.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return sf(this._lat,t._lat)||sf(this._long,t._long)},t}(),L_=/^__.*__$/,M_=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new id(t,this.data,this.fieldMask,e,this.fieldTransforms):new rd(t,this.data,e,this.fieldTransforms)},t}(),F_=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new id(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function U_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ef()}}var j_=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return ow(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(U_(this.Cc)&&L_.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),q_=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Xy(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new j_({Cc:t,methodName:e,Bc:n,path:mf.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function V_(t){var e=t._freezeSettings(),n=Xy(t._databaseId);return new q_(t._databaseId,!!e.ignoreUndefinedProperties,n)}function B_(t,e,n,r,i,o){void 0===o&&(o={});var a=t.qc(o.merge||o.mergeFields?2:0,e,n,i);ew("Data must be an object, but it was:",a,r);var s,u,c=Z_(r,a);if(o.merge)s=new bf(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=nw(e,f[l],n);if(!a.contains(p))throw new Ql(zl.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");aw(h,p)||h.push(p)}s=new bf(h),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new M_(new Gf(c),s,u)}var K_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+"() can only appear at the top level of your update data"):t.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(O_);function W_(t,e,n){return new j_({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var H_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._toFieldTransform=function(t){return new zp(t.path,new jp)},e.prototype.isEqual=function(t){return t instanceof e},e}(O_),G_=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return s(e,t),e.prototype._toFieldTransform=function(t){var e=W_(this,t,!0),n=this.Uc.map((function(t){return J_(t,e)})),r=new qp(n);return new zp(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(O_),z_=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return s(e,t),e.prototype._toFieldTransform=function(t){var e=W_(this,t,!0),n=this.Uc.map((function(t){return J_(t,e)})),r=new Bp(n);return new zp(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(O_),Q_=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return s(e,t),e.prototype._toFieldTransform=function(t){var e=new Wp(t.R,xp(t.R,this.Kc));return new zp(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(O_);function Y_(t,e,n,r){var i=t.qc(1,e,n);ew("Data must be an object, but it was:",i,r);var o=[],a=Gf.empty();pf(r,(function(t,r){var s=iw(e,t,n);r=nt(r);var u=i.$c(s);if(r instanceof K_)o.push(s);else{var c=J_(r,u);null!=c&&(o.push(s),a.set(s,c))}}));var s=new bf(o);return new F_(a,s,i.fieldTransforms)}function X_(t,e,n,r,i,o){var a=t.qc(1,e,n),s=[nw(e,r,n)],u=[i];if(o.length%2!=0)throw new Ql(zl.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(nw(e,o[c])),u.push(o[c+1]);for(var h=[],l=Gf.empty(),f=s.length-1;f>=0;--f)if(!aw(h,s[f])){var p=s[f],d=u[f];d=nt(d);var v=a.$c(p);if(d instanceof K_)h.push(p);else{var g=J_(d,v);null!=g&&(h.push(p),l.set(p,g))}}var y=new bf(h);return new F_(l,y,a.fieldTransforms)}function $_(t,e,n,r){return void 0===r&&(r=!1),J_(n,t.qc(r?4:3,e))}function J_(t,e){if(tw(t=nt(t)))return ew("Unsupported field value:",e,t),Z_(t,e);if(t instanceof O_)return function(t,e){if(!U_(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=J_(o[i],e.Oc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=nt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return xp(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hf.fromDate(t);return{timestampValue:Bd(e.R,n)}}if(t instanceof hf)return n=new hf(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Bd(e.R,n)};if(t instanceof x_)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof D_)return{bytesValue:Kd(e.R,t._byteString)};if(t instanceof g_){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Gd(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+l_(t))}(t,e)}function Z_(t,e){var n={};return df(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pf(t,(function(t,r){var i=J_(r,e.xc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function tw(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hf||t instanceof x_||t instanceof D_||t instanceof g_||t instanceof O_)}function ew(t,e,n){if(!tw(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=l_(n);throw"an object"===r?e.Mc(t+" a custom object"):e.Mc(t+" "+r)}}function nw(t,e,n){if((e=nt(e))instanceof R_)return e._internalPath;if("string"==typeof e)return iw(t,e);throw ow("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var rw=new RegExp("[~\\*/\\[\\]]");function iw(t,e,n){if(e.search(rw)>=0)throw ow("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(R_.bind.apply(R_,p([void 0],e.split(".")))))._internalPath}catch(r){throw ow("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ow(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new Ql(zl.INVALID_ARGUMENT,(s+=". ")+t+u)}function aw(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var sw=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new g_(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new uw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(cw("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),uw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(sw);function cw(t,e){return"string"==typeof e?iw(t,e):e instanceof R_?e._internalPath:e._delegate._internalPath}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var hw=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),lw=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return s(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new fw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(cw("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(sw),fw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(lw),pw=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new hw(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new fw(n._firestore,n._userDataWriter,r.key,r,new hw(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ql(zl.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new fw(t._firestore,t._userDataWriter,e.doc.key,e.doc,new hw(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new fw(t._firestore,t._userDataWriter,e.doc.key,e.doc,new hw(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:dw(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function dw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ef()}}function vw(t,e){return t instanceof lw&&e instanceof lw?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof pw&&e instanceof pw&&t._firestore===e._firestore&&I_(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function gw(t){if(bp(t)&&0===t.explicitOrderBy.length)throw new Ql(zl.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var yw=function(){};function mw(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var bw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return s(e,t),e.prototype._apply=function(t){var e=V_(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Ql(zl.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Cw(a,o);for(var u=[],c=0,h=a;c<h.length;c++){var l=h[c];u.push(Sw(r,t,l))}s={arrayValue:{values:u}}}else s=Sw(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Cw(a,o),s=$_(n,"where",a,"in"===o||"not-in"===o);var f=tp.create(i,o,s);return function(t,e){if(e.g()){var n=wp(t);if(null!==n&&!n.isEqual(e.field))throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=_p(t);null!==r&&kw(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Ql(zl.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ql(zl.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new y_(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new vp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(yw),_w=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return s(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new lp(e,n);return function(t,e){if(null===_p(t)){var n=wp(t);null!==n&&kw(t,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new y_(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new vp(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(yw),ww=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return s(e,t),e.prototype._apply=function(t){return new y_(t.firestore,t.converter,Sp(t._query,this.zc,this.Hc))},e}(yw),Iw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return s(e,t),e.prototype._apply=function(t){var e=Ew(t,this.type,this.Jc,this.Yc);return new y_(t.firestore,t.converter,function(t,e){return new vp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(yw),Tw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return s(e,t),e.prototype._apply=function(t){var e=Ew(t,this.type,this.Jc,this.Yc);return new y_(t.firestore,t.converter,function(t,e){return new vp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(yw);function Ew(t,e,n,r){if(n[0]=nt(n[0]),n[0]instanceof sw)return function(t,e,n,r,i){if(!r)throw new Ql(zl.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Tp(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(jf(e,r.key));else{var c=r.data.field(u.field);if(Sf(c))throw new Ql(zl.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new cp(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=V_(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new Ql(zl.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Ip(t)&&-1!==c.indexOf("/"))throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(gf.fromString(c));if(!Rf.isDocumentKey(h))throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Rf(h);s.push(jf(e,l))}else{var f=$_(n,r,c);s.push(f)}}return new cp(s,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Sw(t,e,n){if("string"==typeof(n=nt(n))){if(""===n)throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ip(e)&&-1!==n.indexOf("/"))throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(gf.fromString(n));if(!Rf.isDocumentKey(r))throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return jf(t,new Rf(r))}if(n instanceof g_)return jf(t,n._key);throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+l_(n)+".")}function Cw(t,e){if(!Array.isArray(t)||0===t.length)throw new Ql(zl.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ql(zl.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function kw(t,e,n){if(!n.isEqual(e))throw new Ql(zl.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Nw=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Df(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Tf(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ef(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ef()}},t.prototype.convertObject=function(t,e){var n=this,r={};return pf(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new x_(Tf(t.latitude),Tf(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Cf(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(kf(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=If(t);return new hf(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=gf.fromString(t);nf(yv(n));var r=new Jb(n.get(1),n.get(3)),i=new Rf(n.popFirst(5));return r.isEqual(e)||Jl("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Aw(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Pw=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return s(e,t),e.prototype.convertBytes=function(t){return new D_(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new g_(this.firestore,null,e)},e}(Nw),Rw=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=V_(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Dw(t,this._firestore),i=Aw(r.converter,e,n),o=B_(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Yp.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,a=Dw(t,this._firestore);return o="string"==typeof(e=nt(e))||e instanceof R_?X_(this._dataReader,"WriteBatch.update",a._key,e,n,r):Y_(this._dataReader,"WriteBatch.update",a._key,e),this._mutations.push(o.toMutation(a._key,Yp.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Dw(t,this._firestore);return this._mutations=this._mutations.concat(new hd(e._key,Yp.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Ql(zl.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Dw(t,e){if((t=nt(t)).firestore!==e)throw new Ql(zl.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Ow=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return s(e,t),e.prototype.convertBytes=function(t){return new D_(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new g_(this.firestore,null,e)},e}(Nw);function xw(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=f_(t,g_);var o=f_(t.firestore,C_),a=V_(o);return Mw(o,[("string"==typeof(e=nt(e))||e instanceof R_?X_(a,"updateDoc",t._key,e,n,r):Y_(a,"updateDoc",t._key,e)).toMutation(t._key,Yp.exists(!0))])}function Lw(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=nt(t);var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||E_(i[s])||(a=i[s],s++);var u,l,f,p={includeMetadataChanges:a.includeMetadataChanges};if(E_(i[s])){var d=i[s];i[s]=null===(e=d.next)||void 0===e?void 0:e.bind(d),i[s+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),i[s+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof g_)l=f_(t.firestore,C_),f=yp(t._key.path),u={next:function(e){i[s]&&i[s](Fw(l,t,e))},error:i[s+1],complete:i[s+2]};else{var v=f_(t,y_);l=f_(v.firestore,C_),f=v._query;var g=new Ow(l);u={next:function(t){i[s]&&i[s](new pw(l,g,v,t))},error:i[s+1],complete:i[s+2]},gw(t._query)}return function(t,e,n,r){var i=this,o=new Lb(r),a=new Vm(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return c(i,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=Mm,[4,Qb(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return c(i,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=Fm,[4,Qb(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(k_(l),f,p,u)}function Mw(t,e){return function(t,e){var n=this,r=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(n,void 0,void 0,(function(){var n;return h(this,(function(i){switch(i.label){case 0:return n=eb,[4,zb(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(k_(t),e)}function Fw(t,e,n){var r=n.docs.get(e._key),i=new Ow(t);return new lw(t,i,e._key,r,new hw(n.hasPendingWrites,n.fromCache),e.converter)}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Uw=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return s(e,t),e.prototype.get=function(e){var n=this,r=Dw(e,this._firestore),i=new Ow(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new lw(n._firestore,i,r._key,t._document,new hw(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=V_(t)}return t.prototype.get=function(t){var e=this,n=Dw(t,this._firestore),r=new Pw(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return ef();var i=t[0];if(i.isFoundDocument())return new sw(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new sw(e._firestore,r,n._key,null,n.converter);throw ef()}))},t.prototype.set=function(t,e,n){var r=Dw(t,this._firestore),i=Aw(r.converter,e,n),o=B_(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a=Dw(t,this._firestore);return o="string"==typeof(e=nt(e))||e instanceof R_?X_(this._dataReader,"Transaction.update",a._key,e,n,r):Y_(this._dataReader,"Transaction.update",a._key,e),this._transaction.update(a._key,o),this},t.prototype.delete=function(t){var e=Dw(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function jw(){if("undefined"==typeof Uint8Array)throw new Ql(zl.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qw(){if("undefined"==typeof atob)throw new Ql(zl.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Vw=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return qw(),new t(D_.fromBase64String(e))},t.fromUint8Array=function(e){return jw(),new t(D_.fromUint8Array(e))},t.prototype.toBase64=function(){return qw(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return jw(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Bw=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){P_(t=f_(t,C_));var n=k_(t),r=t._freezeSettings(),i=new Ob;return A_(n,i,new Rb(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){P_(t=f_(t,C_));var e=k_(t),n=t._freezeSettings(),r=new Ob;return A_(e,r,new Db(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Ql(zl.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Vv;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return c(e,void 0,void 0,(function(){var e;return h(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return Wv.yt()?(e=t+"main",[4,Wv.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(ey(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Kw=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Jb||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Zl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=f_(t,v_))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Zl("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=S(r.mockUserToken),a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Ql(zl.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new n_(new t_(o,new Dy(a)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return c(e,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:return[4,Wb(t)];case 1:return e=r.sent(),[4,Gb(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=rf(t);return e.Or.delete(0),im(e)}(n))]}}))}))}))}(k_(f_(this._delegate,C_)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return c(e,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:return[4,Wb(t)];case 1:return e=r.sent(),[4,Gb(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return(e=rf(t)).Or.add(0),[4,om(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(k_(f_(this._delegate,C_)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&u_("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(e,void 0,void 0,(function(){var e;return h(this,(function(r){switch(r.label){case 0:return e=sb,[4,zb(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(k_(f_(this._delegate,C_)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Lb(e);return t.asyncQueue.enqueueAndForget((function(){return c(n,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=function(t,e){rf(t).Gr.add(e),e.next()},[4,Qb(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return c(n,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=function(t,e){rf(t).Gr.delete(e)},[4,Qb(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(k_(t=f_(t,C_)),E_(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Ql(zl.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new rI(this,b_(this._delegate,t))}catch(t){throw Yw(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Qw(this,__(this._delegate,t))}catch(t){throw Yw(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new tI(this,function(t,e){if(t=f_(t,v_),a_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ql(zl.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new y_(t,null,function(t){return new vp(gf.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Yw(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(n,void 0,void 0,(function(){var n;return h(this,(function(i){switch(i.label){case 0:return[4,function(t){return Kb(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Ub(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(k_(t),(function(n){return e(new Uw(t,n))}))}(this._delegate,(function(n){return t(new Hw(e,n))}))},t.prototype.batch=function(){var t=this;return k_(this._delegate),new Gw(new Rw(this._delegate,(function(e){return Mw(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Ql(zl.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Ql(zl.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Ww=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return s(e,t),e.prototype.convertBytes=function(t){return new Vw(new D_(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Qw.tu(e,this.firestore,null)},e}(Nw);var Hw=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Ww(t)}return t.prototype.get=function(t){var e=this,n=iI(t);return this._delegate.get(n).then((function(t){return new Jw(e._firestore,new lw(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=iI(t);return n?(s_("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=iI(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,p([a,e,n],i)),this},t.prototype.delete=function(t){var e=iI(t);return this._delegate.delete(e),this},t}(),Gw=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=iI(t);return n?(s_("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=iI(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,p([a,e,n],i)),this},t.prototype.delete=function(t){var e=iI(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),zw=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new fw(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Zw(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Ww(e),n),i.set(n,o)),o},t}();zw.nu=new WeakMap;var Qw=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ww(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Ql(zl.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new g_(n._delegate,r,new Rf(e)))},t.tu=function(e,n,r){return new t(n,new g_(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new rI(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new rI(this.firestore,b_(this._delegate,t))}catch(t){throw Yw(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=nt(t))instanceof g_&&w_(this._delegate,t)},t.prototype.set=function(t,e){e=s_("DocumentReference.set",e);try{return function(t,e,n){t=f_(t,g_);var r=f_(t.firestore,C_),i=Aw(t.converter,e,n);return Mw(r,[B_(V_(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Yp.none())])}(this._delegate,t,e)}catch(t){throw Yw(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?xw(this._delegate,t):xw.apply(void 0,p([this._delegate,t,e],n))}catch(t){throw Yw(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Mw(f_((t=this._delegate).firestore,C_),[new hd(t._key,Yp.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Xw(e),i=$w(e,(function(e){return new Jw(t.firestore,new lw(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Lw(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=f_(t,g_);var e=f_(t.firestore,C_),n=k_(e),r=new Ow(e);return function(t,e){var n=this,r=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(n,void 0,void 0,(function(){var n;return h(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return c(this,void 0,void 0,(function(){var r,i;return h(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=rf(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Ql(zl.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Pm(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Hb(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new lw(e,r,t._key,n,new hw(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=f_(t,g_);var e=f_(t.firestore,C_);return Yb(k_(e),t._key,{source:"server"}).then((function(n){return Fw(e,t,n)}))}(this._delegate):function(t){t=f_(t,g_);var e=f_(t.firestore,C_);return Yb(k_(e),t._key).then((function(n){return Fw(e,t,n)}))}(this._delegate)).then((function(t){return new Jw(e.firestore,new lw(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(zw.eu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Yw(t,e,n){return t.message=t.message.replace(e,n),t}function Xw(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!E_(r))return r}return{}}function $w(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=E_(t[0])?t[0]:E_(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Jw=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Qw(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return vw(this._delegate,t._delegate)},t}(),Zw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Jw),tI=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ww(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,mw(this._delegate,function(t,e,n){var r=e,i=cw("where",t);return new bw(i,r,n)}(e,n,r)))}catch(e){throw Yw(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,mw(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=cw("orderBy",t);return new _w(r,n)}(e,n)))}catch(e){throw Yw(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,mw(this._delegate,function(t){return p_("limit",t),new ww("limit",t,"F")}(e)))}catch(e){throw Yw(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,mw(this._delegate,function(t){return p_("limitToLast",t),new ww("limitToLast",t,"L")}(e)))}catch(e){throw Yw(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Iw("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Yw(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Iw("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Yw(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Tw("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Yw(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,mw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Tw("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Yw(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return I_(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=f_(t,y_);var e=f_(t.firestore,C_),n=k_(e),r=new Ow(e);return function(t,e){var n=this,r=new Vv;return t.asyncQueue.enqueueAndForget((function(){return c(n,void 0,void 0,(function(){var n;return h(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,gy(t,e,!0)];case 1:return s=u.sent(),r=new Qm(e,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=Pm(a,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,Hb(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new pw(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=f_(t,y_);var e=f_(t.firestore,C_),n=k_(e),r=new Ow(e);return Xb(n,t._query,{source:"server"}).then((function(n){return new pw(e,r,t,n)}))}(this._delegate):function(t){t=f_(t,y_);var e=f_(t.firestore,C_),n=k_(e),r=new Ow(e);return gw(t._query),Xb(n,t._query).then((function(n){return new pw(e,r,t,n)}))}(this._delegate)).then((function(t){return new nI(e.firestore,new pw(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Xw(e),i=$w(e,(function(e){return new nI(t.firestore,new pw(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Lw(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(zw.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),eI=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Zw(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),nI=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new tI(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Zw(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new eI(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Zw(n._firestore,r))}))},t.prototype.isEqual=function(t){return vw(this._delegate,t._delegate)},t}(),rI=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return s(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Qw(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Qw(this.firestore,void 0===t?__(this._delegate):__(this._delegate,t))}catch(t){throw Yw(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=f_(t.firestore,C_),r=__(t),i=Aw(t.converter,e);return Mw(n,[B_(V_(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Yp.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Qw(e.firestore,t)}))},e.prototype.isEqual=function(t){return w_(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(zw.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(tI);function iI(t){return f_(t,g_)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var oI=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(R_.bind.apply(R_,p([void 0],t)))}return t.documentId=function(){return new t(mf.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=nt(t))instanceof R_&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),aI=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new H_("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new K_("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new G_("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new z_("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Q_("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function sI(t){return function(t,e){var n=k_(t=f_(t,C_)),r=new S_;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new Mb(t,e)}(function(t,e){if(t instanceof Uint8Array)return xb(t,e);if(t instanceof ArrayBuffer)return xb(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,Xy(e));t.asyncQueue.enqueueAndForget((function(){return c(i,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return e=Ab,[4,zb(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)}function uI(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return c(n,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=rf(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Ke.getNamedQuery(t,e)}))},[4,Hb(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(k_(e=f_(e,C_)),n).then((function(t){return t?new y_(e,null,t.query):null}))).then((function(t){return t?new tI(r,t):null}))}var cI,hI,lI={Firestore:Kw,GeoPoint:x_,Timestamp:hf,Blob:Vw,Transaction:Hw,WriteBatch:Gw,DocumentReference:Qw,DocumentSnapshot:Jw,Query:tI,QueryDocumentSnapshot:Zw,QuerySnapshot:nI,CollectionReference:rI,FieldPath:oI,FieldValue:aI,setLogLevel:function(t){var e;e=t,Yl.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(function(t,e){t.INTERNAL.registerComponent(new rt("firestore",(function(t){return function(t,e){return new Kw(t,new C_(t,e),new Bw)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},lI)))})(cI=Lt),cI.registerVersion("@firebase/firestore","2.3.8"),(hI=Kw).prototype.loadBundle=sI,hI.prototype.namedQuery=uI;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var fI={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},pI=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return s(e,t),e}(Error);var dI=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return c(this,void 0,void 0,(function(){var t,e;return h(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function vI(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var gI=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return vI(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?vI(t,(function(t){return e.decode(t)})):t},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var yI=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new gI,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new dI(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o;return h(this,(function(a){switch(a.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=a.sent())&&(n["X-Firebase-AppCheck"]=r),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=a.sent(),[3,5];case 4:return a.sent(),[2,{status:0,json:null}];case 5:o=null,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,i.json()];case 7:return o=a.sent(),[3,9];case 8:return a.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,f,p,d;return h(this,(function(h){switch(h.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=h.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new pI("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(s),c=u.timer,l=u.promise,[4,Promise.race([mI(c,this.postJSON(r,i,o)),l,mI(c,this.cancelAllRequests)])];case 2:if(!(f=h.sent()))throw new pI("cancelled","Firebase Functions instance was deleted.");if(p=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!fI[s])return new pI("internal","internal");r=fI[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new pI(r,i,o)}(f.status,f.json,this.serializer))throw p;if(!f.json)throw new pI("internal","Response is not valid JSON object.");if(void 0===(d=f.json.data)&&(d=f.json.result),void 0===d)throw new pI("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function mI(t,e){return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var bI,_I,wI;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
bI=Lt,_I=fetch.bind(self),wI={Functions:yI},bI.INTERNAL.registerComponent(new rt("functions",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new yI(r,i,a,o,n,_I)}),"PUBLIC").setServiceProps(wI).setMultipleInstances(!0)),Lt.registerVersion("@firebase/functions","0.6.13");var II={};!function(t,e){"object"==typeof II?e(II):e((t=t||self).idb={})}(II,(function(t){function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function d(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),a(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(l,"_store",["name","keyPath","indexNames","autoIncrement"]),a(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}));var TI,EI="0.4.30",SI=1e4,CI="w:0.4.30",kI="FIS_v2",NI=36e5,AI=((TI={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',TI["not-registered"]="Firebase Installation is not registered.",TI["installation-not-found"]="Firebase Installation not found.",TI["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',TI["app-offline"]="Could not process request. Application offline.",TI["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",TI),PI=new M("installations","Installations",AI);function RI(t){return t instanceof L&&t.code.includes("request-failed")}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function DI(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function OI(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function xI(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,PI.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function LI(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function MI(t,e){var n=e.refreshToken,r=LI(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(n)),r}function FI(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function UI(t,e){var n=e.fid;return c(this,void 0,void 0,(function(){var e,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return e=DI(t),r=LI(t),i={fid:n,authVersion:kI,appId:t.appId,sdkVersion:CI},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,FI((function(){return fetch(e,o)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return s=u.sent(),[2,{fid:s.fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:OI(s.authToken)}];case 3:return[4,xI("Create Installation",a)];case 4:throw u.sent()}}))}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function jI(t){return new Promise((function(e){setTimeout(e,t)}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var qI=/^[cdef][\w-]{21}$/;function VI(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,p([],f(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t);return qI.test(e)?e:""}catch(t){return""}}function BI(t){return t.appName+"!"+t.appId}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var KI=new Map;function WI(t,e){var n=BI(t);HI(n,e),function(t,e){var n=zI();n&&n.postMessage({key:t,fid:e});QI()}(n,e)}function HI(t,e){var n,r,i=KI.get(t);if(i)try{for(var o=l(i),a=o.next();!a.done;a=o.next()){(0,a.value)(e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var GI=null;function zI(){return!GI&&"BroadcastChannel"in self&&((GI=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){HI(t.data.key,t.data.fid)}),GI}function QI(){0===KI.size&&GI&&(GI.close(),GI=null)}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var YI,XI="firebase-installations-store",$I=null;function JI(){return $I||($I=II.openDb("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(XI)}}))),$I}function ZI(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a;return h(this,(function(s){switch(s.label){case 0:return n=BI(t),[4,JI()];case 1:return r=s.sent(),i=r.transaction(XI,"readwrite"),[4,(o=i.objectStore(XI)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||WI(t,e.fid),[2,e]}}))}))}function tT(t){return c(this,void 0,void 0,(function(){var e,n,r;return h(this,(function(i){switch(i.label){case 0:return e=BI(t),[4,JI()];case 1:return n=i.sent(),[4,(r=n.transaction(XI,"readwrite")).objectStore(XI).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function eT(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return n=BI(t),[4,JI()];case 1:return r=u.sent(),i=r.transaction(XI,"readwrite"),[4,(o=i.objectStore(XI)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||WI(t,s.fid),[2,s]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function nT(t){return c(this,void 0,void 0,(function(){var e,n,r;return h(this,(function(i){switch(i.label){case 0:return[4,eT(t,(function(n){var r=function(t){return oT(t||{fid:VI(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(PI.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,UI(t,e)];case 1:return n=i.sent(),[2,ZI(t,n)];case 2:return RI(r=i.sent())&&409===r.customData.serverCode?[4,tT(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,ZI(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:rT(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function rT(t){return c(this,void 0,void 0,(function(){var e,n,r,i;return h(this,(function(o){switch(o.label){case 0:return[4,iT(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,jI(100)];case 3:return o.sent(),[4,iT(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,nT(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function iT(t){return eT(t,(function(t){if(!t)throw PI.create("installation-not-found");return oT(t)}))}function oT(t){return 1===(e=t).registrationStatus&&e.registrationTime+SI<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e;
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */}function aT(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return c(this,void 0,void 0,(function(){var t,i,o,a,s,u,c;return h(this,(function(h){switch(h.label){case 0:return t=function(t,e){var n=e.fid;return DI(t)+"/"+n+"/authTokens:generate"}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(n,e),i=MI(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:CI}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,FI((function(){return fetch(t,s)}))];case 1:return(u=h.sent()).ok?[4,u.json()]:[3,3];case 2:return c=h.sent(),[2,OI(c)];case 3:return[4,xI("Generate Auth Token",u)];case 4:throw h.sent()}}))}))}function sT(t,e){return void 0===e&&(e=!1),c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return[4,eT(t.appConfig,(function(r){if(!cT(r))throw PI.create("not-registered");var i=r.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+NI}(t)}(i))return r;if(1===i.requestStatus)return n=function(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return[4,uT(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,jI(100)];case 3:return i.sent(),[4,uT(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,sT(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw PI.create("app-offline");var o=function(t){var e={requestStatus:1,requestTime:Date.now()};return u(u({},t),{authToken:e})}(r);return n=function(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,aT(t,e)];case 1:return n=o.sent(),i=u(u({},e),{authToken:n}),[4,ZI(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!RI(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,tT(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=u(u({},e),{authToken:{requestStatus:0}}),[4,ZI(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function uT(t){return eT(t,(function(t){if(!cT(t))throw PI.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+SI<Date.now()?u(u({},t),{authToken:{requestStatus:0}}):t}))}function cT(t){return void 0!==t&&2===t.registrationStatus}function hT(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return[4,nT(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function lT(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o;return h(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return DI(t)+"/"+n}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(t,e),r=MI(t,e),i={method:"DELETE",headers:r},[4,FI((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,xI("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function fT(t,e){var n=t.appConfig;return function(t,e){zI();var n=BI(t),r=KI.get(n);r||(r=new Set,KI.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=BI(t),r=KI.get(n);r&&(r.delete(e),0===r.size&&KI.delete(n),QI())}(n,e)}}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function pT(t){return PI.create("missing-app-config-values",{valueName:t})}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */!function(t){t.INTERNAL.registerComponent(new rt("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw pT("App Configuration");if(!t.name)throw pT("App Name");try{for(var r=l(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw pT(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
return function(t){return c(this,void 0,void 0,(function(){var e,n,r;return h(this,(function(i){switch(i.label){case 0:return[4,nT(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):sT(t).catch(console.error),[2,n.fid]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),c(this,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return[4,hT(t.appConfig)];case 1:return n.sent(),[4,sT(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return c(this,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:return[4,eT(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw PI.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw PI.create("app-offline");case 3:return[4,lT(e,n)];case 4:return r.sent(),[4,tT(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return fT(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations",EI)}(Lt);var dT,vT,gT=((YI={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',YI["only-available-in-window"]="This method is available in a Window context.",YI["only-available-in-sw"]="This method is available in a service worker context.",YI["permission-default"]="The notification permission was not granted and dismissed instead.",YI["permission-blocked"]="The notification permission was not granted and blocked instead.",YI["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",YI["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",YI["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",YI["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",YI["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",YI["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",YI["token-update-no-token"]="FCM returned no token when updating the user to push.",YI["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",YI["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",YI["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",YI["invalid-vapid-key"]="The public VAPID key must be a string.",YI["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",YI),yT=new M("messaging","Messaging",gT),mT="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",bT="google.c.a.c_id";
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function _T(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,p([],f(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function wT(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(vT=dT||(dT={})).PUSH_RECEIVED="push-received",vT.NOTIFICATION_CLICKED="notification-clicked";var IT="fcm_token_details_db",TT="fcm_token_object_Store";function ET(t){return c(this,void 0,void 0,(function(){var e,n,r=this;return h(this,(function(i){switch(i.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(e=i.sent(),!e.map((function(t){return t.name})).includes(IT))return[2,null];i.label=2;case 2:return n=null,[4,II.openDb(IT,5,(function(e){return c(r,void 0,void 0,(function(){var r,i,o,a;return h(this,(function(s){switch(s.label){case 0:return e.oldVersion<2?[2]:e.objectStoreNames.contains(TT)?[4,(r=e.transaction.objectStore(TT)).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,r.clear()];case 2:if(s.sent(),!i)return[2];if(2===e.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];n={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:_T(o.vapidKey)}}}else(3===e.oldVersion||4===e.oldVersion)&&(n={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:_T(o.auth),p256dh:_T(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:_T(o.vapidKey)}});return[2]}}))}))}))];case 3:return i.sent().close(),[4,II.deleteDb(IT)];case 4:return i.sent(),[4,II.deleteDb("fcm_vapid_details_db")];case 5:return i.sent(),[4,II.deleteDb("undefined")];case 6:return i.sent(),[2,ST(n)?n:null]}}))}))}function ST(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var CT="firebase-messaging-store",kT=null;function NT(){return kT||(kT=II.openDb("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(CT)}}))),kT}function AT(t){return c(this,void 0,void 0,(function(){var e,n,r;return h(this,(function(i){switch(i.label){case 0:return e=DT(t),[4,NT()];case 1:return[4,i.sent().transaction(CT).objectStore(CT).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,ET(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,PT(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function PT(t,e){return c(this,void 0,void 0,(function(){var n,r,i;return h(this,(function(o){switch(o.label){case 0:return n=DT(t),[4,NT()];case 1:return r=o.sent(),[4,(i=r.transaction(CT,"readwrite")).objectStore(CT).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function RT(t){return c(this,void 0,void 0,(function(){var e,n,r;return h(this,(function(i){switch(i.label){case 0:return e=DT(t),[4,NT()];case 1:return n=i.sent(),[4,(r=n.transaction(CT,"readwrite")).objectStore(CT).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function DT(t){return t.appConfig.appId}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function OT(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return[4,FT(t)];case 1:n=u.sent(),r=UT(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(MT(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),yT.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,yT.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw yT.create("token-subscribe-no-token");return[2,o.token]}}))}))}function xT(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return[4,FT(t)];case 1:n=u.sent(),r=UT(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(MT(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),yT.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,yT.create("token-update-failed",{errorInfo:s});if(!o.token)throw yT.create("token-update-no-token");return[2,o.token]}}))}))}function LT(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o,a;return h(this,(function(s){switch(s.label){case 0:return[4,FT(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(MT(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,yT.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),yT.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function MT(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function FT(t){var e=t.appConfig,n=t.installations;return c(this,void 0,void 0,(function(){var t;return h(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function UT(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==mT&&(o.web.applicationPubKey=i),o}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function jT(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o,a;return h(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw yT.create("permission-blocked");return[4,KT(e,n)];case 1:return r=s.sent(),[4,AT(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:_T(r.getKey("auth")),p256dh:_T(r.getKey("p256dh"))},i?[3,3]:[2,BT(t,o)];case 3:if(u=i.subscriptionOptions,h=(c=o).vapidKey===u.vapidKey,l=c.endpoint===u.endpoint,f=c.auth===u.auth,p=c.p256dh===u.p256dh,h&&l&&f&&p)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,LT(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,BT(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,VT({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,h,l,f,p;
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */}))}))}function qT(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return[4,AT(t)];case 1:return(n=i.sent())?[4,LT(t,n.token)]:[3,4];case 2:return i.sent(),[4,RT(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function VT(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o;return h(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,xT(e,t)];case 1:return r=a.sent(),i=u(u({},t),{token:r,createTime:Date.now()}),[4,PT(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,qT(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function BT(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return[4,OT(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,PT(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function KT(t,e){return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:wT(e)})]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function WT(t){return"object"==typeof t&&!!t&&bT in t}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function HT(t){return new Promise((function(e){setTimeout(e,t)}))}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var GT=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw yT.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,AT(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:mT,r.label=2;case 2:return[2,jT(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return qT(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw yT.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw yT.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw yT.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw yT.create("only-available-in-window")},t.prototype.onMessage=function(){throw yT.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw yT.create("only-available-in-window")},t.prototype.onPush=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i;return h(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,XT()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,YT(n,e)]:(r=!1,e.notification?[4,$T(zT(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,HT(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return c(this,void 0,void 0,(function(){var r;return h(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,qT(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,AT(this.firebaseDependencies)];case 3:return r=i.sent(),[4,qT(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,jT(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:mT)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return c(this,void 0,void 0,(function(){var r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;if(i)return i;return WT(t.data)?self.location.origin:null}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,QT(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,HT(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=dT.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function zT(t){var e,n=u({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function QT(t){return c(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return h(this,(function(u){switch(u.label){case 0:return[4,XT()];case 1:e=u.sent();try{for(n=l(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){a={error:t}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function YT(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=dT.PUSH_RECEIVED;try{for(var i=l(t),o=i.next();!o.done;o=i.next()){o.value.postMessage(e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function XT(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function $T(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var JT=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return c(this,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===dT.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),WT(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw yT.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,jT(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=mT),[2]}))}))},t.prototype.updateSwReg=function(t){return c(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw yT.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return c(this,void 0,void 0,(function(){var t,e;return h(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),yT.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,qT(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?yT.create("permission-blocked"):yT.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw yT.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw yT.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw yT.create("invalid-sw-registration");if(this.swRegistration)throw yT.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw yT.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw yT.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case dT.NOTIFICATION_CLICKED:return"notification_open";case dT.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function ZT(t){return yT.create("missing-app-config-values",{valueName:t})}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var tE={isSupported:eE};function eE(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}Lt.INTERNAL.registerComponent(new rt("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw ZT("App Configuration Object");if(!t.name)throw ZT("App Name");var r=t.options;try{for(var i=l(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw ZT(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!eE())throw yT.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new GT(n):new JT(n)}),"PUBLIC").setServiceProps(tE));
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var nE="firebasestorage.googleapis.com",rE=function(t){function e(n,r){var i=t.call(this,iE(n),"Firebase Storage: "+r+" ("+iE(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return s(e,t),e.prototype._codeEquals=function(t){return iE(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(L);function iE(t){return"storage/"+t}function oE(){return new rE("unknown","An unknown error occurred, please check the error payload for server response.")}function aE(){return new rE("canceled","User canceled the upload/download.")}function sE(){return new rE("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function uE(t){return new rE("invalid-argument",t)}function cE(){return new rE("app-deleted","The Firebase app was deleted.")}function hE(t){return new rE("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lE(t,e){return new rE("invalid-format","String does not match format '"+t+"': "+e)}function fE(t){throw new rE("internal-error","Internal error: "+t)}
/**
  * @license
  * Copyright 2021 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var pE={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},dE=function(t,e){this.data=t,this.contentType=e||null};function vE(t,e){switch(t){case pE.RAW:return new dE(gE(e));case pE.BASE64:case pE.BASE64URL:return new dE(yE(t,e));case pE.DATA_URL:return new dE((n=new mE(e)).base64?yE(pE.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw lE(pE.DATA_URL,"Malformed data URL.")}return gE(e)}(n.rest),function(t){return new mE(t).contentType}(e))}var n;throw oE()}function gE(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function yE(t,e){switch(t){case pE.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw lE(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case pE.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw lE(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw lE(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var mE=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw lE(pE.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */};var bE,_E,wE={STATE_CHANGED:"state_changed"},IE={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function TE(t){switch(t){case"running":case"pausing":case"canceling":return IE.RUNNING;case"paused":return IE.PAUSED;case"success":return IE.SUCCESS;case"canceled":return IE.CANCELED;case"error":default:return IE.ERROR}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(_E=bE||(bE={}))[_E.NO_ERROR=0]="NO_ERROR",_E[_E.NETWORK_ERROR=1]="NETWORK_ERROR",_E[_E.ABORT=2]="ABORT";
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var EE=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=bE.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=bE.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=bE.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw fE("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw fE("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw fE("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw fE("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var SE=function(){function t(){}return t.prototype.createConnection=function(){return new EE},t}(),CE=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new rE("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===nE?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var h=u[c],l=h.regex.exec(e);if(l){var f=l[h.indices.bucket],p=l[h.indices.path];p||(p=""),r=new t(f,p),h.postModify(r);break}}if(null==r)throw function(t){return new rE("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),kE=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function NE(t){return"string"==typeof t||t instanceof String}function AE(t){return PE()&&t instanceof Blob}function PE(){return"undefined"!=typeof Blob}function RE(t,e,n,r){if(r<e)throw uE("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw uE("Invalid value for '"+t+"'. Expected "+n+" or less.")}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function DE(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null==n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function OE(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var xE=function(){function t(t,e,n,r,i,o,a,s,u,c,h){var l=this;this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.connection;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());void 0!==s?i(s):i()}catch(t){o(t)}else null!==a?((r=oE()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?cE():aE()):o(r=new rE("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new LE(!1,null,!0)):this.backoffId_=
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function(t,e,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var u=!1;function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u||(u=!0,e.apply(null,t))}function h(e){i=setTimeout((function(){i=null,t(l,s())}),e)}function l(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)c.call.apply(c,p([null,t],e));else{var i;s()||o?c.call.apply(c,p([null,t],e)):(r<64&&(r*=2),1===a?(a=2,i=0):i=1e3*(r+Math.random()),h(i))}}var f=!1;function d(t){f||(f=!0,u||(null!==i?(t||(a=2),clearTimeout(i),h(0)):t||(a=1)))}return h(0),setTimeout((function(){o=!0,d(!0)}),n),d}((function(e,n){if(n)e(!1,new LE(!1,null,!0));else{var r=t.pool_.createConnection();t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(){null!==t.progressCallback_&&r.removeUploadProgressListener(i),t.pendingConnection_=null;var n=r.getErrorCode()===bE.NO_ERROR,o=r.getStatus();if(n&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new LE(a,r))}else{var s=r.getErrorCode()===bE.ABORT;e(!1,new LE(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),LE=function(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function ME(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function FE(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ME();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(PE())return new Blob(t);throw new rE("unsupported-environment","This browser doesn't seem to support creating Blobs")}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var UE=function(){function t(t,e){var n=0,r="";AE(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(AE(this.data_)){var r=this.data_,i=(a=e,s=n,(o=r).webkitSlice?o.webkitSlice(a,s):o.mozSlice?o.mozSlice(a,s):o.slice?o.slice(a,s):null);return null===i?null:new t(i)}var o,a,s;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(PE()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(FE.apply(null,r))}var i=e.map((function(t){return NE(t)?vE(pE.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function jE(t){var e,n;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function qE(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function VE(t,e){return e}var BE=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||VE},KE=null;function WE(){if(KE)return KE;var t=[];t.push(new BE("bucket")),t.push(new BE("generation")),t.push(new BE("metageneration")),t.push(new BE("name","fullPath",!0));var e=new BE("name");e.xform=function(t,e){return function(t){return!NE(t)||t.length<2?t:qE(t)}(e)},t.push(e);var n=new BE("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new BE("timeCreated")),t.push(new BE("updated")),t.push(new BE("md5Hash",null,!0)),t.push(new BE("cacheControl",null,!0)),t.push(new BE("contentDisposition",null,!0)),t.push(new BE("contentEncoding",null,!0)),t.push(new BE("contentLanguage",null,!0)),t.push(new BE("contentType",null,!0)),t.push(new BE("metadata","customMetadata",!0)),KE=t}function HE(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new CE(n,r);return e._makeStorageReference(i)}})}(r,t),r}function GE(t,e,n){var r=jE(e);return null===r?null:HE(t,r,n)}function zE(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function QE(t,e,n){var r=jE(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new CE(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var h=c[u];s=t._makeStorageReference(new CE(e,h.name)),r.items.push(s)}return r}(t,e,r)}var YE=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function XE(t){if(!t)throw oE()}function $E(t,e){return function(n,r){var i=GE(t,r,e);return XE(null!==i),i}}function JE(t,e){return function(n,r){var i=GE(t,r,e);return XE(null!==i),function(t,e,n){var r=jE(e);if(null===r)return null;if(!NE(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return DE("/b/"+o(r)+"/o/"+o(i),n)+OE({alt:"media",token:e})}))[0]}(i,r,t.host)}}function ZE(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new rE("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new rE("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new rE("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new rE("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function tS(t){var e=ZE(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new rE("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function eS(t,e,n){var r=DE(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new YE(r,"GET",$E(t,n),i);return o.errorHandler=tS(e),o}function nS(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=DE(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new YE(a,"GET",function(t,e){return function(n,r){var i=QE(t,e,r);return XE(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=ZE(e),u}function rS(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var iS=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function oS(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){XE(!1)}return XE(!!n&&-1!==(e||["active"]).indexOf(n)),n}var aS=262144;function sS(t,e,n,r,i,o,a,s){var u=new iS(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new rE("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,p={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":""+u.current},d=r.slice(l,f);if(null===d)throw sE();var v=e.maxUploadRetryTime,g=new YE(n,"POST",(function(t,n){var i,a=oS(t,["active","final"]),s=u.current+h,c=r.size();return i="final"===a?$E(e,o)(t,n):null,new iS(s,c,"final"===a,i)}),v);return g.headers=p,g.body=d.uploadData(),g.progressCallback=s||null,g.errorHandler=ZE(t),g}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var uS=function(t,e,n){if("function"==typeof t||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}};
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function cS(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var hS=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=WE(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=rS(e,r,i),s={name:a.fullPath},u=DE(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":""+r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=zE(a,n),l=t.maxUploadRetryTime,f=new YE(u,"POST",(function(t){var e;oS(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){XE(!1)}return XE(NE(e)),e}),l);return f.urlParams=s,f.headers=c,f.body=h,f.errorHandler=ZE(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new YE(n,"POST",(function(t){var e=oS(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){XE(!1)}n||XE(!1);var i=Number(n);return XE(!isNaN(i)),new iS(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=ZE(e),o}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=aS*this._chunkMultiplier,n=new iS(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=sS(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){aS*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=eS(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=rS(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+zE(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",l=UE.getBlob(c,r,h);if(null===l)throw sE();var f={name:u.fullPath},p=DE(o,t.host),d=t.maxUploadRetryTime,v=new YE(p,"POST",$E(t,n),d);return v.urlParams=f,v.headers=a,v.body=l.uploadData(),v.errorHandler=ZE(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=aE(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=TE(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new uS(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(TE(this._state)){case IE.SUCCESS:cS(this._resolve.bind(null,this.snapshot))();break;case IE.CANCELED:case IE.ERROR:cS(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(TE(this._state)){case IE.RUNNING:case IE.PAUSED:t.next&&cS(t.next.bind(t,this.snapshot))();break;case IE.SUCCESS:t.complete&&cS(t.complete.bind(t))();break;case IE.CANCELED:case IE.ERROR:t.error&&cS(t.error.bind(t,this._error))();break;default:t.error&&cS(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),lS=function(){function t(t,e){this._service=t,this._location=e instanceof CE?e:CE.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new CE(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return qE(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new CE(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw hE(t)},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function fS(t){var e={prefixes:[],items:[]};return pS(t,e).then((function(){return e}))}function pS(t,e,n){return c(this,void 0,void 0,(function(){var r,i,o;return h(this,(function(a){switch(a.label){case 0:return[4,dS(t,{pageToken:n})];case 1:return r=a.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,pS(t,e,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function dS(t,e){return c(this,void 0,void 0,(function(){var n,r;return h(this,(function(i){switch(i.label){case 0:return null!=e&&"number"==typeof e.maxResults&&RE("options.maxResults",1,1e3,e.maxResults),n=e||{},r=nS(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function vS(t,e){return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=DE(e.fullServerUrl(),t.host),o=zE(n,r),a=t.maxOperationRetryTime,s=new YE(i,"PATCH",$E(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=tS(e),s}(t.storage,t._location,e,WE()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}function gS(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=DE(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new YE(r,"GET",JE(t,n),i);return o.errorHandler=tS(e),o}(t.storage,t._location,WE()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new rE("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function yS(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=DE(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new YE(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=tS(e),i}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}function mS(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new CE(t._location.bucket,n);return new lS(t.storage,r)}
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function bS(t){return/^[A-Za-z]+:\/\//.test(t)}function _S(t,e){if(t instanceof TS){var n=t;if(null==n._bucket)throw new rE("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new lS(n,n._bucket);return null!=e?_S(r,e):r}if(void 0!==e){if(e.includes(".."))throw uE('`path` param cannot contain ".."');return mS(t,e)}return t}function wS(t,e){if(e&&bS(e)){if(t instanceof TS)return new lS(t,e);throw uE("To use ref(service, url), the first argument must be a Storage instance.")}return _S(t,e)}function IS(t,e){var n=null==e?void 0:e.storageBucket;return null==n?null:CE.makeFromBucketSpec(n,t)}var TS=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=nE,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?CE.makeFromBucketSpec(i,this._host):IS(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=CE.makeFromBucketSpec(this._url,t):this._bucket=IS(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){RE("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){RE("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return c(this,void 0,void 0,(function(){var t,e;return h(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new lS(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new kE(cE());var i=function(t,e,n,r,i,o){var a=OE(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new xE(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return c(this,void 0,void 0,(function(){var e,n,r;return h(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=i.sent(),n=e[0],r=e[1],[2,this._makeRequest(t,n,r)]}}))}))},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function ES(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new hS(t,new UE(e),n)}(t=nt(t),e,n)}function SS(t){return function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=eS(t.storage,t._location,WE()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=nt(t))}function CS(t,e){return wS(t=nt(t),e)}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var kS=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),NS=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new kS(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new kS(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new kS(t,i,i._ref))}:{next:e.next?function(t){return e.next(new kS(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),AS=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new PS(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new PS(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),PS=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return mS(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new NS(ES(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=pE.RAW),this._throwIfRoot("putString");var r=vE(e,t),i=u({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new NS(new hS(this._delegate,new UE(r.data,!0),i),this)},t.prototype.listAll=function(){var t,e=this;return(t=this._delegate,fS(t=nt(t))).then((function(t){return new AS(t,e.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return dS(t=nt(t),e)}(this._delegate,t||void 0).then((function(t){return new AS(t,e.storage)}))},t.prototype.getMetadata=function(){return SS(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return vS(t=nt(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return gS(nt(this._delegate))},t.prototype.delete=function(){return this._throwIfRoot("delete"),yS(nt(this._delegate))},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw hE(t)},t}(),RS=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(bS(t))throw uE("ref() expected a child path but got a URL, use refFromURL instead.");return new PS(CS(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!bS(t))throw uE("refFromURL() expected a full URL but got a child path, use ref() instead.");try{CE.makeFromUrl(t,this._delegate.host)}catch(t){throw uE("refFromUrl() expected a valid full URL but got an invalid one.")}return new PS(CS(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){!function(t,e,n){t.host="http://"+e+":"+n}(this._delegate,t,e)},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function DS(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new RS(r,new TS(r,i,o,new SE,n,Lt.SDK_VERSION))}!function(t){var e={TaskState:IE,TaskEvent:wE,StringFormat:pE,Storage:TS,Reference:PS};t.INTERNAL.registerComponent(new rt("storage",DS,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.6")}(Lt);var OS,xS,LS,MS="0.4.16",FS=MS,US="FB-PERF-TRACE-MEASURE",jS="_wt_",qS="_fcp",VS="_fid",BS="@firebase/performance/config",KS="@firebase/performance/configexpire",WS="Performance",HS=((OS={})["trace started"]="Trace {$traceName} was started before.",OS["trace stopped"]="Trace {$traceName} is not running.",OS["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",OS["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",OS["no window"]="Window is not available.",OS["no app id"]="App id is not available.",OS["no project id"]="Project id is not available.",OS["no api key"]="Api key is not available.",OS["invalid cc log"]="Attempted to queue invalid cc event",OS["FB not default"]="Performance can only start when Firebase app instance is the default one.",OS["RC response not ok"]="RC response is not ok",OS["invalid attribute name"]="Attribute name {$attributeName} is invalid.",OS["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",OS["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",OS["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",OS),GS=new M("performance",WS,HS),zS=new yt(WS);zS.logLevel=ct.INFO;var QS,YS=function(){function t(t){if(this.window=t,!t)throw GS.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!D()||(zS.info("IndexedDB is not supported by current browswer"),!1):(zS.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===xS&&(xS=new t(LS)),xS},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function XS(t,e){var n=t.length-e.length;if(n<0||n>1)throw GS.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var $S,JS,ZS,tC=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=XS("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=XS("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw GS.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw GS.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw GS.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===QS&&(QS=new t),QS},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function eC(){return $S}(ZS=JS||(JS={}))[ZS.UNKNOWN=0]="UNKNOWN",ZS[ZS.VISIBLE=1]="VISIBLE",ZS[ZS.HIDDEN=2]="HIDDEN";var nC=["firebase_","google_","ga_"],rC=new RegExp("^[a-zA-Z]\\w*$");function iC(){var t=YS.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function oC(){switch(YS.getInstance().document.visibilityState){case"visible":return JS.VISIBLE;case"hidden":return JS.HIDDEN;default:return JS.UNKNOWN}}function aC(){var t=YS.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var sC="0.0.1",uC=!0;function cC(t){var e=function(){var t=YS.getInstance().localStorage;if(!t)return;var e=t.getItem(KS);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;var r=t.getItem(BS);if(!r)return;try{return JSON.parse(r)}catch(t){return}}();return e?(lC(e),Promise.resolve()):function(t){return(e=tC.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+tC.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+tC.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:tC.getInstance().getAppId(),app_version:FS,sdk_version:sC})});return fetch(r).then((function(t){if(t.ok)return t.json();throw GS.create("RC response not ok")}))})).catch((function(){zS.info(hC)}));var e;
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */}(t).then(lC).then((function(t){return function(t){var e=YS.getInstance().localStorage;if(!t||!e)return;e.setItem(BS,JSON.stringify(t)),e.setItem(KS,String(Date.now()+60*tC.getInstance().configTimeToLive*60*1e3))}(t)}),(function(){}))}var hC="Could not fetch config, will use default configs";function lC(t){if(!t)return t;var e=tC.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=uC,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=fC(e.tracesSamplingRate),e.logNetworkAfterSampling=fC(e.networkRequestsSamplingRate),t}function fC(t){return Math.random()<=t}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var pC,dC=1;function vC(){return dC=2,pC=pC||function(){var t=YS.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=tC.getInstance().installationsService.getId()).then((function(t){$S=t})),t;var t})).then((function(t){return cC(t)})).then((function(){return gC()}),(function(){return gC()}))}function gC(){dC=3}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var yC,mC=1e4,bC=3,_C=[],wC=!1;function IC(t){setTimeout((function(){var t,e;if(0!==bC)return _C.length?(t=_C.splice(0,1e3),e=t.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=tC.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||zS.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=mC;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(_C=p(p([],e),_C),zS.info("Retry transport request later.")),bC=3,IC(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:tC.getInstance().logSource,log_event:e},t).catch((function(){_C=p(p([],t),_C),bC--,zS.info("Tries left: "+bC+"."),IC(mC)}))):IC(mC)}),t)}function TC(t){if(!t.eventTime||!t.message)throw GS.create("invalid cc log");_C=p(p([],_C),[t])}function EC(t,e){var n;
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */yC||(n=kC,yC=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TC({message:n.apply(void 0,t),eventTime:Date.now()})}),yC(t,e)}function SC(t){var e=tC.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&YS.getInstance().requiredApisAvailable()&&(t.isAuto&&oC()!==JS.VISIBLE||(3===dC?CC(t):vC().then((function(){return CC(t)}),(function(){return CC(t)}))))}function CC(t){if(eC()){var e=tC.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return EC(t,1)}),0)}}function kC(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:NC(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:NC(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function NC(){return{google_app_id:tC.getInstance().getAppId(),app_instance_id:eC(),web_app_info:{sdk_version:FS,page_url:YS.getInstance().getUrl(),service_worker_status:iC(),visibility_state:oC(),effective_connection_type:aC()},application_process_state:0}}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var AC=["_fp",qS,VS];
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var PC=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=YS.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw GS.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw GS.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),SC(this)},t.prototype.record=function(t,e,n){if(t<=0)throw GS.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw GS.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=u({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}SC(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,o=this.name,0===i.length||i.length>100||!(o&&o.startsWith(jS)&&AC.indexOf(i)>-1)&&i.startsWith("_"))throw GS.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&zS.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||nC.some((function(t){return n.startsWith(t)}))||!n.match(rC)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw GS.create("invalid attribute name",{attributeName:t});if(!i)throw GS.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return u({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=YS.getInstance().getUrl();if(i){var o=new t(jS+i,!0),a=Math.floor(1e3*YS.getInstance().getTimeOrigin());o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(qS,Math.floor(1e3*u.startTime)),r&&o.putMetric(VS,Math.floor(1e3*r))}SC(o)}},t.createUserTimingTrace=function(e){SC(new t(e,!1,e))},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function RC(t){var e=t;if(e&&void 0!==e.responseStart){var n=YS.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=tC.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return EC(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function DC(){eC()&&(setTimeout((function(){return function(){var t=YS.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){PC.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),PC.createOobTrace(e,n,t))}))}else PC.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=YS.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){RC(r[n])}t.setupObserver("resource",RC)}()}),0),setTimeout((function(){return function(){for(var t=YS.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){OC(r[n])}t.setupObserver("measure",OC)}()}),0))}function OC(t){var e=t.name;e.substring(0,US.length)!==US&&PC.createUserTimingTrace(e)}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var xC=function(){function t(t){this.app=t,YS.getInstance().requiredApisAvailable()&&O().then((function(t){t&&(wC||(IC(5500),wC=!0),vC().then(DC,DC))})).catch((function(t){zS.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new PC(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return tC.getInstance().instrumentationEnabled},set:function(t){tC.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return tC.getInstance().dataCollectionEnabled},set:function(t){tC.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */!function(t){var e=function(t,e){if("[DEFAULT]"!==t.name)throw GS.create("FB not default");if("undefined"==typeof window)throw GS.create("no window");return function(t){LS=t}(window),tC.getInstance().firebaseAppInstance=t,tC.getInstance().installationsService=e,new xC(t)};t.INTERNAL.registerComponent(new rt("performance",(function(t){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC")),t.registerVersion("@firebase/performance",MS)}(Lt);
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var LC,MC,FC,UC,jC="https://www.googletagmanager.com/gtag/js";(MC=LC||(LC={})).EVENT="event",MC.SET="set",MC.CONFIG="config",(UC=FC||(FC={})).ADD_SHIPPING_INFO="add_shipping_info",UC.ADD_PAYMENT_INFO="add_payment_info",UC.ADD_TO_CART="add_to_cart",UC.ADD_TO_WISHLIST="add_to_wishlist",UC.BEGIN_CHECKOUT="begin_checkout",UC.CHECKOUT_PROGRESS="checkout_progress",UC.EXCEPTION="exception",UC.GENERATE_LEAD="generate_lead",UC.LOGIN="login",UC.PAGE_VIEW="page_view",UC.PURCHASE="purchase",UC.REFUND="refund",UC.REMOVE_FROM_CART="remove_from_cart",UC.SCREEN_VIEW="screen_view",UC.SEARCH="search",UC.SELECT_CONTENT="select_content",UC.SELECT_ITEM="select_item",UC.SELECT_PROMOTION="select_promotion",UC.SET_CHECKOUT_OPTION="set_checkout_option",UC.SHARE="share",UC.SIGN_UP="sign_up",UC.TIMING_COMPLETE="timing_complete",UC.VIEW_CART="view_cart",UC.VIEW_ITEM="view_item",UC.VIEW_ITEM_LIST="view_item_list",UC.VIEW_PROMOTION="view_promotion",UC.VIEW_SEARCH_RESULTS="view_search_results";
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var qC,VC=new yt("@firebase/analytics");
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function BC(t,e,n,r,i,o){return c(this,void 0,void 0,(function(){var a,s,u,c;return h(this,(function(h){switch(h.label){case 0:a=r[i],h.label=1;case 1:return h.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return h.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=h.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:h.sent(),h.label=6;case 6:return[3,8];case 7:return c=h.sent(),VC.error(c),[3,8];case 8:return t(LC.CONFIG,i,o),[2]}}))}))}function KC(t,e,n,r,i){return c(this,void 0,void 0,(function(){var o,a,s,u,c,l,f,p;return h(this,(function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=h.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=a;c<l.length&&(f=l[c],"break"!==u(f));c++);h.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return h.sent(),t(LC.EVENT,r,i||{}),[3,5];case 4:return p=h.sent(),VC.error(p),[3,5];case 5:return[2]}}))}))}function WC(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return c(this,void 0,void 0,(function(){var s;return h(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==LC.EVENT?[3,2]:[4,KC(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==LC.CONFIG?[3,4]:[4,BC(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(LC.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),VC.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}var HC=((qC={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",qC["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",qC["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",qC["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",qC["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",qC["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",qC["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",qC["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',qC["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',qC),GC=new M("analytics","Analytics",HC),zC=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function QC(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function YC(t){var e;return c(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return h(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:QC(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=c.sent()).status||304===a.status)return[3,6];s="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(s=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw GC.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function XC(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=zC),c(this,void 0,void 0,(function(){var e,a,s,u,c,l,f;return h(this,(function(h){switch(h.label){case 0:e=t.appId,a=t.measurementId,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,$C(n,i)];case 2:return h.sent(),[3,4];case 3:if(s=h.sent(),a)return VC.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+s.message+"]"),[2,{appId:e,measurementId:a}];throw s;case 4:return h.trys.push([4,6,,7]),[4,YC(t)];case 5:return u=h.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof L&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=h.sent())){if(r.deleteThrottleMetadata(e),a)return VC.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:a}];throw c}return l=503===Number(c.customData.httpStatus)?et(o,r.intervalMillis,30):et(o,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+l,backoffCount:o+1},r.setThrottleMetadata(e,f),VC.debug("Calling attemptFetch again in "+l+" millis"),[2,XC(t,f,n,r)];case 7:return[2]}}))}))}function $C(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(GC.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var JC=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function ZC(t,e,n,r,i,o){return c(this,void 0,void 0,(function(){var a,s,u,l,f,p,d;return h(this,(function(v){switch(v.label){case 0:return(a=function(t,e,n){return void 0===e&&(e=zC),c(this,void 0,void 0,(function(){var r,i,o,a,s,u,l=this;return h(this,(function(f){if(r=t.options,i=r.appId,o=r.apiKey,a=r.measurementId,!i)throw GC.create("no-app-id");if(!o){if(a)return[2,{measurementId:a,appId:i}];throw GC.create("no-api-key")}return s=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new JC,setTimeout((function(){return c(l,void 0,void 0,(function(){return h(this,(function(t){return u.abort(),[2]}))}))}),void 0!==n?n:6e4),[2,XC({appId:i,apiKey:o,measurementId:a},s,u,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&VC.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return VC.error(t)})),e.push(a),s=function(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){switch(e.label){case 0:return D()?[3,1]:(VC.warn(GC.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,O()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),VC.warn(GC.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([a,s])];case 1:return u=v.sent(),l=u[0],f=u[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(jC))return r}return null}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */()||function(t,e){var n=document.createElement("script");n.src="https://www.googletagmanager.com/gtag/js?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(o,l.measurementId),i("js",new Date),(d={}).origin="firebase",d.update=!0,p=d,null!=f&&(p.firebase_id=f),i(LC.CONFIG,l.measurementId,p),[2,l.measurementId]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var tk,ek,nk={},rk=[],ik={},ok="dataLayer",ak="gtag",sk=!1;function uk(t){if(sk)throw GC.create("already-initialized");t.dataLayerName&&(ok=t.dataLayerName),t.gtagName&&(ak=t.gtagName)}function ck(t,e){!function(){var t=[];if(A()&&t.push("This is a browser extension environment."),x()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=GC.create("invalid-analytics-context",{errorInfo:e});VC.warn(n.message)}}();var n,r,i=t.options.appId;if(!i)throw GC.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw GC.create("no-api-key");VC.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=nk[i])throw GC.create("already-exists",{id:i});if(!sk){n=ok,r=[],Array.isArray(window[n])?r=window[n]:window[n]=r;var o=WC(nk,rk,ik,ok,ak),a=o.wrappedGtag,s=o.gtagCore;ek=a,tk=s,sk=!0}return nk[i]=ZC(t,rk,ik,e,tk,ok),{app:t,logEvent:function(t,e,n){(
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function(t,e,n,r,i){return c(this,void 0,void 0,(function(){var o,a;return h(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(LC.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=u(u({},r),{send_to:o}),t(LC.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(ek,nk[i],t,e,n).catch((function(t){return VC.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return c(this,void 0,void 0,(function(){var i;return h(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(LC.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(LC.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(ek,nk[i],t,e).catch((function(t){return VC.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return c(this,void 0,void 0,(function(){var i;return h(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(LC.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(LC.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(ek,nk[i],t,e).catch((function(t){return VC.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return c(this,void 0,void 0,(function(){var i,o,a,s,u;return h(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return t(LC.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(LC.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(ek,nk[i],t,e).catch((function(t){return VC.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return c(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(nk[i],t).catch((function(t){return VC.error(t)}))},INTERNAL:{delete:function(){return delete nk[i],Promise.resolve()}}}}var hk="analytics";function lk(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:if(A())return[2,!1];if(!x())return[2,!1];if(!D())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,O()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */!function(t){t.INTERNAL.registerComponent(new rt(hk,(function(t){return ck(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:uk,EventName:FC,isSupported:lk})),t.INTERNAL.registerComponent(new rt("analytics-internal",(function(t){try{return{logEvent:t.getProvider(hk).getImmediate().logEvent}}catch(t){throw GC.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.14")}(Lt);var fk,pk=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,o;return h(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),dk=((fk={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",fk["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",fk["registration-api-key"]="Undefined API key. Check Firebase app initialization.",fk["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",fk["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",fk["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",fk["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",fk["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",fk["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",fk["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',fk["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',fk["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",fk["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",fk),vk=new M("remoteconfig","Remote Config",dk);
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var gk=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return c(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,f,p,d,v,g,y,m,b,_;return h(this,(function(h){switch(h.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=h.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:a,body:JSON.stringify(s)},c=fetch(o,u),l=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),h.label=2;case 2:return h.trys.push([2,5,,6]),[4,Promise.race([c,l])];case 3:return h.sent(),[4,c];case 4:return f=h.sent(),[3,6];case 5:throw p=h.sent(),d="fetch-client-network","AbortError"===p.name&&(d="fetch-timeout"),vk.create(d,{originalErrorMessage:p.message});case 6:if(v=f.status,g=f.headers.get("ETag")||void 0,200!==f.status)return[3,11];b=void 0,h.label=7;case 7:return h.trys.push([7,9,,10]),[4,f.json()];case 8:return b=h.sent(),[3,10];case 9:throw _=h.sent(),vk.create("fetch-client-parse",{originalErrorMessage:_.message});case 10:y=b.entries,m=b.state,h.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===m?v=500:"NO_CHANGE"===m?v=304:"NO_TEMPLATE"!==m&&"EMPTY_CONFIG"!==m||(y={}),304!==v&&200!==v)throw vk.create("fetch-status",{httpStatus:v});return[2,{status:v,eTag:g,config:y}]}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var w}))}))},t}(),yk=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),mk=["1","true","t","yes","y","on"],bk=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&mk.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),_k=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=ct.DEBUG;break;case"silent":this._logger.logLevel=ct.SILENT;break;default:this._logger.logLevel=ct.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return c(this,void 0,void 0,(function(){var t,e,n;return h(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return c(this,void 0,void 0,(function(){var t,e,n,r=this;return h(this,(function(i){switch(i.label){case 0:t=new yk,setTimeout((function(){return c(r,void 0,void 0,(function(){return h(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=function(t,e){return t instanceof L&&-1!==t.code.indexOf(e)}(e,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return c(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return function(t,e){void 0===t&&(t={});void 0===e&&(e={});return Object.keys(u(u({},t),e))}
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new bk("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new bk("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new bk("static"))},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function wk(t,e){var n=t.target.error||void 0;return vk.create(e,{originalErrorMessage:n&&n.message})}var Ik="app_namespace_store";var Tk=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(wk(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(Ik,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return c(this,void 0,void 0,(function(){var e,n=this;return h(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Ik],"readonly").objectStore(Ik),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(wk(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(vk.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return c(this,void 0,void 0,(function(){var n,r=this;return h(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([Ik],"readwrite").objectStore(Ik),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(wk(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(vk.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return c(this,void 0,void 0,(function(){var e,n=this;return h(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Ik],"readwrite").objectStore(Ik),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(wk(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(t){i(vk.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),Ek=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return c(this,void 0,void 0,(function(){var t,e,n,r,i,o;return h(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
/**
  * @license
  * Copyright 2019 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function Sk(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(vk.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Ck,kk=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return c(this,void 0,void 0,(function(){var e,i,o;return h(this,(function(a){switch(a.label){case 0:return[4,Sk(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof L&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=a.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+et(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return a.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),Nk="@firebase/remote-config";function Ak(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(Ck=Lt).INTERNAL.registerComponent(new rt("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw vk.create("registration-window");var o=r.options,a=o.projectId,s=o.apiKey,u=o.appId;if(!a)throw vk.create("registration-project-id");if(!s)throw vk.create("registration-api-key");if(!u)throw vk.create("registration-app-id");n=n||"firebase";var c=new Tk(u,r.name,n),h=new Ek(c),l=new yt(Nk);l.logLevel=ct.ERROR;var f=new gk(i,Ck.SDK_VERSION,n,a,s,u),p=new kk(f,c),d=new pk(p,c,h,l),v=new _k(r,d,h,c,l);return v.ensureInitialized(),v}),"PUBLIC").setMultipleInstances(!0)),Ck.registerVersion(Nk,"0.1.41");var Pk,Rk=Ak(o),Dk=((Pk={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",Pk["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",Pk["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",Pk["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",Pk["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",Pk["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",Pk["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",Pk["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",Pk["recaptcha-error"]="ReCAPTCHA error.",Pk),Ok=new M("appCheck","AppCheck",Dk),xk=new Map,Lk={activated:!1,tokenObservers:[]},Mk={enabled:!1};
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function Fk(t){return xk.get(t)||Lk}function Uk(t,e){xk.set(t,e)}function jk(){return Mk}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function qk(){return self.grecaptcha}function Vk(t){if(!Fk(t).activated)throw Ok.create("use-before-activation",{appName:t.name})}function Bk(t,e){var n=Fk(t),r=new E;Uk(t,u(u({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,o=document.createElement("div");o.id=i,o.style.display="none",document.body.appendChild(o);var a,s,c=qk();return c?c.ready((function(){Wk(t,e,c,i),r.resolve(c)})):(a=function(){var n=qk();if(!n)throw new Error("no recaptcha");n.ready((function(){Wk(t,e,n,i),r.resolve(n)}))},(s=document.createElement("script")).src="https://www.google.com/recaptcha/api.js",s.onload=a,document.head.appendChild(s)),r.promise}function Kk(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return Vk(t),[4,Fk(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=Fk(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function Wk(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),o=Fk(t);Uk(t,u(u({},o),{reCAPTCHAState:u(u({},o.reCAPTCHAState),{widgetId:i})}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var Hk="https://content-firebaseappcheck.googleapis.com/v1beta",Gk=3e4,zk=96e4,Qk=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return c(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new E,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new E,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r;
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function Yk(t,e){var n=t.url,r=t.body;return c(this,void 0,void 0,(function(){var t,i,o,a,s,u,c,l,f,p;return h(this,(function(h){switch(h.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),o={method:"POST",body:JSON.stringify(r),headers:t},h.label=1;case 1:return h.trys.push([1,3,,4]),[4,fetch(n,o)];case 2:return a=h.sent(),[3,4];case 3:throw s=h.sent(),Ok.create("fetch-network-error",{originalErrorMessage:s.message});case 4:if(200!==a.status)throw Ok.create("fetch-status-error",{httpStatus:a.status});h.label=5;case 5:return h.trys.push([5,7,,8]),[4,a.json()];case 6:return u=h.sent(),[3,8];case 7:throw c=h.sent(),Ok.create("fetch-parse-error",{originalErrorMessage:c.message});case 8:if(!(l=u.ttl.match(/^([\d.]+)(s)$/))||!l[2]||isNaN(Number(l[1])))throw Ok.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+u.ttl});return f=1e3*Number(l[1]),p=Date.now(),[2,{token:u.attestationToken,expireTimeMillis:p+f,issuedAtTimeMillis:p}]}}))}))}function Xk(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:Hk+"/projects/"+r+"/apps/"+i+":exchangeRecaptchaToken?key="+o,body:{recaptcha_token:e}}}function $k(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:Hk+"/projects/"+r+"/apps/"+i+":exchangeDebugToken?key="+o,body:{debug_token:e}}}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var Jk="firebase-app-check-store",Zk="debug-token",tN=null;function eN(){return tN||(tN=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(Ok.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(Jk,{keyPath:"compositeKey"})}}}catch(t){e(Ok.create("storage-open",{originalErrorMessage:t.message}))}})))}function nN(t){return iN(oN(t))}function rN(t,e){return c(this,void 0,void 0,(function(){var n,r,i,o;return h(this,(function(a){switch(a.label){case 0:return[4,eN()];case 1:return n=a.sent(),r=n.transaction(Jk,"readwrite"),i=r.objectStore(Jk),o=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){o.onsuccess=function(e){t()},r.onerror=function(t){var n;e(Ok.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function iN(t){return c(this,void 0,void 0,(function(){var e,n,r,i;return h(this,(function(o){switch(o.label){case 0:return[4,eN()];case 1:return e=o.sent(),n=e.transaction(Jk,"readonly"),r=n.objectStore(Jk),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(Ok.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function oN(t){return t.options.appId+"-"+t.name}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var aN=new yt("@firebase/app-check");
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function sN(t){return c(this,void 0,void 0,(function(){var e,n;return h(this,(function(r){switch(r.label){case 0:if(!D())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,nN(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),aN.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}function uN(t,e){return D()?function(t,e){return rN(oN(t),e)}(t,e).catch((function(t){aN.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function cN(){return c(this,void 0,void 0,(function(){var t,e;return h(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,iN(Zk)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),(r=e,rN(Zk,r)).catch((function(t){return aN.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */function hN(){return c(this,void 0,void 0,(function(){var t;return h(this,(function(e){if((t=jk()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
var lN={error:"UNKNOWN_ERROR"};function fN(t){return _.encodeString(JSON.stringify(t),!1)}function pN(t,e,n){return void 0===n&&(n=!1),c(this,void 0,void 0,(function(){var r,i,o,a,s,c,l,f,p,d,v,g,y,m;return h(this,(function(h){switch(h.label){case 0:return Vk(t),r=Fk(t),i=r.token,o=void 0,i?[3,2]:[4,sN(t)];case 1:(a=h.sent())&&yN(a)&&(i=a,Uk(t,u(u({},r),{token:i})),gN(t,{token:i.token})),h.label=2;case 2:return!n&&i&&yN(i)?[2,{token:i.token}]:jk().enabled?(c=Yk,l=$k,f=[t],[4,hN()]):[3,6];case 3:return[4,c.apply(void 0,[l.apply(void 0,f.concat([h.sent()])),e])];case 4:return s=h.sent(),[4,uN(t,s)];case 5:return h.sent(),Uk(t,u(u({},r),{token:s})),[2,{token:s.token}];case 6:return h.trys.push([6,12,,13]),r.customProvider?[4,r.customProvider.getToken()]:[3,8];case 7:return p=h.sent(),d=function(t){var e=V(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null}(p.token),v=null!==d&&d<Date.now()&&d>0?1e3*d:Date.now(),i=u(u({},p),{issuedAtTimeMillis:v}),[3,11];case 8:return[4,Kk(t).catch((function(t){throw Ok.create("recaptcha-error")}))];case 9:return g=h.sent(),[4,Yk(Xk(t,g),e)];case 10:i=h.sent(),h.label=11;case 11:return[3,13];case 12:return y=h.sent(),aN.error(y),o=y,[3,13];case 13:return i?[3,14]:(m=function(t){return{token:fN(lN),error:t}}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */(o),[3,16]);case 14:return m={token:i.token},Uk(t,u(u({},r),{token:i})),[4,uN(t,i)];case 15:h.sent(),h.label=16;case 16:return gN(t,m),[2,m]}}))}))}function dN(t,e,n,r,i){var o=Fk(t),a={next:r,error:i,type:n},s=u(u({},o),{tokenObservers:p(p([],o.tokenObservers),[a])});if(!s.tokenRefresher){var l=function(t,e){var n=this;return new Qk((function(){return c(n,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return Fk(t).token?[3,2]:[4,pN(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,pN(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=Fk(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return n=Math.min(n,r),Math.max(0,n-Date.now())}return 0}),Gk,zk)}(t,e);s.tokenRefresher=l}if(s.tokenRefresher.isRunning()||!0!==o.isTokenAutoRefreshEnabled||s.tokenRefresher.start(),o.token&&yN(o.token)){var f=o.token;Promise.resolve().then((function(){return r({token:f.token})})).catch((function(){}))}Uk(t,s)}function vN(t,e){var n=Fk(t),r=n.tokenObservers.filter((function(t){return t.next!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),Uk(t,u(u({},n),{tokenObservers:r}))}function gN(t,e){for(var n=0,r=Fk(t).tokenObservers;n<r.length;n++){var i=r[n];try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch(t){}}}function yN(t){return t.expireTimeMillis-Date.now()>0}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
function mN(t,e){return{app:t,activate:function(e,n){return function(t,e,n){var r=Fk(t);if(r.activated)throw Ok.create("already-activated",{appName:t.name});var i=u(u({},r),{activated:!0});"string"==typeof e?i.siteKey=e:i.customProvider=e,i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,Uk(t,i),i.siteKey&&Bk(t,i.siteKey).catch((function(){}))}(t,e,n)},setTokenAutoRefreshEnabled:function(e){return function(t,e){var n=Fk(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),Uk(t,u(u({},n),{isTokenAutoRefreshEnabled:e}))}(t,e)},getToken:function(n){return function(t,e,n){return c(this,void 0,void 0,(function(){var r;return h(this,(function(i){switch(i.label){case 0:return[4,pN(t,e,n)];case 1:if((r=i.sent()).error)throw r.error;return[2,{token:r.token}]}}))}))}(t,e,n)},onTokenChanged:function(n,r,i){return function(t,e,n,r,i){var o=function(){},a=function(){};return o=null!=n.next?n.next.bind(n):n,null!=n.error?a=n.error.bind(n):r&&(a=r),dN(t,e,"EXTERNAL",o,a),function(){return vN(t,o)}}(t,e,n,r)},INTERNAL:{delete:function(){for(var e=0,n=Fk(t).tokenObservers;e<n.length;e++){var r=n[e];vN(t,r.next)}return Promise.resolve()}}}}var bN="app-check-internal";!function(t){t.INTERNAL.registerComponent(new rt("appCheck",(function(t){return mN(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider(bN).initialize()}))),t.INTERNAL.registerComponent(new rt(bN,(function(t){return function(t,e){return{getToken:function(n){return pN(t,e,n)},addTokenListener:function(n){return dN(t,e,"INTERNAL",n)},removeTokenListener:function(e){return vN(t,e)}}}(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.2.0")}(Rk.default),function(){var e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}();if("string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===e.FIREBASE_APPCHECK_DEBUG_TOKEN){var n=jk();n.enabled=!0;var r=new E;n.token=r,"string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN?r.resolve(e.FIREBASE_APPCHECK_DEBUG_TOKEN):r.resolve(cN())}}();var _N="8.7.1";
/**
  * @license
  * Copyright 2018 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
Lt.registerVersion("firebase",_N,"app"),Lt.SDK_VERSION=_N;
/**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),Lt.registerVersion("firebase","8.7.1"),i();Lt.initializeApp({apiKey:"AIzaSyDAdFbdaEjLk_qQwGGZGKYur5OghPwNIeE",authDomain:"callsign-c0af8.firebaseapp.com",projectId:"callsign-c0af8",storageBucket:"callsign-c0af8.appspot.com",messagingSenderId:"858960654551",appId:"1:858960654551:web:8cc6532ef2e37117b88092"});const wN=Lt.firestore();i().on("!+*",i().pathOf().outgoing.$path,(async t=>{const e=t;t.stamp=Lt.firestore.FieldValue.serverTimestamp(),await wN.collection(e.toCallsign).add(t)})),i().on("!+*",i().pathOf().verified,(t=>{t&&wN.collection(i().data.callsign).where("stamp",">=",Lt.firestore.Timestamp.now()).limitToLast(1).orderBy("stamp").onSnapshot((t=>t.forEach((t=>{i().data.incoming=t.data(),i().data.incoming=void 0}))))}))}();
//# sourceMappingURL=index.513c9a14.js.map
